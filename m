Return-Path: <linux-kernel+bounces-238021-lists+linux-kernel=lfdr.de@vger.kernel.org>
X-Original-To: lists+linux-kernel@lfdr.de
Delivered-To: lists+linux-kernel@lfdr.de
Received: from ny.mirrors.kernel.org (ny.mirrors.kernel.org [147.75.199.223])
	by mail.lfdr.de (Postfix) with ESMTPS id EA0F4924235
	for <lists+linux-kernel@lfdr.de>; Tue,  2 Jul 2024 17:20:09 +0200 (CEST)
Received: from smtp.subspace.kernel.org (wormhole.subspace.kernel.org [52.25.139.140])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by ny.mirrors.kernel.org (Postfix) with ESMTPS id 26AFB1C21666
	for <lists+linux-kernel@lfdr.de>; Tue,  2 Jul 2024 15:20:09 +0000 (UTC)
Received: from localhost.localdomain (localhost.localdomain [127.0.0.1])
	by smtp.subspace.kernel.org (Postfix) with ESMTP id 9674B1BBBD2;
	Tue,  2 Jul 2024 15:20:03 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org;
	dkim=pass (2048-bit key) header.d=kernel.org header.i=@kernel.org header.b="K6i1SNuY"
Received: from smtp.kernel.org (aws-us-west-2-korg-mail-1.web.codeaurora.org [10.30.226.201])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by smtp.subspace.kernel.org (Postfix) with ESMTPS id D62EB1BA868;
	Tue,  2 Jul 2024 15:20:02 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org; arc=none smtp.client-ip=10.30.226.201
ARC-Seal:i=1; a=rsa-sha256; d=subspace.kernel.org; s=arc-20240116;
	t=1719933602; cv=none; b=KA/XDdicJ/S1VdP6mTwtXDNaCitDXCnWpeNYGXj/2nc/ux8eGU7S+FY8IdpGUV9sTTq9eBhKiWeDa0HSPvUwPNfBHT2IA4TetG3c3C7qgoXW9VLzSDPtuOjMrigML10od+vacm+369rL7PC7z1JKh8g/z0dx0W7WM6pPJpoQ1uA=
ARC-Message-Signature:i=1; a=rsa-sha256; d=subspace.kernel.org;
	s=arc-20240116; t=1719933602; c=relaxed/simple;
	bh=vDRfgq1khjg3V3GqZTi2bS11LujWGqPMZ8TLlczYvnA=;
	h=Date:Message-ID:From:To:Cc:Subject:In-Reply-To:References:
	 MIME-Version:Content-Type; b=EKyaXxq2oPIiBcLTNkRJAJRqjHdB1By/w31rd6nAWNZIeIszBQ4eLYMFi3NNiQ4OtDWtslSVuDKdq1wl1wyBGOphlYIiryi2xuMFURczLxzUG7kDUxZZ+cO500xcILwTJaUf6Es34B8doMHaBct33zmD7Z87e/nOXjPaG+UhF8s=
ARC-Authentication-Results:i=1; smtp.subspace.kernel.org; dkim=pass (2048-bit key) header.d=kernel.org header.i=@kernel.org header.b=K6i1SNuY; arc=none smtp.client-ip=10.30.226.201
Received: by smtp.kernel.org (Postfix) with ESMTPSA id 7421BC116B1;
	Tue,  2 Jul 2024 15:20:02 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=kernel.org;
	s=k20201202; t=1719933602;
	bh=vDRfgq1khjg3V3GqZTi2bS11LujWGqPMZ8TLlczYvnA=;
	h=Date:From:To:Cc:Subject:In-Reply-To:References:From;
	b=K6i1SNuYGTNT6OO7pKaDxagvIFhwMk/t6uNJ9i46XtUxP4y5uzmIZICtKnJoLWvyi
	 bAfF4fZTOJbdEWSWfisAINCU7oOyYbWkmSmscs7ke8iVrcTAVPvRYirHnCllSmU1I2
	 uCIvzfnu8OIIbanoZCrinKiyQfZ9LIt+3iY0PpQcmuHg9Q0/bvX722/lqmk9bOVsci
	 zjgN3S/rCZalTlcvt6P9xAIlOvoCeI5Nl6cr9j20FoC4Dyhq5hiS90LMMXlljEWo3s
	 6jHC3aA9BNmSbcRduDOZcYCOAE0ZvZxXmoFvCPj394sPQzvzSQwmN3PXaToy6F5OYa
	 2/uBd1pdHcWyg==
Received: from sofa.misterjones.org ([185.219.108.64] helo=goblin-girl.misterjones.org)
	by disco-boy.misterjones.org with esmtpsa  (TLS1.3) tls TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
	(Exim 4.95)
	(envelope-from <maz@kernel.org>)
	id 1sOfIV-0099Nu-US;
	Tue, 02 Jul 2024 16:20:00 +0100
Date: Tue, 02 Jul 2024 16:19:59 +0100
Message-ID: <861q4bizxc.wl-maz@kernel.org>
From: Marc Zyngier <maz@kernel.org>
To: Christian Zigotzky <chzigotzky@xenosoft.de>
Cc: Rob Herring <robh@kernel.org>,
	apatel@ventanamicro.com,
	DTML <devicetree@vger.kernel.org>,
	Linux Kernel Mailing List <linux-kernel@vger.kernel.org>,
	linuxppc-dev <linuxppc-dev@lists.ozlabs.org>,
	mad skateman <madskateman@gmail.com>,
	"R.T.Dickinson" <rtd2@xtra.co.nz>,
	Matthew Leaman <matthew@a-eon.biz>,
	Darren Stevens
 <darren@stevens-zone.net>,
	Christian Zigotzky <info@xenosoft.de>
Subject: Re: [PowerPC] [PASEMI] Issue with the identification of ATA drives after the of/irq updates 2024-05-29
In-Reply-To: <3ab66fab-c3f2-4bed-a04d-a10c57dcdd9b@xenosoft.de>
References: <3ab66fab-c3f2-4bed-a04d-a10c57dcdd9b@xenosoft.de>
User-Agent: Wanderlust/2.15.9 (Almost Unreal) SEMI-EPG/1.14.7 (Harue)
 FLIM-LB/1.14.9 (=?UTF-8?B?R29qxY0=?=) APEL-LB/10.8 EasyPG/1.0.0 Emacs/29.2
 (aarch64-unknown-linux-gnu) MULE/6.0 (HANACHIRUSATO)
Precedence: bulk
X-Mailing-List: linux-kernel@vger.kernel.org
List-Id: <linux-kernel.vger.kernel.org>
List-Subscribe: <mailto:linux-kernel+subscribe@vger.kernel.org>
List-Unsubscribe: <mailto:linux-kernel+unsubscribe@vger.kernel.org>
MIME-Version: 1.0 (generated by SEMI-EPG 1.14.7 - "Harue")
Content-Type: text/plain; charset=US-ASCII
X-SA-Exim-Connect-IP: 185.219.108.64
X-SA-Exim-Rcpt-To: chzigotzky@xenosoft.de, robh@kernel.org, apatel@ventanamicro.com, devicetree@vger.kernel.org, linux-kernel@vger.kernel.org, linuxppc-dev@lists.ozlabs.org, madskateman@gmail.com, rtd2@xtra.co.nz, matthew@a-eon.biz, darren@stevens-zone.net, info@xenosoft.de
X-SA-Exim-Mail-From: maz@kernel.org
X-SA-Exim-Scanned: No (on disco-boy.misterjones.org); SAEximRunCond expanded to false

Christian,

On Sun, 30 Jun 2024 11:21:55 +0100,
Christian Zigotzky <chzigotzky@xenosoft.de> wrote:
> 
> Hello,
> 
> There is an issue with the identification of ATA drives with our
> P.A. Semi Nemo boards [1] after the
> commit "of/irq: Factor out parsing of interrupt-map parent
> phandle+args from of_irq_parse_raw()" [2].
> 
> Error messages:
> 
> ata2.00: failed to IDENTIFY (I/O error, err_mask=0x4)
> ata2.00: qc timeout after 10000 mssecs (cmd 0xec)
> 
> Screenshots [3]
> 
> I bisected yesterday [4] and "of/irq: Factor out parsing of
> interrupt-map parent phandle+args from of_irq_parse_raw()" [2] is the
> first bad commit.
> 
> Then I created a patch for reverting this first bad commit. I also
> reverted the changes in drivers/of/property.c. [5]
> 
> The patched kernel boots with successful detection of the ATA devices.
> 
> Please check the of/irq updates.

It is hard to understand what is going on with so little information.

Please provide the device tree for your platform. It isn't possible to
debug this without it, no matter how many pictures you provide. If it
doesn't exist in source form, you can dump it using:

# dtc -I dtb /sys/firmware/fdt

and posting the full output.

Additionally, a full dmesg of both working and non working boots would
be useful.

Thanks,

	M.

-- 
Without deviation from the norm, progress is not possible.


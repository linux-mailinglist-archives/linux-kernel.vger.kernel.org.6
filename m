Return-Path: <linux-kernel+bounces-263034-lists+linux-kernel=lfdr.de@vger.kernel.org>
X-Original-To: lists+linux-kernel@lfdr.de
Delivered-To: lists+linux-kernel@lfdr.de
Received: from am.mirrors.kernel.org (am.mirrors.kernel.org [IPv6:2604:1380:4601:e00::3])
	by mail.lfdr.de (Postfix) with ESMTPS id 29E4493D007
	for <lists+linux-kernel@lfdr.de>; Fri, 26 Jul 2024 11:01:10 +0200 (CEST)
Received: from smtp.subspace.kernel.org (wormhole.subspace.kernel.org [52.25.139.140])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by am.mirrors.kernel.org (Postfix) with ESMTPS id C2DCD1F235F5
	for <lists+linux-kernel@lfdr.de>; Fri, 26 Jul 2024 09:01:09 +0000 (UTC)
Received: from localhost.localdomain (localhost.localdomain [127.0.0.1])
	by smtp.subspace.kernel.org (Postfix) with ESMTP id 46A301779A9;
	Fri, 26 Jul 2024 09:00:50 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org;
	dkim=pass (1024-bit key) header.d=redhat.com header.i=@redhat.com header.b="d4nRlllJ"
Received: from us-smtp-delivery-124.mimecast.com (us-smtp-delivery-124.mimecast.com [170.10.133.124])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by smtp.subspace.kernel.org (Postfix) with ESMTPS id EA26213C8F9
	for <linux-kernel@vger.kernel.org>; Fri, 26 Jul 2024 09:00:47 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org; arc=none smtp.client-ip=170.10.133.124
ARC-Seal:i=1; a=rsa-sha256; d=subspace.kernel.org; s=arc-20240116;
	t=1721984449; cv=none; b=RKSY9tr5lU0+anL43Y7nf67NQ8qvEm8eAVfQAiSi4pDyaE4bgoot8BoK/DlsgpOiWlQHzYJl30rNiR70t4+YZYcxk4e7Y15gG2AAhQJCuIoL+e/0ooyOu9VaB3eud4xz/P5YECGJ681LW2XpeeVCRjCkBuC7MjkQz5iIqkJwbG0=
ARC-Message-Signature:i=1; a=rsa-sha256; d=subspace.kernel.org;
	s=arc-20240116; t=1721984449; c=relaxed/simple;
	bh=Q3ep/kqRKGVh6qNLDhbOIaY72ZPDO/vccwtW2nb/zNw=;
	h=From:To:Cc:Subject:Date:Message-ID:MIME-Version; b=bqhO3udGU3ynsn6fjYGxu/8yMGyBdenpxQD97V+86A/LzHB4PkLhnHrO2mdtTIt6K+IYyOSatRPsTRZ0JzETsPv9ILTzc7XQAXsuR6wzjf+X3RmbIBzaRjTCyl+CiWsTKRr2Etj8H/rFNH3OYPTI87t9h3dR5aHi6xoaaUWmqmY=
ARC-Authentication-Results:i=1; smtp.subspace.kernel.org; dmarc=pass (p=none dis=none) header.from=redhat.com; spf=pass smtp.mailfrom=redhat.com; dkim=pass (1024-bit key) header.d=redhat.com header.i=@redhat.com header.b=d4nRlllJ; arc=none smtp.client-ip=170.10.133.124
Authentication-Results: smtp.subspace.kernel.org; dmarc=pass (p=none dis=none) header.from=redhat.com
Authentication-Results: smtp.subspace.kernel.org; spf=pass smtp.mailfrom=redhat.com
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=redhat.com;
	s=mimecast20190719; t=1721984447;
	h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
	 to:to:cc:cc:mime-version:mime-version:
	 content-transfer-encoding:content-transfer-encoding;
	bh=xLN319cy2ybo/eIqJgIWzJakYdZYuxDFmsQ44YyLNJM=;
	b=d4nRlllJSBGsv+wHSBOn78SpsZq4iIncWfMVtkfTccGXKLDpxAYBypKXFzsg4q68nxXYKX
	48NC1CPwNmlmzUoh9v2g1GtHiIgWRxQI9z/KQn55h7Q2xfaiRwRp20ts/UiP8MjHPaYkA+
	FBHovQbKrX8jLhO1P0ednONWWy+7jKc=
Received: from mx-prod-mc-05.mail-002.prod.us-west-2.aws.redhat.com
 (ec2-54-186-198-63.us-west-2.compute.amazonaws.com [54.186.198.63]) by
 relay.mimecast.com with ESMTP with STARTTLS (version=TLSv1.3,
 cipher=TLS_AES_256_GCM_SHA384) id us-mta-352-l2tfbY7qN6iEJIB6PJjxqw-1; Fri,
 26 Jul 2024 05:00:42 -0400
X-MC-Unique: l2tfbY7qN6iEJIB6PJjxqw-1
Received: from mx-prod-int-03.mail-002.prod.us-west-2.aws.redhat.com (mx-prod-int-03.mail-002.prod.us-west-2.aws.redhat.com [10.30.177.12])
	(using TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256/256 bits)
	 key-exchange X25519 server-signature RSA-PSS (2048 bits) server-digest SHA256)
	(No client certificate requested)
	by mx-prod-mc-05.mail-002.prod.us-west-2.aws.redhat.com (Postfix) with ESMTPS id 5C88D19560A2;
	Fri, 26 Jul 2024 09:00:40 +0000 (UTC)
Received: from fedora.redhat.com (unknown [10.39.192.105])
	by mx-prod-int-03.mail-002.prod.us-west-2.aws.redhat.com (Postfix) with ESMTP id CD3BF1955F6B;
	Fri, 26 Jul 2024 09:00:36 +0000 (UTC)
From: Jose Ignacio Tornos Martinez <jtornosm@redhat.com>
To: masahiroy@kernel.org,
	nathan@kernel.org,
	nicolas@fjasle.eu,
	linux-kbuild@vger.kernel.org,
	linux-kernel@vger.kernel.org
Cc: Jose Ignacio Tornos Martinez <jtornosm@redhat.com>
Subject: [PATCH] kbuild: rpm-pkg: ghost modules.weakdep file
Date: Fri, 26 Jul 2024 11:00:26 +0200
Message-ID: <20240726090032.97793-1-jtornosm@redhat.com>
Precedence: bulk
X-Mailing-List: linux-kernel@vger.kernel.org
List-Id: <linux-kernel.vger.kernel.org>
List-Subscribe: <mailto:linux-kernel+subscribe@vger.kernel.org>
List-Unsubscribe: <mailto:linux-kernel+unsubscribe@vger.kernel.org>
MIME-Version: 1.0
Content-Transfer-Encoding: 8bit
X-Scanned-By: MIMEDefang 3.0 on 10.30.177.12

In the same way as for other similar files, mark as ghost the new file
generated by depmod for configured weak dependencies for modules,
modules.weakdep, so that although it is not included in the package,
claim the ownership on it.

Signed-off-by: Jose Ignacio Tornos Martinez <jtornosm@redhat.com>
---
 scripts/package/kernel.spec | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/scripts/package/kernel.spec b/scripts/package/kernel.spec
index 74355ff0e106..d558d39c01b6 100644
--- a/scripts/package/kernel.spec
+++ b/scripts/package/kernel.spec
@@ -74,7 +74,7 @@ ln -fns /usr/src/kernels/%{KERNELRELEASE} %{buildroot}/lib/modules/%{KERNELRELEA
 	echo "/lib/modules/%{KERNELRELEASE}"
 
 	for x in alias alias.bin builtin.alias.bin builtin.bin dep dep.bin \
-					devname softdep symbols symbols.bin; do
+				devname softdep weakdep symbols symbols.bin; do
 		echo "%ghost /lib/modules/%{KERNELRELEASE}/modules.${x}"
 	done
 
-- 
2.45.2



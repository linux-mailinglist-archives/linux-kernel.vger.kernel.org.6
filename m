Return-Path: <linux-kernel+bounces-205190-lists+linux-kernel=lfdr.de@vger.kernel.org>
X-Original-To: lists+linux-kernel@lfdr.de
Delivered-To: lists+linux-kernel@lfdr.de
Received: from am.mirrors.kernel.org (am.mirrors.kernel.org [147.75.80.249])
	by mail.lfdr.de (Postfix) with ESMTPS id 47DAD8FF8C0
	for <lists+linux-kernel@lfdr.de>; Fri,  7 Jun 2024 02:49:26 +0200 (CEST)
Received: from smtp.subspace.kernel.org (wormhole.subspace.kernel.org [52.25.139.140])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by am.mirrors.kernel.org (Postfix) with ESMTPS id 6E78E1F22324
	for <lists+linux-kernel@lfdr.de>; Fri,  7 Jun 2024 00:49:25 +0000 (UTC)
Received: from localhost.localdomain (localhost.localdomain [127.0.0.1])
	by smtp.subspace.kernel.org (Postfix) with ESMTP id C91D99443;
	Fri,  7 Jun 2024 00:49:20 +0000 (UTC)
Received: from out28-3.mail.aliyun.com (out28-3.mail.aliyun.com [115.124.28.3])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by smtp.subspace.kernel.org (Postfix) with ESMTPS id 254CA23AD
	for <linux-kernel@vger.kernel.org>; Fri,  7 Jun 2024 00:49:06 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org; arc=none smtp.client-ip=115.124.28.3
ARC-Seal:i=1; a=rsa-sha256; d=subspace.kernel.org; s=arc-20240116;
	t=1717721355; cv=none; b=LQ0KYTb2mryPqT529SJbgG5+7RC/ZMl+/VBR1CU3KCH1SWMWyGsukDTuO2vtixTTs/Cc/A+wS533emctYxJlpcN61u1xzdn16U0dcObOhstfretW5xNePAtNusHrYPZc3wZeJqcXmdfr1RfgI+bMp7cbWJX/YIIY2JLdNs7BY9M=
ARC-Message-Signature:i=1; a=rsa-sha256; d=subspace.kernel.org;
	s=arc-20240116; t=1717721355; c=relaxed/simple;
	bh=rcBMPVmKHAwcGO5NC2buAy/pTZcCcvESkinnNyeduXw=;
	h=Date:From:To:Cc:Message-ID:Subject:MIME-Version:Content-Type; b=i6W9AaHmltMXhcaHzd57eGlrW2L03Zli15ek0pADl+2CTp1WvnVQarfyScwHgcKq0dCi+HMMPMzsk+D3NSjlLJgqxd5WO+Hl8gL20yYiZ2kuweg9kIEnuqb0W+FZ9woY1AZb3Rf8HFfOitl+Oqs9LNFQ5+Y1x5QU+KcCcvt2EWE=
ARC-Authentication-Results:i=1; smtp.subspace.kernel.org; dmarc=none (p=none dis=none) header.from=ubisectech.com; spf=pass smtp.mailfrom=ubisectech.com; arc=none smtp.client-ip=115.124.28.3
Authentication-Results: smtp.subspace.kernel.org; dmarc=none (p=none dis=none) header.from=ubisectech.com
Authentication-Results: smtp.subspace.kernel.org; spf=pass smtp.mailfrom=ubisectech.com
X-Alimail-AntiSpam:AC=CONTINUE;BC=0.07386655|-1;CH=green;DM=|CONTINUE|false|;DS=CONTINUE|ham_system_inform|0.0181632-0.000634475-0.981202;FP=0|0|0|0|0|0|0|0;HT=maildocker-contentspam033071120082;MF=bugreport@ubisectech.com;NM=1;PH=DW;RN=10;RT=10;SR=0;TI=W4_0.2.3_v5ForWebDing_21250BAF_1717721209242_o7001c3286;
Received: from WS-web (bugreport@ubisectech.com[W4_0.2.3_v5ForWebDing_21250BAF_1717721209242_o7001c3286]) at Fri, 07 Jun 2024 08:48:58 +0800
Date: Fri, 07 Jun 2024 08:48:58 +0800
From: "Ubisectech Sirius" <bugreport@ubisectech.com>
To: "linux-kernel" <linux-kernel@vger.kernel.org>
Cc: "marcan" <marcan@marcan.st>,
  "sven" <sven@svenpeter.dev>,
  "marcel" <marcel@holtmann.org>,
  "luiz.dentz" <luiz.dentz@gmail.com>,
  "johan.hedberg" <johan.hedberg@gmail.com>,
  "davem" <davem@davemloft.net>,
  "edumazet" <edumazet@google.com>,
  "pabeni" <pabeni@redhat.com>,
  "kuba" <kuba@kernel.org>
Reply-To: "Ubisectech Sirius" <bugreport@ubisectech.com>
Message-ID: <27bdd414-dc29-449f-9814-2404a5874dd6.bugreport@ubisectech.com>
Subject: =?UTF-8?B?S0FTQU46IHNsYWItdXNlLWFmdGVyLWZyZWUgUmVhZCBpbiBsb2NrX3NvY2tfbmVzdGVk?=
X-Mailer: [Alimail-Mailagent][W4_0.2.3][v5ForWebDing][Chrome]
Precedence: bulk
X-Mailing-List: linux-kernel@vger.kernel.org
List-Id: <linux-kernel.vger.kernel.org>
List-Subscribe: <mailto:linux-kernel+subscribe@vger.kernel.org>
List-Unsubscribe: <mailto:linux-kernel+unsubscribe@vger.kernel.org>
MIME-Version: 1.0
x-aliyun-im-through: {"mailThroughImNew":true}
x-aliyun-mail-creator: W4_0.2.3_v5ForWebDing_M3LTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEyNS4wLjAuMCBTYWZhcmkvNTM3LjM2vN
Content-Type: multipart/mixed;
  boundary="----=ALIBOUNDARY_1730_7f58dc35d700_666258fa_197702"

This is a multi-part message in MIME format.

------=ALIBOUNDARY_1730_7f58dc35d700_666258fa_197702
Content-Type: text/plain; charset="UTF-8"
Content-Transfer-Encoding: base64

CkhlbGxvLgpXZSBhcmUgVWJpc2VjdGVjaCBTaXJpdXMgVGVhbSwgdGhlIHZ1bG5lcmFiaWxpdHkg
bGFiIG9mIENoaW5hIFZhbGlhbnRTZWMuIFJlY2VudGx5LCBvdXIgdGVhbSBoYXMgZGlzY292ZXJl
ZCBhIGlzc3VlIGluIExpbnV4IGtlcm5lbCA2LjguIEF0dGFjaGVkIHRvIHRoZSBlbWFpbCB3ZXJl
IGEgUG9DIGZpbGUgb2YgdGhlIGlzc3VlLgoKU3RhY2sgZHVtcDoKPT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CkJVRzogS0FT
QU46IHNsYWItdXNlLWFmdGVyLWZyZWUgaW4gX19sb2NrX2FjcXVpcmUrMHgzMGE5LzB4M2JjMCBr
ZXJuZWwvbG9ja2luZy9sb2NrZGVwLmM6NTAwNQpSZWFkIG9mIHNpemUgOCBhdCBhZGRyIGZmZmY4
ODgwMjBkMDMwYjAgYnkgdGFzayBrd29ya2VyL3U3OjIvODA5NwoKQ1BVOiAxIFBJRDogODA5NyBD
b21tOiBrd29ya2VyL3U3OjIgTm90IHRhaW50ZWQgNi44LjAgIzEKSGFyZHdhcmUgbmFtZTogUUVN
VSBTdGFuZGFyZCBQQyAoaTQ0MEZYICsgUElJWCwgMTk5NiksIEJJT1MgMS4xNS4wLTEgMDQvMDEv
MjAxNApXb3JrcXVldWU6IGhjaTAgaGNpX3J4X3dvcmsKQ2FsbCBUcmFjZToKIDxUQVNLPgogX19k
dW1wX3N0YWNrIGxpYi9kdW1wX3N0YWNrLmM6ODggW2lubGluZV0KIGR1bXBfc3RhY2tfbHZsKzB4
ZDkvMHgxNTAgbGliL2R1bXBfc3RhY2suYzoxMDYKIHByaW50X2FkZHJlc3NfZGVzY3JpcHRpb24g
bW0va2FzYW4vcmVwb3J0LmM6Mzc3IFtpbmxpbmVdCiBwcmludF9yZXBvcnQrMHhjMS8weDVlMCBt
bS9rYXNhbi9yZXBvcnQuYzo0ODgKIGthc2FuX3JlcG9ydCsweGJlLzB4ZjAgbW0va2FzYW4vcmVw
b3J0LmM6NjAxCiBfX2xvY2tfYWNxdWlyZSsweDMwYTkvMHgzYmMwIGtlcm5lbC9sb2NraW5nL2xv
Y2tkZXAuYzo1MDA1CiBsb2NrX2FjcXVpcmUga2VybmVsL2xvY2tpbmcvbG9ja2RlcC5jOjU3NTQg
W2lubGluZV0KIGxvY2tfYWNxdWlyZSsweDFiMS8weDUzMCBrZXJuZWwvbG9ja2luZy9sb2NrZGVw
LmM6NTcxOQogX19yYXdfc3Bpbl9sb2NrX2JoIGluY2x1ZGUvbGludXgvc3BpbmxvY2tfYXBpX3Nt
cC5oOjEyNiBbaW5saW5lXQogX3Jhd19zcGluX2xvY2tfYmgrMHgzMy8weDQwIGtlcm5lbC9sb2Nr
aW5nL3NwaW5sb2NrLmM6MTc4CiBzcGluX2xvY2tfYmggaW5jbHVkZS9saW51eC9zcGlubG9jay5o
OjM1NiBbaW5saW5lXQogbG9ja19zb2NrX25lc3RlZCsweDVmLzB4ZjAgbmV0L2NvcmUvc29jay5j
OjM1MjYKIGxvY2tfc29jayBpbmNsdWRlL25ldC9zb2NrLmg6MTY5MSBbaW5saW5lXQogbDJjYXBf
c29ja19yZWN2X2NiKzB4NTMvMHgxZjAgbmV0L2JsdWV0b290aC9sMmNhcF9zb2NrLmM6MTQ4MAog
bDJjYXBfY29ubGVzc19jaGFubmVsIG5ldC9ibHVldG9vdGgvbDJjYXBfY29yZS5jOjc3NzEgW2lu
bGluZV0KIGwyY2FwX3JlY3ZfZnJhbWUrMHg4MTcvMHg5MTEwIG5ldC9ibHVldG9vdGgvbDJjYXBf
Y29yZS5jOjc4MjQKIGwyY2FwX3JlY3ZfYWNsZGF0YSsweGE3ZC8weGJmMCBuZXQvYmx1ZXRvb3Ro
L2wyY2FwX2NvcmUuYzo4NTM2CiBoY2lfYWNsZGF0YV9wYWNrZXQgbmV0L2JsdWV0b290aC9oY2lf
Y29yZS5jOjM4NzYgW2lubGluZV0KIGhjaV9yeF93b3JrKzB4NmQwLzB4MTU2MCBuZXQvYmx1ZXRv
b3RoL2hjaV9jb3JlLmM6NDExMQogcHJvY2Vzc19vbmVfd29yaysweDg3Yi8weDE1YzAga2VybmVs
L3dvcmtxdWV1ZS5jOjI2MzMKIHByb2Nlc3Nfc2NoZWR1bGVkX3dvcmtzIGtlcm5lbC93b3JrcXVl
dWUuYzoyNzA2IFtpbmxpbmVdCiB3b3JrZXJfdGhyZWFkKzB4ODU1LzB4MTIwMCBrZXJuZWwvd29y
a3F1ZXVlLmM6Mjc4Nwoga3RocmVhZCsweDJjYy8weDNiMCBrZXJuZWwva3RocmVhZC5jOjM4OAog
cmV0X2Zyb21fZm9yaysweDQ1LzB4ODAgYXJjaC94ODYva2VybmVsL3Byb2Nlc3MuYzoxNDcKIHJl
dF9mcm9tX2ZvcmtfYXNtKzB4MWIvMHgzMCBhcmNoL3g4Ni9lbnRyeS9lbnRyeV82NC5TOjI0Mwog
PC9UQVNLPgoKQWxsb2NhdGVkIGJ5IHRhc2sgMjEyNjc6CiBrYXNhbl9zYXZlX3N0YWNrKzB4MjQv
MHg1MCBtbS9rYXNhbi9jb21tb24uYzo0Nwoga2FzYW5fc2F2ZV90cmFjaysweDE0LzB4MzAgbW0v
a2FzYW4vY29tbW9uLmM6NjgKIHBvaXNvbl9rbWFsbG9jX3JlZHpvbmUgbW0va2FzYW4vY29tbW9u
LmM6MzcwIFtpbmxpbmVdCiBfX2thc2FuX2ttYWxsb2MrMHhhYS8weGIwIG1tL2thc2FuL2NvbW1v
bi5jOjM4Nwoga2FzYW5fa21hbGxvYyBpbmNsdWRlL2xpbnV4L2thc2FuLmg6MjExIFtpbmxpbmVd
CiBfX2RvX2ttYWxsb2Nfbm9kZSBtbS9zbHViLmM6Mzk4MSBbaW5saW5lXQogX19rbWFsbG9jKzB4
MWYzLzB4NDgwIG1tL3NsdWIuYzozOTk0CiBrbWFsbG9jIGluY2x1ZGUvbGludXgvc2xhYi5oOjU5
NCBbaW5saW5lXQogc2tfcHJvdF9hbGxvYysweDE1NS8weDI5MCBuZXQvY29yZS9zb2NrLmM6MjA3
OAogc2tfYWxsb2MrMHgzNi8weGI4MCBuZXQvY29yZS9zb2NrLmM6MjEzMQogYnRfc29ja19hbGxv
YysweDNhLzB4M2IwIG5ldC9ibHVldG9vdGgvYWZfYmx1ZXRvb3RoLmM6MTQ4CiBsMmNhcF9zb2Nr
X2FsbG9jIG5ldC9ibHVldG9vdGgvbDJjYXBfc29jay5jOjE4NDIgW2lubGluZV0KIGwyY2FwX3Nv
Y2tfY3JlYXRlKzB4MTMyLzB4MmQwIG5ldC9ibHVldG9vdGgvbDJjYXBfc29jay5jOjE4ODAKIGJ0
X3NvY2tfY3JlYXRlKzB4MTgyLzB4MzUwIG5ldC9ibHVldG9vdGgvYWZfYmx1ZXRvb3RoLmM6MTMy
CiBfX3NvY2tfY3JlYXRlKzB4MzdiLzB4ODUwIG5ldC9zb2NrZXQuYzoxNTcxCiBzb2NrX2NyZWF0
ZSBuZXQvc29ja2V0LmM6MTYyMiBbaW5saW5lXQogX19zeXNfc29ja2V0X2NyZWF0ZSBuZXQvc29j
a2V0LmM6MTY1OSBbaW5saW5lXQogX19zeXNfc29ja2V0X2NyZWF0ZSBuZXQvc29ja2V0LmM6MTY0
NCBbaW5saW5lXQogX19zeXNfc29ja2V0KzB4MTQ4LzB4MjYwIG5ldC9zb2NrZXQuYzoxNzA2CiBf
X2RvX3N5c19zb2NrZXQgbmV0L3NvY2tldC5jOjE3MjAgW2lubGluZV0KIF9fc2Vfc3lzX3NvY2tl
dCBuZXQvc29ja2V0LmM6MTcxOCBbaW5saW5lXQogX194NjRfc3lzX3NvY2tldCsweDcyLzB4YjAg
bmV0L3NvY2tldC5jOjE3MTgKIGRvX3N5c2NhbGxfeDY0IGFyY2gveDg2L2VudHJ5L2NvbW1vbi5j
OjUyIFtpbmxpbmVdCiBkb19zeXNjYWxsXzY0KzB4ZDUvMHgyNzAgYXJjaC94ODYvZW50cnkvY29t
bW9uLmM6ODMKIGVudHJ5X1NZU0NBTExfNjRfYWZ0ZXJfaHdmcmFtZSsweDZmLzB4NzcKCkZyZWVk
IGJ5IHRhc2sgMjEyNjY6CiBrYXNhbl9zYXZlX3N0YWNrKzB4MjQvMHg1MCBtbS9rYXNhbi9jb21t
b24uYzo0Nwoga2FzYW5fc2F2ZV90cmFjaysweDE0LzB4MzAgbW0va2FzYW4vY29tbW9uLmM6NjgK
IGthc2FuX3NhdmVfZnJlZV9pbmZvKzB4M2IvMHg2MCBtbS9rYXNhbi9nZW5lcmljLmM6NTg5CiBw
b2lzb25fc2xhYl9vYmplY3QgbW0va2FzYW4vY29tbW9uLmM6MjQwIFtpbmxpbmVdCiBwb2lzb25f
c2xhYl9vYmplY3QrMHgxMDIvMHgxOTAgbW0va2FzYW4vY29tbW9uLmM6MjExCiBfX2thc2FuX3Ns
YWJfZnJlZSsweDMzLzB4NTAgbW0va2FzYW4vY29tbW9uLmM6MjU2CiBrYXNhbl9zbGFiX2ZyZWUg
aW5jbHVkZS9saW51eC9rYXNhbi5oOjE4NCBbaW5saW5lXQogc2xhYl9mcmVlX2hvb2sgbW0vc2x1
Yi5jOjIxMjEgW2lubGluZV0KIHNsYWJfZnJlZSBtbS9zbHViLmM6NDI5OSBbaW5saW5lXQoga2Zy
ZWUrMHgxMjkvMHgzODAgbW0vc2x1Yi5jOjQ0MDkKIHNrX3Byb3RfZnJlZSBuZXQvY29yZS9zb2Nr
LmM6MjExNCBbaW5saW5lXQogX19za19kZXN0cnVjdCsweDVlNC8weDc0MCBuZXQvY29yZS9zb2Nr
LmM6MjIwNgogc2tfZGVzdHJ1Y3QrMHhjMS8weGUwIG5ldC9jb3JlL3NvY2suYzoyMjIxCiBfX3Nr
X2ZyZWUrMHhmMi8weDNlMCBuZXQvY29yZS9zb2NrLmM6MjIzMgogc2tfZnJlZSsweDdjLzB4YTAg
bmV0L2NvcmUvc29jay5jOjIyNDMKIHNvY2tfcHV0IGluY2x1ZGUvbmV0L3NvY2suaDoxOTYxIFtp
bmxpbmVdCiBsMmNhcF9zb2NrX2tpbGwgbmV0L2JsdWV0b290aC9sMmNhcF9zb2NrLmM6MTIzOSBb
aW5saW5lXQogbDJjYXBfc29ja19raWxsKzB4MWZlLzB4MjQwIG5ldC9ibHVldG9vdGgvbDJjYXBf
c29jay5jOjEyMjgKIGwyY2FwX3NvY2tfcmVsZWFzZSsweDE4Zi8weDIxMCBuZXQvYmx1ZXRvb3Ro
L2wyY2FwX3NvY2suYzoxNDEwCiBfX3NvY2tfcmVsZWFzZSsweGIwLzB4MjcwIG5ldC9zb2NrZXQu
Yzo2NTkKIHNvY2tfY2xvc2UrMHgxYy8weDMwIG5ldC9zb2NrZXQuYzoxNDIxCiBfX2ZwdXQrMHgy
ODIvMHhiYzAgZnMvZmlsZV90YWJsZS5jOjM3NgogX19mcHV0X3N5bmMrMHg0NS8weDUwIGZzL2Zp
bGVfdGFibGUuYzo0NjEKIF9fZG9fc3lzX2Nsb3NlIGZzL29wZW4uYzoxNTU0IFtpbmxpbmVdCiBf
X3NlX3N5c19jbG9zZSBmcy9vcGVuLmM6MTUzOSBbaW5saW5lXQogX194NjRfc3lzX2Nsb3NlKzB4
OGIvMHgxMjAgZnMvb3Blbi5jOjE1MzkKIGRvX3N5c2NhbGxfeDY0IGFyY2gveDg2L2VudHJ5L2Nv
bW1vbi5jOjUyIFtpbmxpbmVdCiBkb19zeXNjYWxsXzY0KzB4ZDUvMHgyNzAgYXJjaC94ODYvZW50
cnkvY29tbW9uLmM6ODMKIGVudHJ5X1NZU0NBTExfNjRfYWZ0ZXJfaHdmcmFtZSsweDZmLzB4NzcK
ClRoZSBidWdneSBhZGRyZXNzIGJlbG9uZ3MgdG8gdGhlIG9iamVjdCBhdCBmZmZmODg4MDIwZDAz
MDAwCiB3aGljaCBiZWxvbmdzIHRvIHRoZSBjYWNoZSBrbWFsbG9jLTJrIG9mIHNpemUgMjA0OApU
aGUgYnVnZ3kgYWRkcmVzcyBpcyBsb2NhdGVkIDE3NiBieXRlcyBpbnNpZGUgb2YKIGZyZWVkIDIw
NDgtYnl0ZSByZWdpb24gW2ZmZmY4ODgwMjBkMDMwMDAsIGZmZmY4ODgwMjBkMDM4MDApCgpUaGUg
YnVnZ3kgYWRkcmVzcyBiZWxvbmdzIHRvIHRoZSBwaHlzaWNhbCBwYWdlOgpwYWdlOmZmZmZlYTAw
MDA4MzQwMDAgcmVmY291bnQ6MSBtYXBjb3VudDowIG1hcHBpbmc6MDAwMDAwMDAwMDAwMDAwMCBp
bmRleDoweDAgcGZuOjB4MjBkMDAKaGVhZDpmZmZmZWEwMDAwODM0MDAwIG9yZGVyOjMgZW50aXJl
X21hcGNvdW50OjAgbnJfcGFnZXNfbWFwcGVkOjAgcGluY291bnQ6MAphbm9uIGZsYWdzOiAweGZm
ZjAwMDAwMDAwODQwKHNsYWJ8aGVhZHxub2RlPTB8em9uZT0xfGxhc3RjcHVwaWQ9MHg3ZmYpCnBh
Z2VfdHlwZTogMHhmZmZmZmZmZigpCnJhdzogMDBmZmYwMDAwMDAwMDg0MCBmZmZmODg4MDE0ODQy
MDAwIDAwMDAwMDAwMDAwMDAwMDAgZGVhZDAwMDAwMDAwMDAwMQpyYXc6IDAwMDAwMDAwMDAwMDAw
MDAgMDAwMDAwMDA4MDA4MDAwOCAwMDAwMDAwMWZmZmZmZmZmIDAwMDAwMDAwMDAwMDAwMDAKcGFn
ZSBkdW1wZWQgYmVjYXVzZToga2FzYW46IGJhZCBhY2Nlc3MgZGV0ZWN0ZWQKcGFnZV9vd25lciB0
cmFja3MgdGhlIHBhZ2UgYXMgYWxsb2NhdGVkCnBhZ2UgbGFzdCBhbGxvY2F0ZWQgdmlhIG9yZGVy
IDMsIG1pZ3JhdGV0eXBlIFVubW92YWJsZSwgZ2ZwX21hc2sgMHgxZDI4MjAoR0ZQX0FUT01JQ3xf
X0dGUF9OT1dBUk58X19HRlBfTk9SRVRSWXxfX0dGUF9DT01QfF9fR0ZQX05PTUVNQUxMT0N8X19H
RlBfSEFSRFdBTEwpLCBwaWQgMTQ2MjcsIHRnaWQgMTQ2MjcgKHN5ei1leGVjdXRvci4yKSwgdHMg
MjI1MzM5NjMwODg1LCBmcmVlX3RzIDIyMzYzOTUyMjAzNAogc2V0X3BhZ2Vfb3duZXIgaW5jbHVk
ZS9saW51eC9wYWdlX293bmVyLmg6MzEgW2lubGluZV0KIHBvc3RfYWxsb2NfaG9vaysweDJkZC8w
eDM1MCBtbS9wYWdlX2FsbG9jLmM6MTUzMwogcHJlcF9uZXdfcGFnZSBtbS9wYWdlX2FsbG9jLmM6
MTU0MCBbaW5saW5lXQogZ2V0X3BhZ2VfZnJvbV9mcmVlbGlzdCsweGQzOC8weDMwNDAgbW0vcGFn
ZV9hbGxvYy5jOjMzMTEKIF9fYWxsb2NfcGFnZXMrMHgyMTUvMHgyMWIwIG1tL3BhZ2VfYWxsb2Mu
Yzo0NTY5CiBfX2FsbG9jX3BhZ2VzX25vZGUgaW5jbHVkZS9saW51eC9nZnAuaDoyMzggW2lubGlu
ZV0KIGFsbG9jX3BhZ2VzX25vZGUgaW5jbHVkZS9saW51eC9nZnAuaDoyNjEgW2lubGluZV0KIGFs
bG9jX3NsYWJfcGFnZSBtbS9zbHViLmM6MjE5MCBbaW5saW5lXQogYWxsb2NhdGVfc2xhYiBtbS9z
bHViLmM6MjM1NCBbaW5saW5lXQogbmV3X3NsYWIrMHhkMy8weDNiMCBtbS9zbHViLmM6MjQwNwog
X19fc2xhYl9hbGxvYysweGMzOS8weDE4YzAgbW0vc2x1Yi5jOjM1NDAKIF9fc2xhYl9hbGxvYy5j
b25zdHByb3AuMCsweDU2LzB4YjAgbW0vc2x1Yi5jOjM2MjUKIF9fc2xhYl9hbGxvY19ub2RlIG1t
L3NsdWIuYzozNjc4IFtpbmxpbmVdCiBzbGFiX2FsbG9jX25vZGUgbW0vc2x1Yi5jOjM4NTAgW2lu
bGluZV0KIF9fZG9fa21hbGxvY19ub2RlIG1tL3NsdWIuYzozOTgwIFtpbmxpbmVdCiBfX2ttYWxs
b2Nfbm9kZV90cmFja19jYWxsZXIrMHgzNTkvMHg0YTAgbW0vc2x1Yi5jOjQwMDEKIGttYWxsb2Nf
cmVzZXJ2ZSsweGVkLzB4MjYwIG5ldC9jb3JlL3NrYnVmZi5jOjU4MgogX19hbGxvY19za2IrMHgx
MjkvMHgzMzAgbmV0L2NvcmUvc2tidWZmLmM6NjUxCiBhbGxvY19za2IgaW5jbHVkZS9saW51eC9z
a2J1ZmYuaDoxMjk2IFtpbmxpbmVdCiBubG1zZ19uZXcgaW5jbHVkZS9uZXQvbmV0bGluay5oOjEw
MTAgW2lubGluZV0KIGluZXQ2X2lmaW5mb19ub3RpZnkrMHg3Yi8weDE2MCBuZXQvaXB2Ni9hZGRy
Y29uZi5jOjYxMTUKIGFkZHJjb25mX25vdGlmeSsweDNmYy8weDE5ODAgbmV0L2lwdjYvYWRkcmNv
bmYuYzozNzE4CiBub3RpZmllcl9jYWxsX2NoYWluKzB4YmEvMHgzZTAga2VybmVsL25vdGlmaWVy
LmM6OTMKIGNhbGxfbmV0ZGV2aWNlX25vdGlmaWVyc19pbmZvKzB4YmUvMHgxNDAgbmV0L2NvcmUv
ZGV2LmM6MTk2NgogY2FsbF9uZXRkZXZpY2Vfbm90aWZpZXJzX2V4dGFjayBuZXQvY29yZS9kZXYu
YzoyMDA0IFtpbmxpbmVdCiBjYWxsX25ldGRldmljZV9ub3RpZmllcnMgbmV0L2NvcmUvZGV2LmM6
MjAxOCBbaW5saW5lXQogX19kZXZfbm90aWZ5X2ZsYWdzKzB4MTJkLzB4MmUwIG5ldC9jb3JlL2Rl
di5jOjg2ODcKIGRldl9jaGFuZ2VfZmxhZ3MrMHgxMDkvMHgxNzAgbmV0L2NvcmUvZGV2LmM6ODcy
NQogZG9fc2V0bGluaysweDk0Yy8weDNiNDAgbmV0L2NvcmUvcnRuZXRsaW5rLmM6MjkwNgpwYWdl
IGxhc3QgZnJlZSBwaWQgMTU5MTcgdGdpZCAxNTkxNiBzdGFjayB0cmFjZToKIHJlc2V0X3BhZ2Vf
b3duZXIgaW5jbHVkZS9saW51eC9wYWdlX293bmVyLmg6MjQgW2lubGluZV0KIGZyZWVfcGFnZXNf
cHJlcGFyZSBtbS9wYWdlX2FsbG9jLmM6MTE0MCBbaW5saW5lXQogZnJlZV91bnJlZl9wYWdlX3By
ZXBhcmUrMHg1MTYvMHhiMTAgbW0vcGFnZV9hbGxvYy5jOjIzNDYKIGZyZWVfdW5yZWZfcGFnZSsw
eDMzLzB4M2UwIG1tL3BhZ2VfYWxsb2MuYzoyNDg2CiBrYXNhbl9kZXBvcHVsYXRlX3ZtYWxsb2Nf
cHRlKzB4NjAvMHg4MCBtbS9rYXNhbi9zaGFkb3cuYzo0MTUKIGFwcGx5X3RvX3B0ZV9yYW5nZSBt
bS9tZW1vcnkuYzoyNjE5IFtpbmxpbmVdCiBhcHBseV90b19wbWRfcmFuZ2UgbW0vbWVtb3J5LmM6
MjY2MyBbaW5saW5lXQogYXBwbHlfdG9fcHVkX3JhbmdlIG1tL21lbW9yeS5jOjI2OTkgW2lubGlu
ZV0KIGFwcGx5X3RvX3A0ZF9yYW5nZSBtbS9tZW1vcnkuYzoyNzM1IFtpbmxpbmVdCiBfX2FwcGx5
X3RvX3BhZ2VfcmFuZ2UrMHg1ZDIvMHhmMDAgbW0vbWVtb3J5LmM6Mjc2OQoga2FzYW5fcmVsZWFz
ZV92bWFsbG9jKzB4YWIvMHhjMCBtbS9rYXNhbi9zaGFkb3cuYzo1MzIKIF9fcHVyZ2Vfdm1hcF9h
cmVhX2xhenkrMHg4ODQvMHgxZTQwIG1tL3ZtYWxsb2MuYzoxNzcwCiBfdm1fdW5tYXBfYWxpYXNl
cysweDExNy8weDliMCBtbS92bWFsbG9jLmM6MjMwNgogY2hhbmdlX3BhZ2VfYXR0cl9zZXRfY2xy
KzB4MjI4LzB4NDcwIGFyY2gveDg2L21tL3BhdC9zZXRfbWVtb3J5LmM6MTg0MgogY2hhbmdlX3Bh
Z2VfYXR0cl9jbGVhciBhcmNoL3g4Ni9tbS9wYXQvc2V0X21lbW9yeS5jOjE4OTAgW2lubGluZV0K
IHNldF9tZW1vcnlfcm8rMHg3Yy8weGIwIGFyY2gveDg2L21tL3BhdC9zZXRfbWVtb3J5LmM6MjA3
NgogYnBmX3Byb2dfbG9ja19ybyBpbmNsdWRlL2xpbnV4L2ZpbHRlci5oOjg4OSBbaW5saW5lXQog
YnBmX3Byb2dfc2VsZWN0X3J1bnRpbWUrMHg1MGMvMHg2NTAga2VybmVsL2JwZi9jb3JlLmM6MjM5
NQogYnBmX3Byb2dfbG9hZCsweDE3MjEvMHgyM2EwIGtlcm5lbC9icGYvc3lzY2FsbC5jOjI3NzMK
IF9fc3lzX2JwZisweDEyY2UvMHg1MDIwIGtlcm5lbC9icGYvc3lzY2FsbC5jOjU0NTcKIF9fZG9f
c3lzX2JwZiBrZXJuZWwvYnBmL3N5c2NhbGwuYzo1NTYxIFtpbmxpbmVdCiBfX3NlX3N5c19icGYg
a2VybmVsL2JwZi9zeXNjYWxsLmM6NTU1OSBbaW5saW5lXQogX194NjRfc3lzX2JwZisweDc4LzB4
YzAga2VybmVsL2JwZi9zeXNjYWxsLmM6NTU1OQogZG9fc3lzY2FsbF94NjQgYXJjaC94ODYvZW50
cnkvY29tbW9uLmM6NTIgW2lubGluZV0KIGRvX3N5c2NhbGxfNjQrMHhkNS8weDI3MCBhcmNoL3g4
Ni9lbnRyeS9jb21tb24uYzo4MwogZW50cnlfU1lTQ0FMTF82NF9hZnRlcl9od2ZyYW1lKzB4NmYv
MHg3NwoKTWVtb3J5IHN0YXRlIGFyb3VuZCB0aGUgYnVnZ3kgYWRkcmVzczoKIGZmZmY4ODgwMjBk
MDJmODA6IGZjIGZjIGZjIGZjIGZjIGZjIGZjIGZjIGZjIGZjIGZjIGZjIGZjIGZjIGZjIGZjCiBm
ZmZmODg4MDIwZDAzMDAwOiBmYSBmYiBmYiBmYiBmYiBmYiBmYiBmYiBmYiBmYiBmYiBmYiBmYiBm
YiBmYiBmYgo+ZmZmZjg4ODAyMGQwMzA4MDogZmIgZmIgZmIgZmIgZmIgZmIgZmIgZmIgZmIgZmIg
ZmIgZmIgZmIgZmIgZmIgZmIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF4K
IGZmZmY4ODgwMjBkMDMxMDA6IGZiIGZiIGZiIGZiIGZiIGZiIGZiIGZiIGZiIGZiIGZiIGZiIGZi
IGZiIGZiIGZiCiBmZmZmODg4MDIwZDAzMTgwOiBmYiBmYiBmYiBmYiBmYiBmYiBmYiBmYiBmYiBm
YiBmYiBmYiBmYiBmYiBmYiBmYgo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KClRoYW5rIHlvdSBmb3IgdGFraW5nIHRoZSB0
aW1lIHRvIHJlYWQgdGhpcyBlbWFpbCBhbmQgd2UgbG9vayBmb3J3YXJkIHRvIHdvcmtpbmcgd2l0
aCB5b3UgZnVydGhlci4KCgoKCgoKCg==
------=ALIBOUNDARY_1730_7f58dc35d700_666258fa_197702
Content-Type: application/octet-stream
Content-Disposition: attachment; filename="=?UTF-8?B?cG9jLmM=?="
Content-Transfer-Encoding: base64

Ly8gYXV0b2dlbmVyYXRlZCBieSBzeXprYWxsZXIgKGh0dHBzOi8vZ2l0aHViLmNvbS9nb29nbGUv
c3l6a2FsbGVyKQoKI2RlZmluZSBfR05VX1NPVVJDRQoKI2luY2x1ZGUgPGFycGEvaW5ldC5oPgoj
aW5jbHVkZSA8ZGlyZW50Lmg+CiNpbmNsdWRlIDxlbmRpYW4uaD4KI2luY2x1ZGUgPGVycm5vLmg+
CiNpbmNsdWRlIDxmY250bC5oPgojaW5jbHVkZSA8bmV0L2lmLmg+CiNpbmNsdWRlIDxuZXQvaWZf
YXJwLmg+CiNpbmNsdWRlIDxuZXRpbmV0L2luLmg+CiNpbmNsdWRlIDxwdGhyZWFkLmg+CiNpbmNs
dWRlIDxzY2hlZC5oPgojaW5jbHVkZSA8c2V0am1wLmg+CiNpbmNsdWRlIDxzaWduYWwuaD4KI2lu
Y2x1ZGUgPHN0ZGFyZy5oPgojaW5jbHVkZSA8c3RkYm9vbC5oPgojaW5jbHVkZSA8c3RkaW50Lmg+
CiNpbmNsdWRlIDxzdGRpby5oPgojaW5jbHVkZSA8c3RkbGliLmg+CiNpbmNsdWRlIDxzdHJpbmcu
aD4KI2luY2x1ZGUgPHN5cy9lcG9sbC5oPgojaW5jbHVkZSA8c3lzL2lvY3RsLmg+CiNpbmNsdWRl
IDxzeXMvbW91bnQuaD4KI2luY2x1ZGUgPHN5cy9wcmN0bC5oPgojaW5jbHVkZSA8c3lzL3Jlc291
cmNlLmg+CiNpbmNsdWRlIDxzeXMvc29ja2V0Lmg+CiNpbmNsdWRlIDxzeXMvc3RhdC5oPgojaW5j
bHVkZSA8c3lzL3N3YXAuaD4KI2luY2x1ZGUgPHN5cy9zeXNjYWxsLmg+CiNpbmNsdWRlIDxzeXMv
dGltZS5oPgojaW5jbHVkZSA8c3lzL3R5cGVzLmg+CiNpbmNsdWRlIDxzeXMvdWlvLmg+CiNpbmNs
dWRlIDxzeXMvd2FpdC5oPgojaW5jbHVkZSA8dGltZS5oPgojaW5jbHVkZSA8dW5pc3RkLmg+Cgoj
aW5jbHVkZSA8bGludXgvY2FwYWJpbGl0eS5oPgojaW5jbHVkZSA8bGludXgvZmFsbG9jLmg+CiNp
bmNsdWRlIDxsaW51eC9mdXRleC5oPgojaW5jbHVkZSA8bGludXgvZ2VuZXRsaW5rLmg+CiNpbmNs
dWRlIDxsaW51eC9pZl9hZGRyLmg+CiNpbmNsdWRlIDxsaW51eC9pZl9ldGhlci5oPgojaW5jbHVk
ZSA8bGludXgvaWZfbGluay5oPgojaW5jbHVkZSA8bGludXgvaWZfdHVuLmg+CiNpbmNsdWRlIDxs
aW51eC9pbjYuaD4KI2luY2x1ZGUgPGxpbnV4L2lwLmg+CiNpbmNsdWRlIDxsaW51eC9uZWlnaGJv
dXIuaD4KI2luY2x1ZGUgPGxpbnV4L25ldC5oPgojaW5jbHVkZSA8bGludXgvbmV0bGluay5oPgoj
aW5jbHVkZSA8bGludXgvbmw4MDIxMS5oPgojaW5jbHVkZSA8bGludXgvcmZraWxsLmg+CiNpbmNs
dWRlIDxsaW51eC9ydG5ldGxpbmsuaD4KI2luY2x1ZGUgPGxpbnV4L3RjcC5oPgojaW5jbHVkZSA8
bGludXgvdmV0aC5oPgoKc3RhdGljIHVuc2lnbmVkIGxvbmcgbG9uZyBwcm9jaWQ7CgpzdGF0aWMg
X190aHJlYWQgaW50IGNsb25lX29uZ29pbmc7CnN0YXRpYyBfX3RocmVhZCBpbnQgc2tpcF9zZWd2
OwpzdGF0aWMgX190aHJlYWQgam1wX2J1ZiBzZWd2X2VudjsKCnN0YXRpYyB2b2lkIHNlZ3ZfaGFu
ZGxlcihpbnQgc2lnLCBzaWdpbmZvX3QqIGluZm8sIHZvaWQqIGN0eCkKewogIGlmIChfX2F0b21p
Y19sb2FkX24oJmNsb25lX29uZ29pbmcsIF9fQVRPTUlDX1JFTEFYRUQpICE9IDApIHsKICAgIGV4
aXQoc2lnKTsKICB9CiAgdWludHB0cl90IGFkZHIgPSAodWludHB0cl90KWluZm8tPnNpX2FkZHI7
CiAgY29uc3QgdWludHB0cl90IHByb2dfc3RhcnQgPSAxIDw8IDIwOwogIGNvbnN0IHVpbnRwdHJf
dCBwcm9nX2VuZCA9IDEwMCA8PCAyMDsKICBpbnQgc2tpcCA9IF9fYXRvbWljX2xvYWRfbigmc2tp
cF9zZWd2LCBfX0FUT01JQ19SRUxBWEVEKSAhPSAwOwogIGludCB2YWxpZCA9IGFkZHIgPCBwcm9n
X3N0YXJ0IHx8IGFkZHIgPiBwcm9nX2VuZDsKICBpZiAoc2tpcCAmJiB2YWxpZCkgewogICAgX2xv
bmdqbXAoc2Vndl9lbnYsIDEpOwogIH0KICBleGl0KHNpZyk7Cn0KCnN0YXRpYyB2b2lkIGluc3Rh
bGxfc2Vndl9oYW5kbGVyKHZvaWQpCnsKICBzdHJ1Y3Qgc2lnYWN0aW9uIHNhOwogIG1lbXNldCgm
c2EsIDAsIHNpemVvZihzYSkpOwogIHNhLnNhX2hhbmRsZXIgPSBTSUdfSUdOOwogIHN5c2NhbGwo
U1lTX3J0X3NpZ2FjdGlvbiwgMHgyMCwgJnNhLCBOVUxMLCA4KTsKICBzeXNjYWxsKFNZU19ydF9z
aWdhY3Rpb24sIDB4MjEsICZzYSwgTlVMTCwgOCk7CiAgbWVtc2V0KCZzYSwgMCwgc2l6ZW9mKHNh
KSk7CiAgc2Euc2Ffc2lnYWN0aW9uID0gc2Vndl9oYW5kbGVyOwogIHNhLnNhX2ZsYWdzID0gU0Ff
Tk9ERUZFUiB8IFNBX1NJR0lORk87CiAgc2lnYWN0aW9uKFNJR1NFR1YsICZzYSwgTlVMTCk7CiAg
c2lnYWN0aW9uKFNJR0JVUywgJnNhLCBOVUxMKTsKfQoKI2RlZmluZSBOT05GQUlMSU5HKC4uLikg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwK
ICAoeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFwKICAgIGludCBvayA9IDE7ICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKICAgIF9fYXRv
bWljX2ZldGNoX2FkZCgmc2tpcF9zZWd2LCAxLCBfX0FUT01JQ19TRVFfQ1NUKTsgICAgICAgICAg
ICAgICAgICAgICAgIFwKICAgIGlmIChfc2V0am1wKHNlZ3ZfZW52KSA9PSAwKSB7ICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKICAgICAgX19WQV9BUkdTX187
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIFwKICAgIH0gZWxzZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKICAgICAgb2sgPSAwOyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKICAg
IF9fYXRvbWljX2ZldGNoX3N1Yigmc2tpcF9zZWd2LCAxLCBfX0FUT01JQ19TRVFfQ1NUKTsgICAg
ICAgICAgICAgICAgICAgICAgIFwKICAgIG9rOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKICB9KQoKc3RhdGlj
IHZvaWQgc2xlZXBfbXModWludDY0X3QgbXMpCnsKICB1c2xlZXAobXMgKiAxMDAwKTsKfQoKc3Rh
dGljIHVpbnQ2NF90IGN1cnJlbnRfdGltZV9tcyh2b2lkKQp7CiAgc3RydWN0IHRpbWVzcGVjIHRz
OwogIGlmIChjbG9ja19nZXR0aW1lKENMT0NLX01PTk9UT05JQywgJnRzKSkKICAgIGV4aXQoMSk7
CiAgcmV0dXJuICh1aW50NjRfdCl0cy50dl9zZWMgKiAxMDAwICsgKHVpbnQ2NF90KXRzLnR2X25z
ZWMgLyAxMDAwMDAwOwp9CgpzdGF0aWMgdm9pZCB1c2VfdGVtcG9yYXJ5X2Rpcih2b2lkKQp7CiAg
Y2hhciB0bXBkaXJfdGVtcGxhdGVbXSA9ICIuL3N5emthbGxlci5YWFhYWFgiOwogIGNoYXIqIHRt
cGRpciA9IG1rZHRlbXAodG1wZGlyX3RlbXBsYXRlKTsKICBpZiAoIXRtcGRpcikKICAgIGV4aXQo
MSk7CiAgaWYgKGNobW9kKHRtcGRpciwgMDc3NykpCiAgICBleGl0KDEpOwogIGlmIChjaGRpcih0
bXBkaXIpKQogICAgZXhpdCgxKTsKfQoKc3RhdGljIHZvaWQgdGhyZWFkX3N0YXJ0KHZvaWQqICgq
Zm4pKHZvaWQqKSwgdm9pZCogYXJnKQp7CiAgcHRocmVhZF90IHRoOwogIHB0aHJlYWRfYXR0cl90
IGF0dHI7CiAgcHRocmVhZF9hdHRyX2luaXQoJmF0dHIpOwogIHB0aHJlYWRfYXR0cl9zZXRzdGFj
a3NpemUoJmF0dHIsIDEyOCA8PCAxMCk7CiAgaW50IGkgPSAwOwogIGZvciAoOyBpIDwgMTAwOyBp
KyspIHsKICAgIGlmIChwdGhyZWFkX2NyZWF0ZSgmdGgsICZhdHRyLCBmbiwgYXJnKSA9PSAwKSB7
CiAgICAgIHB0aHJlYWRfYXR0cl9kZXN0cm95KCZhdHRyKTsKICAgICAgcmV0dXJuOwogICAgfQog
ICAgaWYgKGVycm5vID09IEVBR0FJTikgewogICAgICB1c2xlZXAoNTApOwogICAgICBjb250aW51
ZTsKICAgIH0KICAgIGJyZWFrOwogIH0KICBleGl0KDEpOwp9Cgp0eXBlZGVmIHN0cnVjdCB7CiAg
aW50IHN0YXRlOwp9IGV2ZW50X3Q7CgpzdGF0aWMgdm9pZCBldmVudF9pbml0KGV2ZW50X3QqIGV2
KQp7CiAgZXYtPnN0YXRlID0gMDsKfQoKc3RhdGljIHZvaWQgZXZlbnRfcmVzZXQoZXZlbnRfdCog
ZXYpCnsKICBldi0+c3RhdGUgPSAwOwp9CgpzdGF0aWMgdm9pZCBldmVudF9zZXQoZXZlbnRfdCog
ZXYpCnsKICBpZiAoZXYtPnN0YXRlKQogICAgZXhpdCgxKTsKICBfX2F0b21pY19zdG9yZV9uKCZl
di0+c3RhdGUsIDEsIF9fQVRPTUlDX1JFTEVBU0UpOwogIHN5c2NhbGwoU1lTX2Z1dGV4LCAmZXYt
PnN0YXRlLCBGVVRFWF9XQUtFIHwgRlVURVhfUFJJVkFURV9GTEFHLCAxMDAwMDAwKTsKfQoKc3Rh
dGljIHZvaWQgZXZlbnRfd2FpdChldmVudF90KiBldikKewogIHdoaWxlICghX19hdG9taWNfbG9h
ZF9uKCZldi0+c3RhdGUsIF9fQVRPTUlDX0FDUVVJUkUpKQogICAgc3lzY2FsbChTWVNfZnV0ZXgs
ICZldi0+c3RhdGUsIEZVVEVYX1dBSVQgfCBGVVRFWF9QUklWQVRFX0ZMQUcsIDAsIDApOwp9Cgpz
dGF0aWMgaW50IGV2ZW50X2lzc2V0KGV2ZW50X3QqIGV2KQp7CiAgcmV0dXJuIF9fYXRvbWljX2xv
YWRfbigmZXYtPnN0YXRlLCBfX0FUT01JQ19BQ1FVSVJFKTsKfQoKc3RhdGljIGludCBldmVudF90
aW1lZHdhaXQoZXZlbnRfdCogZXYsIHVpbnQ2NF90IHRpbWVvdXQpCnsKICB1aW50NjRfdCBzdGFy
dCA9IGN1cnJlbnRfdGltZV9tcygpOwogIHVpbnQ2NF90IG5vdyA9IHN0YXJ0OwogIGZvciAoOzsp
IHsKICAgIHVpbnQ2NF90IHJlbWFpbiA9IHRpbWVvdXQgLSAobm93IC0gc3RhcnQpOwogICAgc3Ry
dWN0IHRpbWVzcGVjIHRzOwogICAgdHMudHZfc2VjID0gcmVtYWluIC8gMTAwMDsKICAgIHRzLnR2
X25zZWMgPSAocmVtYWluICUgMTAwMCkgKiAxMDAwICogMTAwMDsKICAgIHN5c2NhbGwoU1lTX2Z1
dGV4LCAmZXYtPnN0YXRlLCBGVVRFWF9XQUlUIHwgRlVURVhfUFJJVkFURV9GTEFHLCAwLCAmdHMp
OwogICAgaWYgKF9fYXRvbWljX2xvYWRfbigmZXYtPnN0YXRlLCBfX0FUT01JQ19BQ1FVSVJFKSkK
ICAgICAgcmV0dXJuIDE7CiAgICBub3cgPSBjdXJyZW50X3RpbWVfbXMoKTsKICAgIGlmIChub3cg
LSBzdGFydCA+IHRpbWVvdXQpCiAgICAgIHJldHVybiAwOwogIH0KfQoKc3RhdGljIGJvb2wgd3Jp
dGVfZmlsZShjb25zdCBjaGFyKiBmaWxlLCBjb25zdCBjaGFyKiB3aGF0LCAuLi4pCnsKICBjaGFy
IGJ1ZlsxMDI0XTsKICB2YV9saXN0IGFyZ3M7CiAgdmFfc3RhcnQoYXJncywgd2hhdCk7CiAgdnNu
cHJpbnRmKGJ1Ziwgc2l6ZW9mKGJ1ZiksIHdoYXQsIGFyZ3MpOwogIHZhX2VuZChhcmdzKTsKICBi
dWZbc2l6ZW9mKGJ1ZikgLSAxXSA9IDA7CiAgaW50IGxlbiA9IHN0cmxlbihidWYpOwogIGludCBm
ZCA9IG9wZW4oZmlsZSwgT19XUk9OTFkgfCBPX0NMT0VYRUMpOwogIGlmIChmZCA9PSAtMSkKICAg
IHJldHVybiBmYWxzZTsKICBpZiAod3JpdGUoZmQsIGJ1ZiwgbGVuKSAhPSBsZW4pIHsKICAgIGlu
dCBlcnIgPSBlcnJubzsKICAgIGNsb3NlKGZkKTsKICAgIGVycm5vID0gZXJyOwogICAgcmV0dXJu
IGZhbHNlOwogIH0KICBjbG9zZShmZCk7CiAgcmV0dXJuIHRydWU7Cn0KCnN0cnVjdCBubG1zZyB7
CiAgY2hhciogcG9zOwogIGludCBuZXN0aW5nOwogIHN0cnVjdCBubGF0dHIqIG5lc3RlZFs4XTsK
ICBjaGFyIGJ1Zls0MDk2XTsKfTsKCnN0YXRpYyB2b2lkIG5ldGxpbmtfaW5pdChzdHJ1Y3Qgbmxt
c2cqIG5sbXNnLCBpbnQgdHlwLCBpbnQgZmxhZ3MsCiAgICAgICAgICAgICAgICAgICAgICAgICBj
b25zdCB2b2lkKiBkYXRhLCBpbnQgc2l6ZSkKewogIG1lbXNldChubG1zZywgMCwgc2l6ZW9mKCpu
bG1zZykpOwogIHN0cnVjdCBubG1zZ2hkciogaGRyID0gKHN0cnVjdCBubG1zZ2hkciopbmxtc2ct
PmJ1ZjsKICBoZHItPm5sbXNnX3R5cGUgPSB0eXA7CiAgaGRyLT5ubG1zZ19mbGFncyA9IE5MTV9G
X1JFUVVFU1QgfCBOTE1fRl9BQ0sgfCBmbGFnczsKICBtZW1jcHkoaGRyICsgMSwgZGF0YSwgc2l6
ZSk7CiAgbmxtc2ctPnBvcyA9IChjaGFyKikoaGRyICsgMSkgKyBOTE1TR19BTElHTihzaXplKTsK
fQoKc3RhdGljIHZvaWQgbmV0bGlua19hdHRyKHN0cnVjdCBubG1zZyogbmxtc2csIGludCB0eXAs
IGNvbnN0IHZvaWQqIGRhdGEsCiAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgc2l6ZSkKewog
IHN0cnVjdCBubGF0dHIqIGF0dHIgPSAoc3RydWN0IG5sYXR0ciopbmxtc2ctPnBvczsKICBhdHRy
LT5ubGFfbGVuID0gc2l6ZW9mKCphdHRyKSArIHNpemU7CiAgYXR0ci0+bmxhX3R5cGUgPSB0eXA7
CiAgaWYgKHNpemUgPiAwKQogICAgbWVtY3B5KGF0dHIgKyAxLCBkYXRhLCBzaXplKTsKICBubG1z
Zy0+cG9zICs9IE5MTVNHX0FMSUdOKGF0dHItPm5sYV9sZW4pOwp9CgpzdGF0aWMgdm9pZCBuZXRs
aW5rX25lc3Qoc3RydWN0IG5sbXNnKiBubG1zZywgaW50IHR5cCkKewogIHN0cnVjdCBubGF0dHIq
IGF0dHIgPSAoc3RydWN0IG5sYXR0ciopbmxtc2ctPnBvczsKICBhdHRyLT5ubGFfdHlwZSA9IHR5
cDsKICBubG1zZy0+cG9zICs9IHNpemVvZigqYXR0cik7CiAgbmxtc2ctPm5lc3RlZFtubG1zZy0+
bmVzdGluZysrXSA9IGF0dHI7Cn0KCnN0YXRpYyB2b2lkIG5ldGxpbmtfZG9uZShzdHJ1Y3Qgbmxt
c2cqIG5sbXNnKQp7CiAgc3RydWN0IG5sYXR0ciogYXR0ciA9IG5sbXNnLT5uZXN0ZWRbLS1ubG1z
Zy0+bmVzdGluZ107CiAgYXR0ci0+bmxhX2xlbiA9IG5sbXNnLT5wb3MgLSAoY2hhciopYXR0cjsK
fQoKc3RhdGljIGludCBuZXRsaW5rX3NlbmRfZXh0KHN0cnVjdCBubG1zZyogbmxtc2csIGludCBz
b2NrLCB1aW50MTZfdCByZXBseV90eXBlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50
KiByZXBseV9sZW4sIGJvb2wgZG9mYWlsKQp7CiAgaWYgKG5sbXNnLT5wb3MgPiBubG1zZy0+YnVm
ICsgc2l6ZW9mKG5sbXNnLT5idWYpIHx8IG5sbXNnLT5uZXN0aW5nKQogICAgZXhpdCgxKTsKICBz
dHJ1Y3Qgbmxtc2doZHIqIGhkciA9IChzdHJ1Y3Qgbmxtc2doZHIqKW5sbXNnLT5idWY7CiAgaGRy
LT5ubG1zZ19sZW4gPSBubG1zZy0+cG9zIC0gbmxtc2ctPmJ1ZjsKICBzdHJ1Y3Qgc29ja2FkZHJf
bmwgYWRkcjsKICBtZW1zZXQoJmFkZHIsIDAsIHNpemVvZihhZGRyKSk7CiAgYWRkci5ubF9mYW1p
bHkgPSBBRl9ORVRMSU5LOwogIHNzaXplX3QgbiA9IHNlbmR0byhzb2NrLCBubG1zZy0+YnVmLCBo
ZHItPm5sbXNnX2xlbiwgMCwKICAgICAgICAgICAgICAgICAgICAgKHN0cnVjdCBzb2NrYWRkciop
JmFkZHIsIHNpemVvZihhZGRyKSk7CiAgaWYgKG4gIT0gKHNzaXplX3QpaGRyLT5ubG1zZ19sZW4p
IHsKICAgIGlmIChkb2ZhaWwpCiAgICAgIGV4aXQoMSk7CiAgICByZXR1cm4gLTE7CiAgfQogIG4g
PSByZWN2KHNvY2ssIG5sbXNnLT5idWYsIHNpemVvZihubG1zZy0+YnVmKSwgMCk7CiAgaWYgKHJl
cGx5X2xlbikKICAgICpyZXBseV9sZW4gPSAwOwogIGlmIChuIDwgMCkgewogICAgaWYgKGRvZmFp
bCkKICAgICAgZXhpdCgxKTsKICAgIHJldHVybiAtMTsKICB9CiAgaWYgKG4gPCAoc3NpemVfdClz
aXplb2Yoc3RydWN0IG5sbXNnaGRyKSkgewogICAgZXJybm8gPSBFSU5WQUw7CiAgICBpZiAoZG9m
YWlsKQogICAgICBleGl0KDEpOwogICAgcmV0dXJuIC0xOwogIH0KICBpZiAoaGRyLT5ubG1zZ190
eXBlID09IE5MTVNHX0RPTkUpCiAgICByZXR1cm4gMDsKICBpZiAocmVwbHlfbGVuICYmIGhkci0+
bmxtc2dfdHlwZSA9PSByZXBseV90eXBlKSB7CiAgICAqcmVwbHlfbGVuID0gbjsKICAgIHJldHVy
biAwOwogIH0KICBpZiAobiA8IChzc2l6ZV90KShzaXplb2Yoc3RydWN0IG5sbXNnaGRyKSArIHNp
emVvZihzdHJ1Y3Qgbmxtc2dlcnIpKSkgewogICAgZXJybm8gPSBFSU5WQUw7CiAgICBpZiAoZG9m
YWlsKQogICAgICBleGl0KDEpOwogICAgcmV0dXJuIC0xOwogIH0KICBpZiAoaGRyLT5ubG1zZ190
eXBlICE9IE5MTVNHX0VSUk9SKSB7CiAgICBlcnJubyA9IEVJTlZBTDsKICAgIGlmIChkb2ZhaWwp
CiAgICAgIGV4aXQoMSk7CiAgICByZXR1cm4gLTE7CiAgfQogIGVycm5vID0gLSgoc3RydWN0IG5s
bXNnZXJyKikoaGRyICsgMSkpLT5lcnJvcjsKICByZXR1cm4gLWVycm5vOwp9CgpzdGF0aWMgaW50
IG5ldGxpbmtfc2VuZChzdHJ1Y3Qgbmxtc2cqIG5sbXNnLCBpbnQgc29jaykKewogIHJldHVybiBu
ZXRsaW5rX3NlbmRfZXh0KG5sbXNnLCBzb2NrLCAwLCBOVUxMLCB0cnVlKTsKfQoKc3RhdGljIGlu
dCBuZXRsaW5rX3F1ZXJ5X2ZhbWlseV9pZChzdHJ1Y3Qgbmxtc2cqIG5sbXNnLCBpbnQgc29jaywK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGFyKiBmYW1pbHlfbmFt
ZSwgYm9vbCBkb2ZhaWwpCnsKICBzdHJ1Y3QgZ2VubG1zZ2hkciBnZW5saGRyOwogIG1lbXNldCgm
Z2VubGhkciwgMCwgc2l6ZW9mKGdlbmxoZHIpKTsKICBnZW5saGRyLmNtZCA9IENUUkxfQ01EX0dF
VEZBTUlMWTsKICBuZXRsaW5rX2luaXQobmxtc2csIEdFTkxfSURfQ1RSTCwgMCwgJmdlbmxoZHIs
IHNpemVvZihnZW5saGRyKSk7CiAgbmV0bGlua19hdHRyKG5sbXNnLCBDVFJMX0FUVFJfRkFNSUxZ
X05BTUUsIGZhbWlseV9uYW1lLAogICAgICAgICAgICAgICBzdHJubGVuKGZhbWlseV9uYW1lLCBH
RU5MX05BTVNJWiAtIDEpICsgMSk7CiAgaW50IG4gPSAwOwogIGludCBlcnIgPSBuZXRsaW5rX3Nl
bmRfZXh0KG5sbXNnLCBzb2NrLCBHRU5MX0lEX0NUUkwsICZuLCBkb2ZhaWwpOwogIGlmIChlcnIg
PCAwKSB7CiAgICByZXR1cm4gLTE7CiAgfQogIHVpbnQxNl90IGlkID0gMDsKICBzdHJ1Y3Qgbmxh
dHRyKiBhdHRyID0gKHN0cnVjdCBubGF0dHIqKShubG1zZy0+YnVmICsgTkxNU0dfSERSTEVOICsK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOTE1TR19BTElHTihzaXpl
b2YoZ2VubGhkcikpKTsKICBmb3IgKDsgKGNoYXIqKWF0dHIgPCBubG1zZy0+YnVmICsgbjsKICAg
ICAgIGF0dHIgPSAoc3RydWN0IG5sYXR0ciopKChjaGFyKilhdHRyICsgTkxNU0dfQUxJR04oYXR0
ci0+bmxhX2xlbikpKSB7CiAgICBpZiAoYXR0ci0+bmxhX3R5cGUgPT0gQ1RSTF9BVFRSX0ZBTUlM
WV9JRCkgewogICAgICBpZCA9ICoodWludDE2X3QqKShhdHRyICsgMSk7CiAgICAgIGJyZWFrOwog
ICAgfQogIH0KICBpZiAoIWlkKSB7CiAgICBlcnJubyA9IEVJTlZBTDsKICAgIHJldHVybiAtMTsK
ICB9CiAgcmVjdihzb2NrLCBubG1zZy0+YnVmLCBzaXplb2Yobmxtc2ctPmJ1ZiksIDApOwogIHJl
dHVybiBpZDsKfQoKc3RhdGljIGludCBuZXRsaW5rX25leHRfbXNnKHN0cnVjdCBubG1zZyogbmxt
c2csIHVuc2lnbmVkIGludCBvZmZzZXQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNp
Z25lZCBpbnQgdG90YWxfbGVuKQp7CiAgc3RydWN0IG5sbXNnaGRyKiBoZHIgPSAoc3RydWN0IG5s
bXNnaGRyKikobmxtc2ctPmJ1ZiArIG9mZnNldCk7CiAgaWYgKG9mZnNldCA9PSB0b3RhbF9sZW4g
fHwgb2Zmc2V0ICsgaGRyLT5ubG1zZ19sZW4gPiB0b3RhbF9sZW4pCiAgICByZXR1cm4gLTE7CiAg
cmV0dXJuIGhkci0+bmxtc2dfbGVuOwp9CgpzdGF0aWMgdm9pZCBuZXRsaW5rX2FkZF9kZXZpY2Vf
aW1wbChzdHJ1Y3Qgbmxtc2cqIG5sbXNnLCBjb25zdCBjaGFyKiB0eXBlLAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGFyKiBuYW1lLCBib29sIHVwKQp7CiAgc3Ry
dWN0IGlmaW5mb21zZyBoZHI7CiAgbWVtc2V0KCZoZHIsIDAsIHNpemVvZihoZHIpKTsKICBpZiAo
dXApCiAgICBoZHIuaWZpX2ZsYWdzID0gaGRyLmlmaV9jaGFuZ2UgPSBJRkZfVVA7CiAgbmV0bGlu
a19pbml0KG5sbXNnLCBSVE1fTkVXTElOSywgTkxNX0ZfRVhDTCB8IE5MTV9GX0NSRUFURSwgJmhk
ciwKICAgICAgICAgICAgICAgc2l6ZW9mKGhkcikpOwogIGlmIChuYW1lKQogICAgbmV0bGlua19h
dHRyKG5sbXNnLCBJRkxBX0lGTkFNRSwgbmFtZSwgc3RybGVuKG5hbWUpKTsKICBuZXRsaW5rX25l
c3Qobmxtc2csIElGTEFfTElOS0lORk8pOwogIG5ldGxpbmtfYXR0cihubG1zZywgSUZMQV9JTkZP
X0tJTkQsIHR5cGUsIHN0cmxlbih0eXBlKSk7Cn0KCnN0YXRpYyB2b2lkIG5ldGxpbmtfYWRkX2Rl
dmljZShzdHJ1Y3Qgbmxtc2cqIG5sbXNnLCBpbnQgc29jaywgY29uc3QgY2hhciogdHlwZSwKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIqIG5hbWUpCnsKICBuZXRsaW5r
X2FkZF9kZXZpY2VfaW1wbChubG1zZywgdHlwZSwgbmFtZSwgZmFsc2UpOwogIG5ldGxpbmtfZG9u
ZShubG1zZyk7CiAgaW50IGVyciA9IG5ldGxpbmtfc2VuZChubG1zZywgc29jayk7CiAgaWYgKGVy
ciA8IDApIHsKICB9Cn0KCnN0YXRpYyB2b2lkIG5ldGxpbmtfYWRkX3ZldGgoc3RydWN0IG5sbXNn
KiBubG1zZywgaW50IHNvY2ssIGNvbnN0IGNoYXIqIG5hbWUsCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgY29uc3QgY2hhciogcGVlcikKewogIG5ldGxpbmtfYWRkX2RldmljZV9pbXBsKG5s
bXNnLCAidmV0aCIsIG5hbWUsIGZhbHNlKTsKICBuZXRsaW5rX25lc3Qobmxtc2csIElGTEFfSU5G
T19EQVRBKTsKICBuZXRsaW5rX25lc3Qobmxtc2csIFZFVEhfSU5GT19QRUVSKTsKICBubG1zZy0+
cG9zICs9IHNpemVvZihzdHJ1Y3QgaWZpbmZvbXNnKTsKICBuZXRsaW5rX2F0dHIobmxtc2csIElG
TEFfSUZOQU1FLCBwZWVyLCBzdHJsZW4ocGVlcikpOwogIG5ldGxpbmtfZG9uZShubG1zZyk7CiAg
bmV0bGlua19kb25lKG5sbXNnKTsKICBuZXRsaW5rX2RvbmUobmxtc2cpOwogIGludCBlcnIgPSBu
ZXRsaW5rX3NlbmQobmxtc2csIHNvY2spOwogIGlmIChlcnIgPCAwKSB7CiAgfQp9CgpzdGF0aWMg
dm9pZCBuZXRsaW5rX2FkZF94ZnJtKHN0cnVjdCBubG1zZyogbmxtc2csIGludCBzb2NrLCBjb25z
dCBjaGFyKiBuYW1lKQp7CiAgbmV0bGlua19hZGRfZGV2aWNlX2ltcGwobmxtc2csICJ4ZnJtIiwg
bmFtZSwgdHJ1ZSk7CiAgbmV0bGlua19uZXN0KG5sbXNnLCBJRkxBX0lORk9fREFUQSk7CiAgaW50
IGlmX2lkID0gMTsKICBuZXRsaW5rX2F0dHIobmxtc2csIDIsICZpZl9pZCwgc2l6ZW9mKGlmX2lk
KSk7CiAgbmV0bGlua19kb25lKG5sbXNnKTsKICBuZXRsaW5rX2RvbmUobmxtc2cpOwogIGludCBl
cnIgPSBuZXRsaW5rX3NlbmQobmxtc2csIHNvY2spOwogIGlmIChlcnIgPCAwKSB7CiAgfQp9Cgpz
dGF0aWMgdm9pZCBuZXRsaW5rX2FkZF9oc3Ioc3RydWN0IG5sbXNnKiBubG1zZywgaW50IHNvY2ss
IGNvbnN0IGNoYXIqIG5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGFy
KiBzbGF2ZTEsIGNvbnN0IGNoYXIqIHNsYXZlMikKewogIG5ldGxpbmtfYWRkX2RldmljZV9pbXBs
KG5sbXNnLCAiaHNyIiwgbmFtZSwgZmFsc2UpOwogIG5ldGxpbmtfbmVzdChubG1zZywgSUZMQV9J
TkZPX0RBVEEpOwogIGludCBpZmluZGV4MSA9IGlmX25hbWV0b2luZGV4KHNsYXZlMSk7CiAgbmV0
bGlua19hdHRyKG5sbXNnLCBJRkxBX0hTUl9TTEFWRTEsICZpZmluZGV4MSwgc2l6ZW9mKGlmaW5k
ZXgxKSk7CiAgaW50IGlmaW5kZXgyID0gaWZfbmFtZXRvaW5kZXgoc2xhdmUyKTsKICBuZXRsaW5r
X2F0dHIobmxtc2csIElGTEFfSFNSX1NMQVZFMiwgJmlmaW5kZXgyLCBzaXplb2YoaWZpbmRleDIp
KTsKICBuZXRsaW5rX2RvbmUobmxtc2cpOwogIG5ldGxpbmtfZG9uZShubG1zZyk7CiAgaW50IGVy
ciA9IG5ldGxpbmtfc2VuZChubG1zZywgc29jayk7CiAgaWYgKGVyciA8IDApIHsKICB9Cn0KCnN0
YXRpYyB2b2lkIG5ldGxpbmtfYWRkX2xpbmtlZChzdHJ1Y3Qgbmxtc2cqIG5sbXNnLCBpbnQgc29j
aywgY29uc3QgY2hhciogdHlwZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0
IGNoYXIqIG5hbWUsIGNvbnN0IGNoYXIqIGxpbmspCnsKICBuZXRsaW5rX2FkZF9kZXZpY2VfaW1w
bChubG1zZywgdHlwZSwgbmFtZSwgZmFsc2UpOwogIG5ldGxpbmtfZG9uZShubG1zZyk7CiAgaW50
IGlmaW5kZXggPSBpZl9uYW1ldG9pbmRleChsaW5rKTsKICBuZXRsaW5rX2F0dHIobmxtc2csIElG
TEFfTElOSywgJmlmaW5kZXgsIHNpemVvZihpZmluZGV4KSk7CiAgaW50IGVyciA9IG5ldGxpbmtf
c2VuZChubG1zZywgc29jayk7CiAgaWYgKGVyciA8IDApIHsKICB9Cn0KCnN0YXRpYyB2b2lkIG5l
dGxpbmtfYWRkX3ZsYW4oc3RydWN0IG5sbXNnKiBubG1zZywgaW50IHNvY2ssIGNvbnN0IGNoYXIq
IG5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hhciogbGluaywgdWlu
dDE2X3QgaWQsIHVpbnQxNl90IHByb3RvKQp7CiAgbmV0bGlua19hZGRfZGV2aWNlX2ltcGwobmxt
c2csICJ2bGFuIiwgbmFtZSwgZmFsc2UpOwogIG5ldGxpbmtfbmVzdChubG1zZywgSUZMQV9JTkZP
X0RBVEEpOwogIG5ldGxpbmtfYXR0cihubG1zZywgSUZMQV9WTEFOX0lELCAmaWQsIHNpemVvZihp
ZCkpOwogIG5ldGxpbmtfYXR0cihubG1zZywgSUZMQV9WTEFOX1BST1RPQ09MLCAmcHJvdG8sIHNp
emVvZihwcm90bykpOwogIG5ldGxpbmtfZG9uZShubG1zZyk7CiAgbmV0bGlua19kb25lKG5sbXNn
KTsKICBpbnQgaWZpbmRleCA9IGlmX25hbWV0b2luZGV4KGxpbmspOwogIG5ldGxpbmtfYXR0cihu
bG1zZywgSUZMQV9MSU5LLCAmaWZpbmRleCwgc2l6ZW9mKGlmaW5kZXgpKTsKICBpbnQgZXJyID0g
bmV0bGlua19zZW5kKG5sbXNnLCBzb2NrKTsKICBpZiAoZXJyIDwgMCkgewogIH0KfQoKc3RhdGlj
IHZvaWQgbmV0bGlua19hZGRfbWFjdmxhbihzdHJ1Y3Qgbmxtc2cqIG5sbXNnLCBpbnQgc29jaywg
Y29uc3QgY2hhciogbmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBj
aGFyKiBsaW5rKQp7CiAgbmV0bGlua19hZGRfZGV2aWNlX2ltcGwobmxtc2csICJtYWN2bGFuIiwg
bmFtZSwgZmFsc2UpOwogIG5ldGxpbmtfbmVzdChubG1zZywgSUZMQV9JTkZPX0RBVEEpOwogIHVp
bnQzMl90IG1vZGUgPSBNQUNWTEFOX01PREVfQlJJREdFOwogIG5ldGxpbmtfYXR0cihubG1zZywg
SUZMQV9NQUNWTEFOX01PREUsICZtb2RlLCBzaXplb2YobW9kZSkpOwogIG5ldGxpbmtfZG9uZShu
bG1zZyk7CiAgbmV0bGlua19kb25lKG5sbXNnKTsKICBpbnQgaWZpbmRleCA9IGlmX25hbWV0b2lu
ZGV4KGxpbmspOwogIG5ldGxpbmtfYXR0cihubG1zZywgSUZMQV9MSU5LLCAmaWZpbmRleCwgc2l6
ZW9mKGlmaW5kZXgpKTsKICBpbnQgZXJyID0gbmV0bGlua19zZW5kKG5sbXNnLCBzb2NrKTsKICBp
ZiAoZXJyIDwgMCkgewogIH0KfQoKc3RhdGljIHZvaWQgbmV0bGlua19hZGRfZ2VuZXZlKHN0cnVj
dCBubG1zZyogbmxtc2csIGludCBzb2NrLCBjb25zdCBjaGFyKiBuYW1lLAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdWludDMyX3Qgdm5pLCBzdHJ1Y3QgaW5fYWRkciogYWRkcjQsCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgaW42X2FkZHIqIGFkZHI2KQp7CiAg
bmV0bGlua19hZGRfZGV2aWNlX2ltcGwobmxtc2csICJnZW5ldmUiLCBuYW1lLCBmYWxzZSk7CiAg
bmV0bGlua19uZXN0KG5sbXNnLCBJRkxBX0lORk9fREFUQSk7CiAgbmV0bGlua19hdHRyKG5sbXNn
LCBJRkxBX0dFTkVWRV9JRCwgJnZuaSwgc2l6ZW9mKHZuaSkpOwogIGlmIChhZGRyNCkKICAgIG5l
dGxpbmtfYXR0cihubG1zZywgSUZMQV9HRU5FVkVfUkVNT1RFLCBhZGRyNCwgc2l6ZW9mKCphZGRy
NCkpOwogIGlmIChhZGRyNikKICAgIG5ldGxpbmtfYXR0cihubG1zZywgSUZMQV9HRU5FVkVfUkVN
T1RFNiwgYWRkcjYsIHNpemVvZigqYWRkcjYpKTsKICBuZXRsaW5rX2RvbmUobmxtc2cpOwogIG5l
dGxpbmtfZG9uZShubG1zZyk7CiAgaW50IGVyciA9IG5ldGxpbmtfc2VuZChubG1zZywgc29jayk7
CiAgaWYgKGVyciA8IDApIHsKICB9Cn0KCiNkZWZpbmUgSUZMQV9JUFZMQU5fRkxBR1MgMgojZGVm
aW5lIElQVkxBTl9NT0RFX0wzUyAyCiN1bmRlZiBJUFZMQU5fRl9WRVBBCiNkZWZpbmUgSVBWTEFO
X0ZfVkVQQSAyCgpzdGF0aWMgdm9pZCBuZXRsaW5rX2FkZF9pcHZsYW4oc3RydWN0IG5sbXNnKiBu
bG1zZywgaW50IHNvY2ssIGNvbnN0IGNoYXIqIG5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBjb25zdCBjaGFyKiBsaW5rLCB1aW50MTZfdCBtb2RlLCB1aW50MTZfdCBmbGFncykK
ewogIG5ldGxpbmtfYWRkX2RldmljZV9pbXBsKG5sbXNnLCAiaXB2bGFuIiwgbmFtZSwgZmFsc2Up
OwogIG5ldGxpbmtfbmVzdChubG1zZywgSUZMQV9JTkZPX0RBVEEpOwogIG5ldGxpbmtfYXR0cihu
bG1zZywgSUZMQV9JUFZMQU5fTU9ERSwgJm1vZGUsIHNpemVvZihtb2RlKSk7CiAgbmV0bGlua19h
dHRyKG5sbXNnLCBJRkxBX0lQVkxBTl9GTEFHUywgJmZsYWdzLCBzaXplb2YoZmxhZ3MpKTsKICBu
ZXRsaW5rX2RvbmUobmxtc2cpOwogIG5ldGxpbmtfZG9uZShubG1zZyk7CiAgaW50IGlmaW5kZXgg
PSBpZl9uYW1ldG9pbmRleChsaW5rKTsKICBuZXRsaW5rX2F0dHIobmxtc2csIElGTEFfTElOSywg
JmlmaW5kZXgsIHNpemVvZihpZmluZGV4KSk7CiAgaW50IGVyciA9IG5ldGxpbmtfc2VuZChubG1z
Zywgc29jayk7CiAgaWYgKGVyciA8IDApIHsKICB9Cn0KCnN0YXRpYyB2b2lkIG5ldGxpbmtfZGV2
aWNlX2NoYW5nZShzdHJ1Y3Qgbmxtc2cqIG5sbXNnLCBpbnQgc29jaywKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIqIG5hbWUsIGJvb2wgdXAsIGNvbnN0IGNoYXIq
IG1hc3RlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHZvaWQqIG1h
YywgaW50IG1hY3NpemUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBj
aGFyKiBuZXdfbmFtZSkKewogIHN0cnVjdCBpZmluZm9tc2cgaGRyOwogIG1lbXNldCgmaGRyLCAw
LCBzaXplb2YoaGRyKSk7CiAgaWYgKHVwKQogICAgaGRyLmlmaV9mbGFncyA9IGhkci5pZmlfY2hh
bmdlID0gSUZGX1VQOwogIGhkci5pZmlfaW5kZXggPSBpZl9uYW1ldG9pbmRleChuYW1lKTsKICBu
ZXRsaW5rX2luaXQobmxtc2csIFJUTV9ORVdMSU5LLCAwLCAmaGRyLCBzaXplb2YoaGRyKSk7CiAg
aWYgKG5ld19uYW1lKQogICAgbmV0bGlua19hdHRyKG5sbXNnLCBJRkxBX0lGTkFNRSwgbmV3X25h
bWUsIHN0cmxlbihuZXdfbmFtZSkpOwogIGlmIChtYXN0ZXIpIHsKICAgIGludCBpZmluZGV4ID0g
aWZfbmFtZXRvaW5kZXgobWFzdGVyKTsKICAgIG5ldGxpbmtfYXR0cihubG1zZywgSUZMQV9NQVNU
RVIsICZpZmluZGV4LCBzaXplb2YoaWZpbmRleCkpOwogIH0KICBpZiAobWFjc2l6ZSkKICAgIG5l
dGxpbmtfYXR0cihubG1zZywgSUZMQV9BRERSRVNTLCBtYWMsIG1hY3NpemUpOwogIGludCBlcnIg
PSBuZXRsaW5rX3NlbmQobmxtc2csIHNvY2spOwogIGlmIChlcnIgPCAwKSB7CiAgfQp9CgpzdGF0
aWMgaW50IG5ldGxpbmtfYWRkX2FkZHIoc3RydWN0IG5sbXNnKiBubG1zZywgaW50IHNvY2ssIGNv
bnN0IGNoYXIqIGRldiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHZvaWQqIGFk
ZHIsIGludCBhZGRyc2l6ZSkKewogIHN0cnVjdCBpZmFkZHJtc2cgaGRyOwogIG1lbXNldCgmaGRy
LCAwLCBzaXplb2YoaGRyKSk7CiAgaGRyLmlmYV9mYW1pbHkgPSBhZGRyc2l6ZSA9PSA0ID8gQUZf
SU5FVCA6IEFGX0lORVQ2OwogIGhkci5pZmFfcHJlZml4bGVuID0gYWRkcnNpemUgPT0gNCA/IDI0
IDogMTIwOwogIGhkci5pZmFfc2NvcGUgPSBSVF9TQ09QRV9VTklWRVJTRTsKICBoZHIuaWZhX2lu
ZGV4ID0gaWZfbmFtZXRvaW5kZXgoZGV2KTsKICBuZXRsaW5rX2luaXQobmxtc2csIFJUTV9ORVdB
RERSLCBOTE1fRl9DUkVBVEUgfCBOTE1fRl9SRVBMQUNFLCAmaGRyLAogICAgICAgICAgICAgICBz
aXplb2YoaGRyKSk7CiAgbmV0bGlua19hdHRyKG5sbXNnLCBJRkFfTE9DQUwsIGFkZHIsIGFkZHJz
aXplKTsKICBuZXRsaW5rX2F0dHIobmxtc2csIElGQV9BRERSRVNTLCBhZGRyLCBhZGRyc2l6ZSk7
CiAgcmV0dXJuIG5ldGxpbmtfc2VuZChubG1zZywgc29jayk7Cn0KCnN0YXRpYyB2b2lkIG5ldGxp
bmtfYWRkX2FkZHI0KHN0cnVjdCBubG1zZyogbmxtc2csIGludCBzb2NrLCBjb25zdCBjaGFyKiBk
ZXYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIqIGFkZHIpCnsKICBz
dHJ1Y3QgaW5fYWRkciBpbl9hZGRyOwogIGluZXRfcHRvbihBRl9JTkVULCBhZGRyLCAmaW5fYWRk
cik7CiAgaW50IGVyciA9IG5ldGxpbmtfYWRkX2FkZHIobmxtc2csIHNvY2ssIGRldiwgJmluX2Fk
ZHIsIHNpemVvZihpbl9hZGRyKSk7CiAgaWYgKGVyciA8IDApIHsKICB9Cn0KCnN0YXRpYyB2b2lk
IG5ldGxpbmtfYWRkX2FkZHI2KHN0cnVjdCBubG1zZyogbmxtc2csIGludCBzb2NrLCBjb25zdCBj
aGFyKiBkZXYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIqIGFkZHIp
CnsKICBzdHJ1Y3QgaW42X2FkZHIgaW42X2FkZHI7CiAgaW5ldF9wdG9uKEFGX0lORVQ2LCBhZGRy
LCAmaW42X2FkZHIpOwogIGludCBlcnIgPSBuZXRsaW5rX2FkZF9hZGRyKG5sbXNnLCBzb2NrLCBk
ZXYsICZpbjZfYWRkciwgc2l6ZW9mKGluNl9hZGRyKSk7CiAgaWYgKGVyciA8IDApIHsKICB9Cn0K
CnN0YXRpYyB2b2lkIG5ldGxpbmtfYWRkX25laWdoKHN0cnVjdCBubG1zZyogbmxtc2csIGludCBz
b2NrLCBjb25zdCBjaGFyKiBuYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25z
dCB2b2lkKiBhZGRyLCBpbnQgYWRkcnNpemUsIGNvbnN0IHZvaWQqIG1hYywKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgaW50IG1hY3NpemUpCnsKICBzdHJ1Y3QgbmRtc2cgaGRyOwogIG1l
bXNldCgmaGRyLCAwLCBzaXplb2YoaGRyKSk7CiAgaGRyLm5kbV9mYW1pbHkgPSBhZGRyc2l6ZSA9
PSA0ID8gQUZfSU5FVCA6IEFGX0lORVQ2OwogIGhkci5uZG1faWZpbmRleCA9IGlmX25hbWV0b2lu
ZGV4KG5hbWUpOwogIGhkci5uZG1fc3RhdGUgPSBOVURfUEVSTUFORU5UOwogIG5ldGxpbmtfaW5p
dChubG1zZywgUlRNX05FV05FSUdILCBOTE1fRl9FWENMIHwgTkxNX0ZfQ1JFQVRFLCAmaGRyLAog
ICAgICAgICAgICAgICBzaXplb2YoaGRyKSk7CiAgbmV0bGlua19hdHRyKG5sbXNnLCBOREFfRFNU
LCBhZGRyLCBhZGRyc2l6ZSk7CiAgbmV0bGlua19hdHRyKG5sbXNnLCBOREFfTExBRERSLCBtYWMs
IG1hY3NpemUpOwogIGludCBlcnIgPSBuZXRsaW5rX3NlbmQobmxtc2csIHNvY2spOwogIGlmIChl
cnIgPCAwKSB7CiAgfQp9CgpzdGF0aWMgc3RydWN0IG5sbXNnIG5sbXNnOwoKc3RhdGljIGludCB0
dW5mZCA9IC0xOwoKI2RlZmluZSBUVU5fSUZBQ0UgInN5el90dW4iCiNkZWZpbmUgTE9DQUxfTUFD
IDB4YWFhYWFhYWFhYWFhCiNkZWZpbmUgUkVNT1RFX01BQyAweGFhYWFhYWFhYWFiYgojZGVmaW5l
IExPQ0FMX0lQVjQgIjE3Mi4yMC4yMC4xNzAiCiNkZWZpbmUgUkVNT1RFX0lQVjQgIjE3Mi4yMC4y
MC4xODciCiNkZWZpbmUgTE9DQUxfSVBWNiAiZmU4MDo6YWEiCiNkZWZpbmUgUkVNT1RFX0lQVjYg
ImZlODA6OmJiIgoKI2RlZmluZSBJRkZfTkFQSSAweDAwMTAKCnN0YXRpYyB2b2lkIGluaXRpYWxp
emVfdHVuKHZvaWQpCnsKICB0dW5mZCA9IG9wZW4oIi9kZXYvbmV0L3R1biIsIE9fUkRXUiB8IE9f
Tk9OQkxPQ0spOwogIGlmICh0dW5mZCA9PSAtMSkgewogICAgcHJpbnRmKCJ0dW46IGNhbid0IG9w
ZW4gL2Rldi9uZXQvdHVuOiBwbGVhc2UgZW5hYmxlIENPTkZJR19UVU49eVxuIik7CiAgICBwcmlu
dGYoIm90aGVyd2lzZSBmdXp6aW5nIG9yIHJlcHJvZHVjaW5nIG1pZ2h0IG5vdCB3b3JrIGFzIGlu
dGVuZGVkXG4iKTsKICAgIHJldHVybjsKICB9CiAgY29uc3QgaW50IGtUdW5GZCA9IDIwMDsKICBp
ZiAoZHVwMih0dW5mZCwga1R1bkZkKSA8IDApCiAgICBleGl0KDEpOwogIGNsb3NlKHR1bmZkKTsK
ICB0dW5mZCA9IGtUdW5GZDsKICBzdHJ1Y3QgaWZyZXEgaWZyOwogIG1lbXNldCgmaWZyLCAwLCBz
aXplb2YoaWZyKSk7CiAgc3RybmNweShpZnIuaWZyX25hbWUsIFRVTl9JRkFDRSwgSUZOQU1TSVop
OwogIGlmci5pZnJfZmxhZ3MgPSBJRkZfVEFQIHwgSUZGX05PX1BJOwogIGlmIChpb2N0bCh0dW5m
ZCwgVFVOU0VUSUZGLCAodm9pZCopJmlmcikgPCAwKSB7CiAgICBleGl0KDEpOwogIH0KICBjaGFy
IHN5c2N0bFs2NF07CiAgc3ByaW50ZihzeXNjdGwsICIvcHJvYy9zeXMvbmV0L2lwdjYvY29uZi8l
cy9hY2NlcHRfZGFkIiwgVFVOX0lGQUNFKTsKICB3cml0ZV9maWxlKHN5c2N0bCwgIjAiKTsKICBz
cHJpbnRmKHN5c2N0bCwgIi9wcm9jL3N5cy9uZXQvaXB2Ni9jb25mLyVzL3JvdXRlcl9zb2xpY2l0
YXRpb25zIiwgVFVOX0lGQUNFKTsKICB3cml0ZV9maWxlKHN5c2N0bCwgIjAiKTsKICBpbnQgc29j
ayA9IHNvY2tldChBRl9ORVRMSU5LLCBTT0NLX1JBVywgTkVUTElOS19ST1VURSk7CiAgaWYgKHNv
Y2sgPT0gLTEpCiAgICBleGl0KDEpOwogIG5ldGxpbmtfYWRkX2FkZHI0KCZubG1zZywgc29jaywg
VFVOX0lGQUNFLCBMT0NBTF9JUFY0KTsKICBuZXRsaW5rX2FkZF9hZGRyNigmbmxtc2csIHNvY2ss
IFRVTl9JRkFDRSwgTE9DQUxfSVBWNik7CiAgdWludDY0X3QgbWFjYWRkciA9IFJFTU9URV9NQUM7
CiAgc3RydWN0IGluX2FkZHIgaW5fYWRkcjsKICBpbmV0X3B0b24oQUZfSU5FVCwgUkVNT1RFX0lQ
VjQsICZpbl9hZGRyKTsKICBuZXRsaW5rX2FkZF9uZWlnaCgmbmxtc2csIHNvY2ssIFRVTl9JRkFD
RSwgJmluX2FkZHIsIHNpemVvZihpbl9hZGRyKSwKICAgICAgICAgICAgICAgICAgICAmbWFjYWRk
ciwgRVRIX0FMRU4pOwogIHN0cnVjdCBpbjZfYWRkciBpbjZfYWRkcjsKICBpbmV0X3B0b24oQUZf
SU5FVDYsIFJFTU9URV9JUFY2LCAmaW42X2FkZHIpOwogIG5ldGxpbmtfYWRkX25laWdoKCZubG1z
Zywgc29jaywgVFVOX0lGQUNFLCAmaW42X2FkZHIsIHNpemVvZihpbjZfYWRkciksCiAgICAgICAg
ICAgICAgICAgICAgJm1hY2FkZHIsIEVUSF9BTEVOKTsKICBtYWNhZGRyID0gTE9DQUxfTUFDOwog
IG5ldGxpbmtfZGV2aWNlX2NoYW5nZSgmbmxtc2csIHNvY2ssIFRVTl9JRkFDRSwgdHJ1ZSwgMCwg
Jm1hY2FkZHIsIEVUSF9BTEVOLAogICAgICAgICAgICAgICAgICAgICAgICBOVUxMKTsKICBjbG9z
ZShzb2NrKTsKfQoKY29uc3QgaW50IGtJbml0TmV0TnNGZCA9IDIwMTsKCiNkZWZpbmUgREVWTElO
S19GQU1JTFlfTkFNRSAiZGV2bGluayIKCiNkZWZpbmUgREVWTElOS19DTURfUE9SVF9HRVQgNQoj
ZGVmaW5lIERFVkxJTktfQVRUUl9CVVNfTkFNRSAxCiNkZWZpbmUgREVWTElOS19BVFRSX0RFVl9O
QU1FIDIKI2RlZmluZSBERVZMSU5LX0FUVFJfTkVUREVWX05BTUUgNwoKc3RhdGljIHN0cnVjdCBu
bG1zZyBubG1zZzI7CgpzdGF0aWMgdm9pZCBpbml0aWFsaXplX2RldmxpbmtfcG9ydHMoY29uc3Qg
Y2hhciogYnVzX25hbWUsIGNvbnN0IGNoYXIqIGRldl9uYW1lLAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgY29uc3QgY2hhciogbmV0ZGV2X3ByZWZpeCkKewogIHN0cnVjdCBn
ZW5sbXNnaGRyIGdlbmxoZHI7CiAgaW50IGxlbiwgdG90YWxfbGVuLCBpZCwgZXJyLCBvZmZzZXQ7
CiAgdWludDE2X3QgbmV0ZGV2X2luZGV4OwogIGludCBzb2NrID0gc29ja2V0KEFGX05FVExJTkss
IFNPQ0tfUkFXLCBORVRMSU5LX0dFTkVSSUMpOwogIGlmIChzb2NrID09IC0xKQogICAgZXhpdCgx
KTsKICBpbnQgcnRzb2NrID0gc29ja2V0KEFGX05FVExJTkssIFNPQ0tfUkFXLCBORVRMSU5LX1JP
VVRFKTsKICBpZiAocnRzb2NrID09IC0xKQogICAgZXhpdCgxKTsKICBpZCA9IG5ldGxpbmtfcXVl
cnlfZmFtaWx5X2lkKCZubG1zZywgc29jaywgREVWTElOS19GQU1JTFlfTkFNRSwgdHJ1ZSk7CiAg
aWYgKGlkID09IC0xKQogICAgZ290byBlcnJvcjsKICBtZW1zZXQoJmdlbmxoZHIsIDAsIHNpemVv
ZihnZW5saGRyKSk7CiAgZ2VubGhkci5jbWQgPSBERVZMSU5LX0NNRF9QT1JUX0dFVDsKICBuZXRs
aW5rX2luaXQoJm5sbXNnLCBpZCwgTkxNX0ZfRFVNUCwgJmdlbmxoZHIsIHNpemVvZihnZW5saGRy
KSk7CiAgbmV0bGlua19hdHRyKCZubG1zZywgREVWTElOS19BVFRSX0JVU19OQU1FLCBidXNfbmFt
ZSwgc3RybGVuKGJ1c19uYW1lKSArIDEpOwogIG5ldGxpbmtfYXR0cigmbmxtc2csIERFVkxJTktf
QVRUUl9ERVZfTkFNRSwgZGV2X25hbWUsIHN0cmxlbihkZXZfbmFtZSkgKyAxKTsKICBlcnIgPSBu
ZXRsaW5rX3NlbmRfZXh0KCZubG1zZywgc29jaywgaWQsICZ0b3RhbF9sZW4sIHRydWUpOwogIGlm
IChlcnIgPCAwKSB7CiAgICBnb3RvIGVycm9yOwogIH0KICBvZmZzZXQgPSAwOwogIG5ldGRldl9p
bmRleCA9IDA7CiAgd2hpbGUgKChsZW4gPSBuZXRsaW5rX25leHRfbXNnKCZubG1zZywgb2Zmc2V0
LCB0b3RhbF9sZW4pKSAhPSAtMSkgewogICAgc3RydWN0IG5sYXR0ciogYXR0ciA9IChzdHJ1Y3Qg
bmxhdHRyKikobmxtc2cuYnVmICsgb2Zmc2V0ICsgTkxNU0dfSERSTEVOICsKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5MTVNHX0FMSUdOKHNpemVvZihnZW5saGRy
KSkpOwogICAgZm9yICg7IChjaGFyKilhdHRyIDwgbmxtc2cuYnVmICsgb2Zmc2V0ICsgbGVuOwog
ICAgICAgICBhdHRyID0gKHN0cnVjdCBubGF0dHIqKSgoY2hhciopYXR0ciArIE5MTVNHX0FMSUdO
KGF0dHItPm5sYV9sZW4pKSkgewogICAgICBpZiAoYXR0ci0+bmxhX3R5cGUgPT0gREVWTElOS19B
VFRSX05FVERFVl9OQU1FKSB7CiAgICAgICAgY2hhciogcG9ydF9uYW1lOwogICAgICAgIGNoYXIg
bmV0ZGV2X25hbWVbSUZOQU1TSVpdOwogICAgICAgIHBvcnRfbmFtZSA9IChjaGFyKikoYXR0ciAr
IDEpOwogICAgICAgIHNucHJpbnRmKG5ldGRldl9uYW1lLCBzaXplb2YobmV0ZGV2X25hbWUpLCAi
JXMlZCIsIG5ldGRldl9wcmVmaXgsCiAgICAgICAgICAgICAgICAgbmV0ZGV2X2luZGV4KTsKICAg
ICAgICBuZXRsaW5rX2RldmljZV9jaGFuZ2UoJm5sbXNnMiwgcnRzb2NrLCBwb3J0X25hbWUsIHRy
dWUsIDAsIDAsIDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldGRldl9uYW1lKTsK
ICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogICAgb2Zmc2V0ICs9IGxlbjsKICAgIG5ldGRl
dl9pbmRleCsrOwogIH0KZXJyb3I6CiAgY2xvc2UocnRzb2NrKTsKICBjbG9zZShzb2NrKTsKfQoK
I2RlZmluZSBXSUZJX0lOSVRJQUxfREVWSUNFX0NPVU5UIDIKI2RlZmluZSBXSUZJX01BQ19CQVNF
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IFwKICB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIFwKICAgIDB4MDgsIDB4MDIsIDB4MTEsIDB4MDAsIDB4
MDAsIDB4MDAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKICB9CiNk
ZWZpbmUgV0lGSV9JQlNTX0JTU0lEICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBcCiAgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCiAgICAweDUwLCAw
eDUwLCAweDUwLCAweDUwLCAweDUwLCAweDUwICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBcCiAgfQojZGVmaW5lIFdJRklfSUJTU19TU0lEICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAogIHsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgXAogICAgMHgxMCwgMHgxMCwgMHgxMCwgMHgxMCwgMHgxMCwgMHgxMCAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAogIH0KI2RlZmluZSBXSUZJX0RFRkFVTFRf
RlJFUVVFTkNZIDI0MTIKI2RlZmluZSBXSUZJX0RFRkFVTFRfU0lHTkFMIDAKI2RlZmluZSBXSUZJ
X0RFRkFVTFRfUlhfUkFURSAxCiNkZWZpbmUgSFdTSU1fQ01EX1JFR0lTVEVSIDEKI2RlZmluZSBI
V1NJTV9DTURfRlJBTUUgMgojZGVmaW5lIEhXU0lNX0NNRF9ORVdfUkFESU8gNAojZGVmaW5lIEhX
U0lNX0FUVFJfU1VQUE9SVF9QMlBfREVWSUNFIDE0CiNkZWZpbmUgSFdTSU1fQVRUUl9QRVJNX0FE
RFIgMjIKCiNkZWZpbmUgSUZfT1BFUl9VUCA2CnN0cnVjdCBqb2luX2lic3NfcHJvcHMgewogIGlu
dCB3aXBoeV9mcmVxOwogIGJvb2wgd2lwaHlfZnJlcV9maXhlZDsKICB1aW50OF90KiBtYWM7CiAg
dWludDhfdCogc3NpZDsKICBpbnQgc3NpZF9sZW47Cn07CgpzdGF0aWMgaW50IHNldF9pbnRlcmZh
Y2Vfc3RhdGUoY29uc3QgY2hhciogaW50ZXJmYWNlX25hbWUsIGludCBvbikKewogIHN0cnVjdCBp
ZnJlcSBpZnI7CiAgaW50IHNvY2sgPSBzb2NrZXQoQUZfSU5FVCwgU09DS19ER1JBTSwgMCk7CiAg
aWYgKHNvY2sgPCAwKSB7CiAgICByZXR1cm4gLTE7CiAgfQogIG1lbXNldCgmaWZyLCAwLCBzaXpl
b2YoaWZyKSk7CiAgc3RyY3B5KGlmci5pZnJfbmFtZSwgaW50ZXJmYWNlX25hbWUpOwogIGludCBy
ZXQgPSBpb2N0bChzb2NrLCBTSU9DR0lGRkxBR1MsICZpZnIpOwogIGlmIChyZXQgPCAwKSB7CiAg
ICBjbG9zZShzb2NrKTsKICAgIHJldHVybiAtMTsKICB9CiAgaWYgKG9uKQogICAgaWZyLmlmcl9m
bGFncyB8PSBJRkZfVVA7CiAgZWxzZQogICAgaWZyLmlmcl9mbGFncyAmPSB+SUZGX1VQOwogIHJl
dCA9IGlvY3RsKHNvY2ssIFNJT0NTSUZGTEFHUywgJmlmcik7CiAgY2xvc2Uoc29jayk7CiAgaWYg
KHJldCA8IDApIHsKICAgIHJldHVybiAtMTsKICB9CiAgcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbnQg
bmw4MDIxMV9zZXRfaW50ZXJmYWNlKHN0cnVjdCBubG1zZyogbmxtc2csIGludCBzb2NrLAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgbmw4MDIxMV9mYW1pbHksIHVpbnQzMl90
IGlmaW5kZXgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IGlmdHlw
ZSwgYm9vbCBkb2ZhaWwpCnsKICBzdHJ1Y3QgZ2VubG1zZ2hkciBnZW5saGRyOwogIG1lbXNldCgm
Z2VubGhkciwgMCwgc2l6ZW9mKGdlbmxoZHIpKTsKICBnZW5saGRyLmNtZCA9IE5MODAyMTFfQ01E
X1NFVF9JTlRFUkZBQ0U7CiAgbmV0bGlua19pbml0KG5sbXNnLCBubDgwMjExX2ZhbWlseSwgMCwg
JmdlbmxoZHIsIHNpemVvZihnZW5saGRyKSk7CiAgbmV0bGlua19hdHRyKG5sbXNnLCBOTDgwMjEx
X0FUVFJfSUZJTkRFWCwgJmlmaW5kZXgsIHNpemVvZihpZmluZGV4KSk7CiAgbmV0bGlua19hdHRy
KG5sbXNnLCBOTDgwMjExX0FUVFJfSUZUWVBFLCAmaWZ0eXBlLCBzaXplb2YoaWZ0eXBlKSk7CiAg
aW50IGVyciA9IG5ldGxpbmtfc2VuZF9leHQobmxtc2csIHNvY2ssIDAsIE5VTEwsIGRvZmFpbCk7
CiAgaWYgKGVyciA8IDApIHsKICB9CiAgcmV0dXJuIGVycjsKfQoKc3RhdGljIGludCBubDgwMjEx
X2pvaW5faWJzcyhzdHJ1Y3Qgbmxtc2cqIG5sbXNnLCBpbnQgc29jaywgaW50IG5sODAyMTFfZmFt
aWx5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IGlmaW5kZXgsIHN0cnVj
dCBqb2luX2lic3NfcHJvcHMqIHByb3BzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJv
b2wgZG9mYWlsKQp7CiAgc3RydWN0IGdlbmxtc2doZHIgZ2VubGhkcjsKICBtZW1zZXQoJmdlbmxo
ZHIsIDAsIHNpemVvZihnZW5saGRyKSk7CiAgZ2VubGhkci5jbWQgPSBOTDgwMjExX0NNRF9KT0lO
X0lCU1M7CiAgbmV0bGlua19pbml0KG5sbXNnLCBubDgwMjExX2ZhbWlseSwgMCwgJmdlbmxoZHIs
IHNpemVvZihnZW5saGRyKSk7CiAgbmV0bGlua19hdHRyKG5sbXNnLCBOTDgwMjExX0FUVFJfSUZJ
TkRFWCwgJmlmaW5kZXgsIHNpemVvZihpZmluZGV4KSk7CiAgbmV0bGlua19hdHRyKG5sbXNnLCBO
TDgwMjExX0FUVFJfU1NJRCwgcHJvcHMtPnNzaWQsIHByb3BzLT5zc2lkX2xlbik7CiAgbmV0bGlu
a19hdHRyKG5sbXNnLCBOTDgwMjExX0FUVFJfV0lQSFlfRlJFUSwgJihwcm9wcy0+d2lwaHlfZnJl
cSksCiAgICAgICAgICAgICAgIHNpemVvZihwcm9wcy0+d2lwaHlfZnJlcSkpOwogIGlmIChwcm9w
cy0+bWFjKQogICAgbmV0bGlua19hdHRyKG5sbXNnLCBOTDgwMjExX0FUVFJfTUFDLCBwcm9wcy0+
bWFjLCBFVEhfQUxFTik7CiAgaWYgKHByb3BzLT53aXBoeV9mcmVxX2ZpeGVkKQogICAgbmV0bGlu
a19hdHRyKG5sbXNnLCBOTDgwMjExX0FUVFJfRlJFUV9GSVhFRCwgTlVMTCwgMCk7CiAgaW50IGVy
ciA9IG5ldGxpbmtfc2VuZF9leHQobmxtc2csIHNvY2ssIDAsIE5VTEwsIGRvZmFpbCk7CiAgaWYg
KGVyciA8IDApIHsKICB9CiAgcmV0dXJuIGVycjsKfQoKc3RhdGljIGludCBnZXRfaWZsYV9vcGVy
c3RhdGUoc3RydWN0IG5sbXNnKiBubG1zZywgaW50IGlmaW5kZXgsIGJvb2wgZG9mYWlsKQp7CiAg
c3RydWN0IGlmaW5mb21zZyBpbmZvOwogIG1lbXNldCgmaW5mbywgMCwgc2l6ZW9mKGluZm8pKTsK
ICBpbmZvLmlmaV9mYW1pbHkgPSBBRl9VTlNQRUM7CiAgaW5mby5pZmlfaW5kZXggPSBpZmluZGV4
OwogIGludCBzb2NrID0gc29ja2V0KEFGX05FVExJTkssIFNPQ0tfUkFXLCBORVRMSU5LX1JPVVRF
KTsKICBpZiAoc29jayA9PSAtMSkgewogICAgcmV0dXJuIC0xOwogIH0KICBuZXRsaW5rX2luaXQo
bmxtc2csIFJUTV9HRVRMSU5LLCAwLCAmaW5mbywgc2l6ZW9mKGluZm8pKTsKICBpbnQgbjsKICBp
bnQgZXJyID0gbmV0bGlua19zZW5kX2V4dChubG1zZywgc29jaywgUlRNX05FV0xJTkssICZuLCBk
b2ZhaWwpOwogIGNsb3NlKHNvY2spOwogIGlmIChlcnIpIHsKICAgIHJldHVybiAtMTsKICB9CiAg
c3RydWN0IHJ0YXR0ciogYXR0ciA9IElGTEFfUlRBKE5MTVNHX0RBVEEobmxtc2ctPmJ1ZikpOwog
IGZvciAoOyBSVEFfT0soYXR0ciwgbik7IGF0dHIgPSBSVEFfTkVYVChhdHRyLCBuKSkgewogICAg
aWYgKGF0dHItPnJ0YV90eXBlID09IElGTEFfT1BFUlNUQVRFKQogICAgICByZXR1cm4gKigoaW50
MzJfdCopUlRBX0RBVEEoYXR0cikpOwogIH0KICByZXR1cm4gLTE7Cn0KCnN0YXRpYyBpbnQgYXdh
aXRfaWZsYV9vcGVyc3RhdGUoc3RydWN0IG5sbXNnKiBubG1zZywgY2hhciogaW50ZXJmYWNlLAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBvcGVyc3RhdGUsIGJvb2wgZG9mYWls
KQp7CiAgaW50IGlmaW5kZXggPSBpZl9uYW1ldG9pbmRleChpbnRlcmZhY2UpOwogIHdoaWxlICh0
cnVlKSB7CiAgICB1c2xlZXAoMTAwMCk7CiAgICBpbnQgcmV0ID0gZ2V0X2lmbGFfb3BlcnN0YXRl
KG5sbXNnLCBpZmluZGV4LCBkb2ZhaWwpOwogICAgaWYgKHJldCA8IDApCiAgICAgIHJldHVybiBy
ZXQ7CiAgICBpZiAocmV0ID09IG9wZXJzdGF0ZSkKICAgICAgcmV0dXJuIDA7CiAgfQogIHJldHVy
biAwOwp9CgpzdGF0aWMgaW50IG5sODAyMTFfc2V0dXBfaWJzc19pbnRlcmZhY2Uoc3RydWN0IG5s
bXNnKiBubG1zZywgaW50IHNvY2ssCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBpbnQgbmw4MDIxMV9mYW1pbHlfaWQsIGNoYXIqIGludGVyZmFjZSwKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBqb2luX2lic3NfcHJvcHMqIGlic3Nf
cHJvcHMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib29sIGRvZmFp
bCkKewogIGludCBpZmluZGV4ID0gaWZfbmFtZXRvaW5kZXgoaW50ZXJmYWNlKTsKICBpZiAoaWZp
bmRleCA9PSAwKSB7CiAgICByZXR1cm4gLTE7CiAgfQogIGludCByZXQgPSBubDgwMjExX3NldF9p
bnRlcmZhY2Uobmxtc2csIHNvY2ssIG5sODAyMTFfZmFtaWx5X2lkLCBpZmluZGV4LAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgTkw4MDIxMV9JRlRZUEVfQURIT0MsIGRvZmFpbCk7
CiAgaWYgKHJldCA8IDApIHsKICAgIHJldHVybiAtMTsKICB9CiAgcmV0ID0gc2V0X2ludGVyZmFj
ZV9zdGF0ZShpbnRlcmZhY2UsIDEpOwogIGlmIChyZXQgPCAwKSB7CiAgICByZXR1cm4gLTE7CiAg
fQogIHJldCA9IG5sODAyMTFfam9pbl9pYnNzKG5sbXNnLCBzb2NrLCBubDgwMjExX2ZhbWlseV9p
ZCwgaWZpbmRleCwgaWJzc19wcm9wcywKICAgICAgICAgICAgICAgICAgICAgICAgICBkb2ZhaWwp
OwogIGlmIChyZXQgPCAwKSB7CiAgICByZXR1cm4gLTE7CiAgfQogIHJldHVybiAwOwp9CgpzdGF0
aWMgaW50IGh3c2ltODAyMTFfY3JlYXRlX2RldmljZShzdHJ1Y3Qgbmxtc2cqIG5sbXNnLCBpbnQg
c29jaywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IGh3c2ltX2ZhbWls
eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDhfdCBtYWNfYWRkcltF
VEhfQUxFTl0pCnsKICBzdHJ1Y3QgZ2VubG1zZ2hkciBnZW5saGRyOwogIG1lbXNldCgmZ2VubGhk
ciwgMCwgc2l6ZW9mKGdlbmxoZHIpKTsKICBnZW5saGRyLmNtZCA9IEhXU0lNX0NNRF9ORVdfUkFE
SU87CiAgbmV0bGlua19pbml0KG5sbXNnLCBod3NpbV9mYW1pbHksIDAsICZnZW5saGRyLCBzaXpl
b2YoZ2VubGhkcikpOwogIG5ldGxpbmtfYXR0cihubG1zZywgSFdTSU1fQVRUUl9TVVBQT1JUX1Ay
UF9ERVZJQ0UsIE5VTEwsIDApOwogIG5ldGxpbmtfYXR0cihubG1zZywgSFdTSU1fQVRUUl9QRVJN
X0FERFIsIG1hY19hZGRyLCBFVEhfQUxFTik7CiAgaW50IGVyciA9IG5ldGxpbmtfc2VuZChubG1z
Zywgc29jayk7CiAgaWYgKGVyciA8IDApIHsKICB9CiAgcmV0dXJuIGVycjsKfQoKc3RhdGljIHZv
aWQgaW5pdGlhbGl6ZV93aWZpX2RldmljZXModm9pZCkKewogIGludCByZmtpbGwgPSBvcGVuKCIv
ZGV2L3Jma2lsbCIsIE9fUkRXUik7CiAgaWYgKHJma2lsbCA9PSAtMSkKICAgIGV4aXQoMSk7CiAg
c3RydWN0IHJma2lsbF9ldmVudCBldmVudCA9IHswfTsKICBldmVudC50eXBlID0gUkZLSUxMX1RZ
UEVfQUxMOwogIGV2ZW50Lm9wID0gUkZLSUxMX09QX0NIQU5HRV9BTEw7CiAgaWYgKHdyaXRlKHJm
a2lsbCwgJmV2ZW50LCBzaXplb2YoZXZlbnQpKSAhPSAoc3NpemVfdCkoc2l6ZW9mKGV2ZW50KSkp
CiAgICBleGl0KDEpOwogIGNsb3NlKHJma2lsbCk7CiAgdWludDhfdCBtYWNfYWRkcls2XSA9IFdJ
RklfTUFDX0JBU0U7CiAgaW50IHNvY2sgPSBzb2NrZXQoQUZfTkVUTElOSywgU09DS19SQVcsIE5F
VExJTktfR0VORVJJQyk7CiAgaWYgKHNvY2sgPCAwKQogICAgZXhpdCgxKTsKICBpbnQgaHdzaW1f
ZmFtaWx5X2lkID0KICAgICAgbmV0bGlua19xdWVyeV9mYW1pbHlfaWQoJm5sbXNnLCBzb2NrLCAi
TUFDODAyMTFfSFdTSU0iLCB0cnVlKTsKICBpbnQgbmw4MDIxMV9mYW1pbHlfaWQgPQogICAgICBu
ZXRsaW5rX3F1ZXJ5X2ZhbWlseV9pZCgmbmxtc2csIHNvY2ssICJubDgwMjExIiwgdHJ1ZSk7CiAg
dWludDhfdCBzc2lkW10gPSBXSUZJX0lCU1NfU1NJRDsKICB1aW50OF90IGJzc2lkW10gPSBXSUZJ
X0lCU1NfQlNTSUQ7CiAgc3RydWN0IGpvaW5faWJzc19wcm9wcyBpYnNzX3Byb3BzID0gey53aXBo
eV9mcmVxID0gV0lGSV9ERUZBVUxUX0ZSRVFVRU5DWSwKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgLndpcGh5X2ZyZXFfZml4ZWQgPSB0cnVlLAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAubWFjID0gYnNzaWQsCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIC5zc2lkID0gc3NpZCwKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgLnNzaWRfbGVuID0gc2l6ZW9mKHNzaWQpfTsKICBmb3IgKGludCBkZXZp
Y2VfaWQgPSAwOyBkZXZpY2VfaWQgPCBXSUZJX0lOSVRJQUxfREVWSUNFX0NPVU5UOyBkZXZpY2Vf
aWQrKykgewogICAgbWFjX2FkZHJbNV0gPSBkZXZpY2VfaWQ7CiAgICBpbnQgcmV0ID0gaHdzaW04
MDIxMV9jcmVhdGVfZGV2aWNlKCZubG1zZywgc29jaywgaHdzaW1fZmFtaWx5X2lkLCBtYWNfYWRk
cik7CiAgICBpZiAocmV0IDwgMCkKICAgICAgZXhpdCgxKTsKICAgIGNoYXIgaW50ZXJmYWNlWzZd
ID0gIndsYW4wIjsKICAgIGludGVyZmFjZVs0XSArPSBkZXZpY2VfaWQ7CiAgICBpZiAobmw4MDIx
MV9zZXR1cF9pYnNzX2ludGVyZmFjZSgmbmxtc2csIHNvY2ssIG5sODAyMTFfZmFtaWx5X2lkLCBp
bnRlcmZhY2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmaWJzc19wcm9w
cywgdHJ1ZSkgPCAwKQogICAgICBleGl0KDEpOwogIH0KICBmb3IgKGludCBkZXZpY2VfaWQgPSAw
OyBkZXZpY2VfaWQgPCBXSUZJX0lOSVRJQUxfREVWSUNFX0NPVU5UOyBkZXZpY2VfaWQrKykgewog
ICAgY2hhciBpbnRlcmZhY2VbNl0gPSAid2xhbjAiOwogICAgaW50ZXJmYWNlWzRdICs9IGRldmlj
ZV9pZDsKICAgIGludCByZXQgPSBhd2FpdF9pZmxhX29wZXJzdGF0ZSgmbmxtc2csIGludGVyZmFj
ZSwgSUZfT1BFUl9VUCwgdHJ1ZSk7CiAgICBpZiAocmV0IDwgMCkKICAgICAgZXhpdCgxKTsKICB9
CiAgY2xvc2Uoc29jayk7Cn0KCnN0YXRpYyBpbnQgcnVuY21kbGluZShjaGFyKiBjbWRsaW5lKQp7
CiAgaW50IHJldCA9IHN5c3RlbShjbWRsaW5lKTsKICBpZiAocmV0KSB7CiAgfQogIHJldHVybiBy
ZXQ7Cn0KCiNkZWZpbmUgREVWX0lQVjQgIjE3Mi4yMC4yMC4lZCIKI2RlZmluZSBERVZfSVBWNiAi
ZmU4MDo6JTAyeCIKI2RlZmluZSBERVZfTUFDIDB4MDBhYWFhYWFhYWFhCgpzdGF0aWMgdm9pZCBu
ZXRkZXZzaW1fYWRkKHVuc2lnbmVkIGludCBhZGRyLCB1bnNpZ25lZCBpbnQgcG9ydF9jb3VudCkK
ewogIHdyaXRlX2ZpbGUoIi9zeXMvYnVzL25ldGRldnNpbS9kZWxfZGV2aWNlIiwgIiV1IiwgYWRk
cik7CiAgaWYgKHdyaXRlX2ZpbGUoIi9zeXMvYnVzL25ldGRldnNpbS9uZXdfZGV2aWNlIiwgIiV1
ICV1IiwgYWRkciwgcG9ydF9jb3VudCkpIHsKICAgIGNoYXIgYnVmWzMyXTsKICAgIHNucHJpbnRm
KGJ1Ziwgc2l6ZW9mKGJ1ZiksICJuZXRkZXZzaW0lZCIsIGFkZHIpOwogICAgaW5pdGlhbGl6ZV9k
ZXZsaW5rX3BvcnRzKCJuZXRkZXZzaW0iLCBidWYsICJuZXRkZXZzaW0iKTsKICB9Cn0KCiNkZWZp
bmUgV0dfR0VOTF9OQU1FICJ3aXJlZ3VhcmQiCmVudW0gd2dfY21kIHsKICBXR19DTURfR0VUX0RF
VklDRSwKICBXR19DTURfU0VUX0RFVklDRSwKfTsKZW51bSB3Z2RldmljZV9hdHRyaWJ1dGUgewog
IFdHREVWSUNFX0FfVU5TUEVDLAogIFdHREVWSUNFX0FfSUZJTkRFWCwKICBXR0RFVklDRV9BX0lG
TkFNRSwKICBXR0RFVklDRV9BX1BSSVZBVEVfS0VZLAogIFdHREVWSUNFX0FfUFVCTElDX0tFWSwK
ICBXR0RFVklDRV9BX0ZMQUdTLAogIFdHREVWSUNFX0FfTElTVEVOX1BPUlQsCiAgV0dERVZJQ0Vf
QV9GV01BUkssCiAgV0dERVZJQ0VfQV9QRUVSUywKfTsKZW51bSB3Z3BlZXJfYXR0cmlidXRlIHsK
ICBXR1BFRVJfQV9VTlNQRUMsCiAgV0dQRUVSX0FfUFVCTElDX0tFWSwKICBXR1BFRVJfQV9QUkVT
SEFSRURfS0VZLAogIFdHUEVFUl9BX0ZMQUdTLAogIFdHUEVFUl9BX0VORFBPSU5ULAogIFdHUEVF
Ul9BX1BFUlNJU1RFTlRfS0VFUEFMSVZFX0lOVEVSVkFMLAogIFdHUEVFUl9BX0xBU1RfSEFORFNI
QUtFX1RJTUUsCiAgV0dQRUVSX0FfUlhfQllURVMsCiAgV0dQRUVSX0FfVFhfQllURVMsCiAgV0dQ
RUVSX0FfQUxMT1dFRElQUywKICBXR1BFRVJfQV9QUk9UT0NPTF9WRVJTSU9OLAp9OwplbnVtIHdn
YWxsb3dlZGlwX2F0dHJpYnV0ZSB7CiAgV0dBTExPV0VESVBfQV9VTlNQRUMsCiAgV0dBTExPV0VE
SVBfQV9GQU1JTFksCiAgV0dBTExPV0VESVBfQV9JUEFERFIsCiAgV0dBTExPV0VESVBfQV9DSURS
X01BU0ssCn07CgpzdGF0aWMgdm9pZCBuZXRsaW5rX3dpcmVndWFyZF9zZXR1cCh2b2lkKQp7CiAg
Y29uc3QgY2hhciBpZm5hbWVfYVtdID0gIndnMCI7CiAgY29uc3QgY2hhciBpZm5hbWVfYltdID0g
IndnMSI7CiAgY29uc3QgY2hhciBpZm5hbWVfY1tdID0gIndnMiI7CiAgY29uc3QgY2hhciBwcml2
YXRlX2FbXSA9CiAgICAgICJceGEwXHg1Y1x4YThceDRmXHg2Y1x4OWNceDhlXHgzOFx4NTNceGUy
XHhmZFx4N2FceDcwXHhhZVx4MGZceGIyXHgwZlx4YTEiCiAgICAgICJceDUyXHg2MFx4MGNceGIw
XHgwOFx4NDVceDE3XHg0Zlx4MDhceDA3XHg2Zlx4OGRceDc4XHg0MyI7CiAgY29uc3QgY2hhciBw
cml2YXRlX2JbXSA9CiAgICAgICJceGIwXHg4MFx4NzNceGU4XHhkNFx4NGVceDkxXHhlM1x4ZGFc
eDkyXHgyY1x4MjJceDQzXHg4Mlx4NDRceGJiXHg4OFx4NWMiCiAgICAgICJceDY5XHhlMlx4Njlc
eGM4XHhlOVx4ZDhceDM1XHhiMVx4MTRceDI5XHgzYVx4NGRceGRjXHg2ZSI7CiAgY29uc3QgY2hh
ciBwcml2YXRlX2NbXSA9CiAgICAgICJceGEwXHhjYlx4ODdceDlhXHg0N1x4ZjVceGJjXHg2NFx4
NGNceDBlXHg2OVx4M2ZceGE2XHhkMFx4MzFceGM3XHg0YVx4MTUiCiAgICAgICJceDUzXHhiNlx4
ZTlceDAxXHhiOVx4ZmZceDJmXHg1MVx4OGNceDc4XHgwNFx4MmZceGI1XHg0MiI7CiAgY29uc3Qg
Y2hhciBwdWJsaWNfYVtdID0KICAgICAgIlx4OTdceDVjXHg5ZFx4ODFceGM5XHg4M1x4YzhceDIw
XHg5ZVx4ZTdceDgxXHgyNVx4NGJceDg5XHg5Zlx4OGVceGQ5XHgyNSIKICAgICAgIlx4YWVceDlm
XHgwOVx4MjNceGMyXHgzY1x4NjJceGY1XHgzY1x4NTdceGNkXHhiZlx4NjlceDFjIjsKICBjb25z
dCBjaGFyIHB1YmxpY19iW10gPQogICAgICAiXHhkMVx4NzNceDI4XHg5OVx4ZjZceDExXHhjZFx4
ODlceDk0XHgwM1x4NGRceDdmXHg0MVx4M2RceGM5XHg1N1x4NjNceDBlIgogICAgICAiXHg1NFx4
OTNceGMyXHg4NVx4YWNceGE0XHgwMFx4NjVceGNiXHg2M1x4MTFceGJlXHg2OVx4NmIiOwogIGNv
bnN0IGNoYXIgcHVibGljX2NbXSA9CiAgICAgICJceGY0XHg0ZFx4YTNceDY3XHhhOFx4OGVceGU2
XHg1Nlx4NGZceDAyXHgwMlx4MTFceDQ1XHg2N1x4MjdceDA4XHgyZlx4NWMiCiAgICAgICJceGVi
XHhlZVx4OGJceDFiXHhmNVx4ZWJceDczXHgzN1x4MzRceDFiXHg0NVx4OWJceDM5XHgyMiI7CiAg
Y29uc3QgdWludDE2X3QgbGlzdGVuX2EgPSAyMDAwMTsKICBjb25zdCB1aW50MTZfdCBsaXN0ZW5f
YiA9IDIwMDAyOwogIGNvbnN0IHVpbnQxNl90IGxpc3Rlbl9jID0gMjAwMDM7CiAgY29uc3QgdWlu
dDE2X3QgYWZfaW5ldCA9IEFGX0lORVQ7CiAgY29uc3QgdWludDE2X3QgYWZfaW5ldDYgPSBBRl9J
TkVUNjsKICBjb25zdCBzdHJ1Y3Qgc29ja2FkZHJfaW4gZW5kcG9pbnRfYl92NCA9IHsKICAgICAg
LnNpbl9mYW1pbHkgPSBBRl9JTkVULAogICAgICAuc2luX3BvcnQgPSBodG9ucyhsaXN0ZW5fYiks
CiAgICAgIC5zaW5fYWRkciA9IHtodG9ubChJTkFERFJfTE9PUEJBQ0spfX07CiAgY29uc3Qgc3Ry
dWN0IHNvY2thZGRyX2luIGVuZHBvaW50X2NfdjQgPSB7CiAgICAgIC5zaW5fZmFtaWx5ID0gQUZf
SU5FVCwKICAgICAgLnNpbl9wb3J0ID0gaHRvbnMobGlzdGVuX2MpLAogICAgICAuc2luX2FkZHIg
PSB7aHRvbmwoSU5BRERSX0xPT1BCQUNLKX19OwogIHN0cnVjdCBzb2NrYWRkcl9pbjYgZW5kcG9p
bnRfYV92NiA9IHsuc2luNl9mYW1pbHkgPSBBRl9JTkVUNiwKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgLnNpbjZfcG9ydCA9IGh0b25zKGxpc3Rlbl9hKX07CiAgZW5kcG9p
bnRfYV92Ni5zaW42X2FkZHIgPSBpbjZhZGRyX2xvb3BiYWNrOwogIHN0cnVjdCBzb2NrYWRkcl9p
bjYgZW5kcG9pbnRfY192NiA9IHsuc2luNl9mYW1pbHkgPSBBRl9JTkVUNiwKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNpbjZfcG9ydCA9IGh0b25zKGxpc3Rlbl9jKX07
CiAgZW5kcG9pbnRfY192Ni5zaW42X2FkZHIgPSBpbjZhZGRyX2xvb3BiYWNrOwogIGNvbnN0IHN0
cnVjdCBpbl9hZGRyIGZpcnN0X2hhbGZfdjQgPSB7MH07CiAgY29uc3Qgc3RydWN0IGluX2FkZHIg
c2Vjb25kX2hhbGZfdjQgPSB7KHVpbnQzMl90KWh0b25sKDEyOCA8PCAyNCl9OwogIGNvbnN0IHN0
cnVjdCBpbjZfYWRkciBmaXJzdF9oYWxmX3Y2ID0ge3t7MH19fTsKICBjb25zdCBzdHJ1Y3QgaW42
X2FkZHIgc2Vjb25kX2hhbGZfdjYgPSB7e3sweDgwfX19OwogIGNvbnN0IHVpbnQ4X3QgaGFsZl9j
aWRyID0gMTsKICBjb25zdCB1aW50MTZfdCBwZXJzaXN0ZW50X2tlZXBhbGl2ZXNbXSA9IHsxLCAz
LCA3LCA5LCAxNCwgMTl9OwogIHN0cnVjdCBnZW5sbXNnaGRyIGdlbmxoZHIgPSB7LmNtZCA9IFdH
X0NNRF9TRVRfREVWSUNFLCAudmVyc2lvbiA9IDF9OwogIGludCBzb2NrOwogIGludCBpZCwgZXJy
OwogIHNvY2sgPSBzb2NrZXQoQUZfTkVUTElOSywgU09DS19SQVcsIE5FVExJTktfR0VORVJJQyk7
CiAgaWYgKHNvY2sgPT0gLTEpIHsKICAgIHJldHVybjsKICB9CiAgaWQgPSBuZXRsaW5rX3F1ZXJ5
X2ZhbWlseV9pZCgmbmxtc2csIHNvY2ssIFdHX0dFTkxfTkFNRSwgdHJ1ZSk7CiAgaWYgKGlkID09
IC0xKQogICAgZ290byBlcnJvcjsKICBuZXRsaW5rX2luaXQoJm5sbXNnLCBpZCwgMCwgJmdlbmxo
ZHIsIHNpemVvZihnZW5saGRyKSk7CiAgbmV0bGlua19hdHRyKCZubG1zZywgV0dERVZJQ0VfQV9J
Rk5BTUUsIGlmbmFtZV9hLCBzdHJsZW4oaWZuYW1lX2EpICsgMSk7CiAgbmV0bGlua19hdHRyKCZu
bG1zZywgV0dERVZJQ0VfQV9QUklWQVRFX0tFWSwgcHJpdmF0ZV9hLCAzMik7CiAgbmV0bGlua19h
dHRyKCZubG1zZywgV0dERVZJQ0VfQV9MSVNURU5fUE9SVCwgJmxpc3Rlbl9hLCAyKTsKICBuZXRs
aW5rX25lc3QoJm5sbXNnLCBOTEFfRl9ORVNURUQgfCBXR0RFVklDRV9BX1BFRVJTKTsKICBuZXRs
aW5rX25lc3QoJm5sbXNnLCBOTEFfRl9ORVNURUQgfCAwKTsKICBuZXRsaW5rX2F0dHIoJm5sbXNn
LCBXR1BFRVJfQV9QVUJMSUNfS0VZLCBwdWJsaWNfYiwgMzIpOwogIG5ldGxpbmtfYXR0cigmbmxt
c2csIFdHUEVFUl9BX0VORFBPSU5ULCAmZW5kcG9pbnRfYl92NCwKICAgICAgICAgICAgICAgc2l6
ZW9mKGVuZHBvaW50X2JfdjQpKTsKICBuZXRsaW5rX2F0dHIoJm5sbXNnLCBXR1BFRVJfQV9QRVJT
SVNURU5UX0tFRVBBTElWRV9JTlRFUlZBTCwKICAgICAgICAgICAgICAgJnBlcnNpc3RlbnRfa2Vl
cGFsaXZlc1swXSwgMik7CiAgbmV0bGlua19uZXN0KCZubG1zZywgTkxBX0ZfTkVTVEVEIHwgV0dQ
RUVSX0FfQUxMT1dFRElQUyk7CiAgbmV0bGlua19uZXN0KCZubG1zZywgTkxBX0ZfTkVTVEVEIHwg
MCk7CiAgbmV0bGlua19hdHRyKCZubG1zZywgV0dBTExPV0VESVBfQV9GQU1JTFksICZhZl9pbmV0
LCAyKTsKICBuZXRsaW5rX2F0dHIoJm5sbXNnLCBXR0FMTE9XRURJUF9BX0lQQUREUiwgJmZpcnN0
X2hhbGZfdjQsCiAgICAgICAgICAgICAgIHNpemVvZihmaXJzdF9oYWxmX3Y0KSk7CiAgbmV0bGlu
a19hdHRyKCZubG1zZywgV0dBTExPV0VESVBfQV9DSURSX01BU0ssICZoYWxmX2NpZHIsIDEpOwog
IG5ldGxpbmtfZG9uZSgmbmxtc2cpOwogIG5ldGxpbmtfbmVzdCgmbmxtc2csIE5MQV9GX05FU1RF
RCB8IDApOwogIG5ldGxpbmtfYXR0cigmbmxtc2csIFdHQUxMT1dFRElQX0FfRkFNSUxZLCAmYWZf
aW5ldDYsIDIpOwogIG5ldGxpbmtfYXR0cigmbmxtc2csIFdHQUxMT1dFRElQX0FfSVBBRERSLCAm
Zmlyc3RfaGFsZl92NiwKICAgICAgICAgICAgICAgc2l6ZW9mKGZpcnN0X2hhbGZfdjYpKTsKICBu
ZXRsaW5rX2F0dHIoJm5sbXNnLCBXR0FMTE9XRURJUF9BX0NJRFJfTUFTSywgJmhhbGZfY2lkciwg
MSk7CiAgbmV0bGlua19kb25lKCZubG1zZyk7CiAgbmV0bGlua19kb25lKCZubG1zZyk7CiAgbmV0
bGlua19kb25lKCZubG1zZyk7CiAgbmV0bGlua19uZXN0KCZubG1zZywgTkxBX0ZfTkVTVEVEIHwg
MCk7CiAgbmV0bGlua19hdHRyKCZubG1zZywgV0dQRUVSX0FfUFVCTElDX0tFWSwgcHVibGljX2Ms
IDMyKTsKICBuZXRsaW5rX2F0dHIoJm5sbXNnLCBXR1BFRVJfQV9FTkRQT0lOVCwgJmVuZHBvaW50
X2NfdjYsCiAgICAgICAgICAgICAgIHNpemVvZihlbmRwb2ludF9jX3Y2KSk7CiAgbmV0bGlua19h
dHRyKCZubG1zZywgV0dQRUVSX0FfUEVSU0lTVEVOVF9LRUVQQUxJVkVfSU5URVJWQUwsCiAgICAg
ICAgICAgICAgICZwZXJzaXN0ZW50X2tlZXBhbGl2ZXNbMV0sIDIpOwogIG5ldGxpbmtfbmVzdCgm
bmxtc2csIE5MQV9GX05FU1RFRCB8IFdHUEVFUl9BX0FMTE9XRURJUFMpOwogIG5ldGxpbmtfbmVz
dCgmbmxtc2csIE5MQV9GX05FU1RFRCB8IDApOwogIG5ldGxpbmtfYXR0cigmbmxtc2csIFdHQUxM
T1dFRElQX0FfRkFNSUxZLCAmYWZfaW5ldCwgMik7CiAgbmV0bGlua19hdHRyKCZubG1zZywgV0dB
TExPV0VESVBfQV9JUEFERFIsICZzZWNvbmRfaGFsZl92NCwKICAgICAgICAgICAgICAgc2l6ZW9m
KHNlY29uZF9oYWxmX3Y0KSk7CiAgbmV0bGlua19hdHRyKCZubG1zZywgV0dBTExPV0VESVBfQV9D
SURSX01BU0ssICZoYWxmX2NpZHIsIDEpOwogIG5ldGxpbmtfZG9uZSgmbmxtc2cpOwogIG5ldGxp
bmtfbmVzdCgmbmxtc2csIE5MQV9GX05FU1RFRCB8IDApOwogIG5ldGxpbmtfYXR0cigmbmxtc2cs
IFdHQUxMT1dFRElQX0FfRkFNSUxZLCAmYWZfaW5ldDYsIDIpOwogIG5ldGxpbmtfYXR0cigmbmxt
c2csIFdHQUxMT1dFRElQX0FfSVBBRERSLCAmc2Vjb25kX2hhbGZfdjYsCiAgICAgICAgICAgICAg
IHNpemVvZihzZWNvbmRfaGFsZl92NikpOwogIG5ldGxpbmtfYXR0cigmbmxtc2csIFdHQUxMT1dF
RElQX0FfQ0lEUl9NQVNLLCAmaGFsZl9jaWRyLCAxKTsKICBuZXRsaW5rX2RvbmUoJm5sbXNnKTsK
ICBuZXRsaW5rX2RvbmUoJm5sbXNnKTsKICBuZXRsaW5rX2RvbmUoJm5sbXNnKTsKICBuZXRsaW5r
X2RvbmUoJm5sbXNnKTsKICBlcnIgPSBuZXRsaW5rX3NlbmQoJm5sbXNnLCBzb2NrKTsKICBpZiAo
ZXJyIDwgMCkgewogIH0KICBuZXRsaW5rX2luaXQoJm5sbXNnLCBpZCwgMCwgJmdlbmxoZHIsIHNp
emVvZihnZW5saGRyKSk7CiAgbmV0bGlua19hdHRyKCZubG1zZywgV0dERVZJQ0VfQV9JRk5BTUUs
IGlmbmFtZV9iLCBzdHJsZW4oaWZuYW1lX2IpICsgMSk7CiAgbmV0bGlua19hdHRyKCZubG1zZywg
V0dERVZJQ0VfQV9QUklWQVRFX0tFWSwgcHJpdmF0ZV9iLCAzMik7CiAgbmV0bGlua19hdHRyKCZu
bG1zZywgV0dERVZJQ0VfQV9MSVNURU5fUE9SVCwgJmxpc3Rlbl9iLCAyKTsKICBuZXRsaW5rX25l
c3QoJm5sbXNnLCBOTEFfRl9ORVNURUQgfCBXR0RFVklDRV9BX1BFRVJTKTsKICBuZXRsaW5rX25l
c3QoJm5sbXNnLCBOTEFfRl9ORVNURUQgfCAwKTsKICBuZXRsaW5rX2F0dHIoJm5sbXNnLCBXR1BF
RVJfQV9QVUJMSUNfS0VZLCBwdWJsaWNfYSwgMzIpOwogIG5ldGxpbmtfYXR0cigmbmxtc2csIFdH
UEVFUl9BX0VORFBPSU5ULCAmZW5kcG9pbnRfYV92NiwKICAgICAgICAgICAgICAgc2l6ZW9mKGVu
ZHBvaW50X2FfdjYpKTsKICBuZXRsaW5rX2F0dHIoJm5sbXNnLCBXR1BFRVJfQV9QRVJTSVNURU5U
X0tFRVBBTElWRV9JTlRFUlZBTCwKICAgICAgICAgICAgICAgJnBlcnNpc3RlbnRfa2VlcGFsaXZl
c1syXSwgMik7CiAgbmV0bGlua19uZXN0KCZubG1zZywgTkxBX0ZfTkVTVEVEIHwgV0dQRUVSX0Ff
QUxMT1dFRElQUyk7CiAgbmV0bGlua19uZXN0KCZubG1zZywgTkxBX0ZfTkVTVEVEIHwgMCk7CiAg
bmV0bGlua19hdHRyKCZubG1zZywgV0dBTExPV0VESVBfQV9GQU1JTFksICZhZl9pbmV0LCAyKTsK
ICBuZXRsaW5rX2F0dHIoJm5sbXNnLCBXR0FMTE9XRURJUF9BX0lQQUREUiwgJmZpcnN0X2hhbGZf
djQsCiAgICAgICAgICAgICAgIHNpemVvZihmaXJzdF9oYWxmX3Y0KSk7CiAgbmV0bGlua19hdHRy
KCZubG1zZywgV0dBTExPV0VESVBfQV9DSURSX01BU0ssICZoYWxmX2NpZHIsIDEpOwogIG5ldGxp
bmtfZG9uZSgmbmxtc2cpOwogIG5ldGxpbmtfbmVzdCgmbmxtc2csIE5MQV9GX05FU1RFRCB8IDAp
OwogIG5ldGxpbmtfYXR0cigmbmxtc2csIFdHQUxMT1dFRElQX0FfRkFNSUxZLCAmYWZfaW5ldDYs
IDIpOwogIG5ldGxpbmtfYXR0cigmbmxtc2csIFdHQUxMT1dFRElQX0FfSVBBRERSLCAmZmlyc3Rf
aGFsZl92NiwKICAgICAgICAgICAgICAgc2l6ZW9mKGZpcnN0X2hhbGZfdjYpKTsKICBuZXRsaW5r
X2F0dHIoJm5sbXNnLCBXR0FMTE9XRURJUF9BX0NJRFJfTUFTSywgJmhhbGZfY2lkciwgMSk7CiAg
bmV0bGlua19kb25lKCZubG1zZyk7CiAgbmV0bGlua19kb25lKCZubG1zZyk7CiAgbmV0bGlua19k
b25lKCZubG1zZyk7CiAgbmV0bGlua19uZXN0KCZubG1zZywgTkxBX0ZfTkVTVEVEIHwgMCk7CiAg
bmV0bGlua19hdHRyKCZubG1zZywgV0dQRUVSX0FfUFVCTElDX0tFWSwgcHVibGljX2MsIDMyKTsK
ICBuZXRsaW5rX2F0dHIoJm5sbXNnLCBXR1BFRVJfQV9FTkRQT0lOVCwgJmVuZHBvaW50X2NfdjQs
CiAgICAgICAgICAgICAgIHNpemVvZihlbmRwb2ludF9jX3Y0KSk7CiAgbmV0bGlua19hdHRyKCZu
bG1zZywgV0dQRUVSX0FfUEVSU0lTVEVOVF9LRUVQQUxJVkVfSU5URVJWQUwsCiAgICAgICAgICAg
ICAgICZwZXJzaXN0ZW50X2tlZXBhbGl2ZXNbM10sIDIpOwogIG5ldGxpbmtfbmVzdCgmbmxtc2cs
IE5MQV9GX05FU1RFRCB8IFdHUEVFUl9BX0FMTE9XRURJUFMpOwogIG5ldGxpbmtfbmVzdCgmbmxt
c2csIE5MQV9GX05FU1RFRCB8IDApOwogIG5ldGxpbmtfYXR0cigmbmxtc2csIFdHQUxMT1dFRElQ
X0FfRkFNSUxZLCAmYWZfaW5ldCwgMik7CiAgbmV0bGlua19hdHRyKCZubG1zZywgV0dBTExPV0VE
SVBfQV9JUEFERFIsICZzZWNvbmRfaGFsZl92NCwKICAgICAgICAgICAgICAgc2l6ZW9mKHNlY29u
ZF9oYWxmX3Y0KSk7CiAgbmV0bGlua19hdHRyKCZubG1zZywgV0dBTExPV0VESVBfQV9DSURSX01B
U0ssICZoYWxmX2NpZHIsIDEpOwogIG5ldGxpbmtfZG9uZSgmbmxtc2cpOwogIG5ldGxpbmtfbmVz
dCgmbmxtc2csIE5MQV9GX05FU1RFRCB8IDApOwogIG5ldGxpbmtfYXR0cigmbmxtc2csIFdHQUxM
T1dFRElQX0FfRkFNSUxZLCAmYWZfaW5ldDYsIDIpOwogIG5ldGxpbmtfYXR0cigmbmxtc2csIFdH
QUxMT1dFRElQX0FfSVBBRERSLCAmc2Vjb25kX2hhbGZfdjYsCiAgICAgICAgICAgICAgIHNpemVv
ZihzZWNvbmRfaGFsZl92NikpOwogIG5ldGxpbmtfYXR0cigmbmxtc2csIFdHQUxMT1dFRElQX0Ff
Q0lEUl9NQVNLLCAmaGFsZl9jaWRyLCAxKTsKICBuZXRsaW5rX2RvbmUoJm5sbXNnKTsKICBuZXRs
aW5rX2RvbmUoJm5sbXNnKTsKICBuZXRsaW5rX2RvbmUoJm5sbXNnKTsKICBuZXRsaW5rX2RvbmUo
Jm5sbXNnKTsKICBlcnIgPSBuZXRsaW5rX3NlbmQoJm5sbXNnLCBzb2NrKTsKICBpZiAoZXJyIDwg
MCkgewogIH0KICBuZXRsaW5rX2luaXQoJm5sbXNnLCBpZCwgMCwgJmdlbmxoZHIsIHNpemVvZihn
ZW5saGRyKSk7CiAgbmV0bGlua19hdHRyKCZubG1zZywgV0dERVZJQ0VfQV9JRk5BTUUsIGlmbmFt
ZV9jLCBzdHJsZW4oaWZuYW1lX2MpICsgMSk7CiAgbmV0bGlua19hdHRyKCZubG1zZywgV0dERVZJ
Q0VfQV9QUklWQVRFX0tFWSwgcHJpdmF0ZV9jLCAzMik7CiAgbmV0bGlua19hdHRyKCZubG1zZywg
V0dERVZJQ0VfQV9MSVNURU5fUE9SVCwgJmxpc3Rlbl9jLCAyKTsKICBuZXRsaW5rX25lc3QoJm5s
bXNnLCBOTEFfRl9ORVNURUQgfCBXR0RFVklDRV9BX1BFRVJTKTsKICBuZXRsaW5rX25lc3QoJm5s
bXNnLCBOTEFfRl9ORVNURUQgfCAwKTsKICBuZXRsaW5rX2F0dHIoJm5sbXNnLCBXR1BFRVJfQV9Q
VUJMSUNfS0VZLCBwdWJsaWNfYSwgMzIpOwogIG5ldGxpbmtfYXR0cigmbmxtc2csIFdHUEVFUl9B
X0VORFBPSU5ULCAmZW5kcG9pbnRfYV92NiwKICAgICAgICAgICAgICAgc2l6ZW9mKGVuZHBvaW50
X2FfdjYpKTsKICBuZXRsaW5rX2F0dHIoJm5sbXNnLCBXR1BFRVJfQV9QRVJTSVNURU5UX0tFRVBB
TElWRV9JTlRFUlZBTCwKICAgICAgICAgICAgICAgJnBlcnNpc3RlbnRfa2VlcGFsaXZlc1s0XSwg
Mik7CiAgbmV0bGlua19uZXN0KCZubG1zZywgTkxBX0ZfTkVTVEVEIHwgV0dQRUVSX0FfQUxMT1dF
RElQUyk7CiAgbmV0bGlua19uZXN0KCZubG1zZywgTkxBX0ZfTkVTVEVEIHwgMCk7CiAgbmV0bGlu
a19hdHRyKCZubG1zZywgV0dBTExPV0VESVBfQV9GQU1JTFksICZhZl9pbmV0LCAyKTsKICBuZXRs
aW5rX2F0dHIoJm5sbXNnLCBXR0FMTE9XRURJUF9BX0lQQUREUiwgJmZpcnN0X2hhbGZfdjQsCiAg
ICAgICAgICAgICAgIHNpemVvZihmaXJzdF9oYWxmX3Y0KSk7CiAgbmV0bGlua19hdHRyKCZubG1z
ZywgV0dBTExPV0VESVBfQV9DSURSX01BU0ssICZoYWxmX2NpZHIsIDEpOwogIG5ldGxpbmtfZG9u
ZSgmbmxtc2cpOwogIG5ldGxpbmtfbmVzdCgmbmxtc2csIE5MQV9GX05FU1RFRCB8IDApOwogIG5l
dGxpbmtfYXR0cigmbmxtc2csIFdHQUxMT1dFRElQX0FfRkFNSUxZLCAmYWZfaW5ldDYsIDIpOwog
IG5ldGxpbmtfYXR0cigmbmxtc2csIFdHQUxMT1dFRElQX0FfSVBBRERSLCAmZmlyc3RfaGFsZl92
NiwKICAgICAgICAgICAgICAgc2l6ZW9mKGZpcnN0X2hhbGZfdjYpKTsKICBuZXRsaW5rX2F0dHIo
Jm5sbXNnLCBXR0FMTE9XRURJUF9BX0NJRFJfTUFTSywgJmhhbGZfY2lkciwgMSk7CiAgbmV0bGlu
a19kb25lKCZubG1zZyk7CiAgbmV0bGlua19kb25lKCZubG1zZyk7CiAgbmV0bGlua19kb25lKCZu
bG1zZyk7CiAgbmV0bGlua19uZXN0KCZubG1zZywgTkxBX0ZfTkVTVEVEIHwgMCk7CiAgbmV0bGlu
a19hdHRyKCZubG1zZywgV0dQRUVSX0FfUFVCTElDX0tFWSwgcHVibGljX2IsIDMyKTsKICBuZXRs
aW5rX2F0dHIoJm5sbXNnLCBXR1BFRVJfQV9FTkRQT0lOVCwgJmVuZHBvaW50X2JfdjQsCiAgICAg
ICAgICAgICAgIHNpemVvZihlbmRwb2ludF9iX3Y0KSk7CiAgbmV0bGlua19hdHRyKCZubG1zZywg
V0dQRUVSX0FfUEVSU0lTVEVOVF9LRUVQQUxJVkVfSU5URVJWQUwsCiAgICAgICAgICAgICAgICZw
ZXJzaXN0ZW50X2tlZXBhbGl2ZXNbNV0sIDIpOwogIG5ldGxpbmtfbmVzdCgmbmxtc2csIE5MQV9G
X05FU1RFRCB8IFdHUEVFUl9BX0FMTE9XRURJUFMpOwogIG5ldGxpbmtfbmVzdCgmbmxtc2csIE5M
QV9GX05FU1RFRCB8IDApOwogIG5ldGxpbmtfYXR0cigmbmxtc2csIFdHQUxMT1dFRElQX0FfRkFN
SUxZLCAmYWZfaW5ldCwgMik7CiAgbmV0bGlua19hdHRyKCZubG1zZywgV0dBTExPV0VESVBfQV9J
UEFERFIsICZzZWNvbmRfaGFsZl92NCwKICAgICAgICAgICAgICAgc2l6ZW9mKHNlY29uZF9oYWxm
X3Y0KSk7CiAgbmV0bGlua19hdHRyKCZubG1zZywgV0dBTExPV0VESVBfQV9DSURSX01BU0ssICZo
YWxmX2NpZHIsIDEpOwogIG5ldGxpbmtfZG9uZSgmbmxtc2cpOwogIG5ldGxpbmtfbmVzdCgmbmxt
c2csIE5MQV9GX05FU1RFRCB8IDApOwogIG5ldGxpbmtfYXR0cigmbmxtc2csIFdHQUxMT1dFRElQ
X0FfRkFNSUxZLCAmYWZfaW5ldDYsIDIpOwogIG5ldGxpbmtfYXR0cigmbmxtc2csIFdHQUxMT1dF
RElQX0FfSVBBRERSLCAmc2Vjb25kX2hhbGZfdjYsCiAgICAgICAgICAgICAgIHNpemVvZihzZWNv
bmRfaGFsZl92NikpOwogIG5ldGxpbmtfYXR0cigmbmxtc2csIFdHQUxMT1dFRElQX0FfQ0lEUl9N
QVNLLCAmaGFsZl9jaWRyLCAxKTsKICBuZXRsaW5rX2RvbmUoJm5sbXNnKTsKICBuZXRsaW5rX2Rv
bmUoJm5sbXNnKTsKICBuZXRsaW5rX2RvbmUoJm5sbXNnKTsKICBuZXRsaW5rX2RvbmUoJm5sbXNn
KTsKICBlcnIgPSBuZXRsaW5rX3NlbmQoJm5sbXNnLCBzb2NrKTsKICBpZiAoZXJyIDwgMCkgewog
IH0KCmVycm9yOgogIGNsb3NlKHNvY2spOwp9CgpzdGF0aWMgdm9pZCBpbml0aWFsaXplX25ldGRl
dmljZXModm9pZCkKewogIGNoYXIgbmV0ZGV2c2ltWzE2XTsKICBzcHJpbnRmKG5ldGRldnNpbSwg
Im5ldGRldnNpbSVkIiwgKGludClwcm9jaWQpOwogIHN0cnVjdCB7CiAgICBjb25zdCBjaGFyKiB0
eXBlOwogICAgY29uc3QgY2hhciogZGV2OwogIH0gZGV2dHlwZXNbXSA9IHsKICAgICAgeyJpcDZn
cmV0YXAiLCAiaXA2Z3JldGFwMCJ9LCB7ImJyaWRnZSIsICJicmlkZ2UwIn0sIHsidmNhbiIsICJ2
Y2FuMCJ9LAogICAgICB7ImJvbmQiLCAiYm9uZDAifSwgICAgICAgICAgIHsidGVhbSIsICJ0ZWFt
MCJ9LCAgICAgeyJkdW1teSIsICJkdW1teTAifSwKICAgICAgeyJubG1vbiIsICJubG1vbjAifSwg
ICAgICAgICB7ImNhaWYiLCAiY2FpZjAifSwgICAgIHsiYmF0YWR2IiwgImJhdGFkdjAifSwKICAg
ICAgeyJ2eGNhbiIsICJ2eGNhbjEifSwgICAgICAgICB7InZldGgiLCAwfSwgICAgICAgICAgIHsi
d2lyZWd1YXJkIiwgIndnMCJ9LAogICAgICB7IndpcmVndWFyZCIsICJ3ZzEifSwgICAgICAgIHsi
d2lyZWd1YXJkIiwgIndnMiJ9LAogIH07CiAgY29uc3QgY2hhciogZGV2bWFzdGVyc1tdID0geyJi
cmlkZ2UiLCAiYm9uZCIsICJ0ZWFtIiwgImJhdGFkdiJ9OwogIHN0cnVjdCB7CiAgICBjb25zdCBj
aGFyKiBuYW1lOwogICAgaW50IG1hY3NpemU7CiAgICBib29sIG5vaXB2NjsKICB9IGRldmljZXNb
XSA9IHsKICAgICAgeyJsbyIsIEVUSF9BTEVOfSwKICAgICAgeyJzaXQwIiwgMH0sCiAgICAgIHsi
YnJpZGdlMCIsIEVUSF9BTEVOfSwKICAgICAgeyJ2Y2FuMCIsIDAsIHRydWV9LAogICAgICB7InR1
bmwwIiwgMH0sCiAgICAgIHsiZ3JlMCIsIDB9LAogICAgICB7ImdyZXRhcDAiLCBFVEhfQUxFTn0s
CiAgICAgIHsiaXBfdnRpMCIsIDB9LAogICAgICB7ImlwNl92dGkwIiwgMH0sCiAgICAgIHsiaXA2
dG5sMCIsIDB9LAogICAgICB7ImlwNmdyZTAiLCAwfSwKICAgICAgeyJpcDZncmV0YXAwIiwgRVRI
X0FMRU59LAogICAgICB7ImVyc3BhbjAiLCBFVEhfQUxFTn0sCiAgICAgIHsiYm9uZDAiLCBFVEhf
QUxFTn0sCiAgICAgIHsidmV0aDAiLCBFVEhfQUxFTn0sCiAgICAgIHsidmV0aDEiLCBFVEhfQUxF
Tn0sCiAgICAgIHsidGVhbTAiLCBFVEhfQUxFTn0sCiAgICAgIHsidmV0aDBfdG9fYnJpZGdlIiwg
RVRIX0FMRU59LAogICAgICB7InZldGgxX3RvX2JyaWRnZSIsIEVUSF9BTEVOfSwKICAgICAgeyJ2
ZXRoMF90b19ib25kIiwgRVRIX0FMRU59LAogICAgICB7InZldGgxX3RvX2JvbmQiLCBFVEhfQUxF
Tn0sCiAgICAgIHsidmV0aDBfdG9fdGVhbSIsIEVUSF9BTEVOfSwKICAgICAgeyJ2ZXRoMV90b190
ZWFtIiwgRVRIX0FMRU59LAogICAgICB7InZldGgwX3RvX2hzciIsIEVUSF9BTEVOfSwKICAgICAg
eyJ2ZXRoMV90b19oc3IiLCBFVEhfQUxFTn0sCiAgICAgIHsiaHNyMCIsIDB9LAogICAgICB7ImR1
bW15MCIsIEVUSF9BTEVOfSwKICAgICAgeyJubG1vbjAiLCAwfSwKICAgICAgeyJ2eGNhbjAiLCAw
LCB0cnVlfSwKICAgICAgeyJ2eGNhbjEiLCAwLCB0cnVlfSwKICAgICAgeyJjYWlmMCIsIEVUSF9B
TEVOfSwKICAgICAgeyJiYXRhZHYwIiwgRVRIX0FMRU59LAogICAgICB7bmV0ZGV2c2ltLCBFVEhf
QUxFTn0sCiAgICAgIHsieGZybTAiLCBFVEhfQUxFTn0sCiAgICAgIHsidmV0aDBfdmlydF93aWZp
IiwgRVRIX0FMRU59LAogICAgICB7InZldGgxX3ZpcnRfd2lmaSIsIEVUSF9BTEVOfSwKICAgICAg
eyJ2aXJ0X3dpZmkwIiwgRVRIX0FMRU59LAogICAgICB7InZldGgwX3ZsYW4iLCBFVEhfQUxFTn0s
CiAgICAgIHsidmV0aDFfdmxhbiIsIEVUSF9BTEVOfSwKICAgICAgeyJ2bGFuMCIsIEVUSF9BTEVO
fSwKICAgICAgeyJ2bGFuMSIsIEVUSF9BTEVOfSwKICAgICAgeyJtYWN2bGFuMCIsIEVUSF9BTEVO
fSwKICAgICAgeyJtYWN2bGFuMSIsIEVUSF9BTEVOfSwKICAgICAgeyJpcHZsYW4wIiwgRVRIX0FM
RU59LAogICAgICB7ImlwdmxhbjEiLCBFVEhfQUxFTn0sCiAgICAgIHsidmV0aDBfbWFjdnRhcCIs
IEVUSF9BTEVOfSwKICAgICAgeyJ2ZXRoMV9tYWN2dGFwIiwgRVRIX0FMRU59LAogICAgICB7Im1h
Y3Z0YXAwIiwgRVRIX0FMRU59LAogICAgICB7Im1hY3NlYzAiLCBFVEhfQUxFTn0sCiAgICAgIHsi
dmV0aDBfdG9fYmF0YWR2IiwgRVRIX0FMRU59LAogICAgICB7InZldGgxX3RvX2JhdGFkdiIsIEVU
SF9BTEVOfSwKICAgICAgeyJiYXRhZHZfc2xhdmVfMCIsIEVUSF9BTEVOfSwKICAgICAgeyJiYXRh
ZHZfc2xhdmVfMSIsIEVUSF9BTEVOfSwKICAgICAgeyJnZW5ldmUwIiwgRVRIX0FMRU59LAogICAg
ICB7ImdlbmV2ZTEiLCBFVEhfQUxFTn0sCiAgICAgIHsid2cwIiwgMH0sCiAgICAgIHsid2cxIiwg
MH0sCiAgICAgIHsid2cyIiwgMH0sCiAgfTsKICBpbnQgc29jayA9IHNvY2tldChBRl9ORVRMSU5L
LCBTT0NLX1JBVywgTkVUTElOS19ST1VURSk7CiAgaWYgKHNvY2sgPT0gLTEpCiAgICBleGl0KDEp
OwogIHVuc2lnbmVkIGk7CiAgZm9yIChpID0gMDsgaSA8IHNpemVvZihkZXZ0eXBlcykgLyBzaXpl
b2YoZGV2dHlwZXNbMF0pOyBpKyspCiAgICBuZXRsaW5rX2FkZF9kZXZpY2UoJm5sbXNnLCBzb2Nr
LCBkZXZ0eXBlc1tpXS50eXBlLCBkZXZ0eXBlc1tpXS5kZXYpOwogIGZvciAoaSA9IDA7IGkgPCBz
aXplb2YoZGV2bWFzdGVycykgLyAoc2l6ZW9mKGRldm1hc3RlcnNbMF0pKTsgaSsrKSB7CiAgICBj
aGFyIG1hc3RlclszMl0sIHNsYXZlMFszMl0sIHZldGgwWzMyXSwgc2xhdmUxWzMyXSwgdmV0aDFb
MzJdOwogICAgc3ByaW50ZihzbGF2ZTAsICIlc19zbGF2ZV8wIiwgZGV2bWFzdGVyc1tpXSk7CiAg
ICBzcHJpbnRmKHZldGgwLCAidmV0aDBfdG9fJXMiLCBkZXZtYXN0ZXJzW2ldKTsKICAgIG5ldGxp
bmtfYWRkX3ZldGgoJm5sbXNnLCBzb2NrLCBzbGF2ZTAsIHZldGgwKTsKICAgIHNwcmludGYoc2xh
dmUxLCAiJXNfc2xhdmVfMSIsIGRldm1hc3RlcnNbaV0pOwogICAgc3ByaW50Zih2ZXRoMSwgInZl
dGgxX3RvXyVzIiwgZGV2bWFzdGVyc1tpXSk7CiAgICBuZXRsaW5rX2FkZF92ZXRoKCZubG1zZywg
c29jaywgc2xhdmUxLCB2ZXRoMSk7CiAgICBzcHJpbnRmKG1hc3RlciwgIiVzMCIsIGRldm1hc3Rl
cnNbaV0pOwogICAgbmV0bGlua19kZXZpY2VfY2hhbmdlKCZubG1zZywgc29jaywgc2xhdmUwLCBm
YWxzZSwgbWFzdGVyLCAwLCAwLCBOVUxMKTsKICAgIG5ldGxpbmtfZGV2aWNlX2NoYW5nZSgmbmxt
c2csIHNvY2ssIHNsYXZlMSwgZmFsc2UsIG1hc3RlciwgMCwgMCwgTlVMTCk7CiAgfQogIG5ldGxp
bmtfYWRkX3hmcm0oJm5sbXNnLCBzb2NrLCAieGZybTAiKTsKICBuZXRsaW5rX2RldmljZV9jaGFu
Z2UoJm5sbXNnLCBzb2NrLCAiYnJpZGdlX3NsYXZlXzAiLCB0cnVlLCAwLCAwLCAwLCBOVUxMKTsK
ICBuZXRsaW5rX2RldmljZV9jaGFuZ2UoJm5sbXNnLCBzb2NrLCAiYnJpZGdlX3NsYXZlXzEiLCB0
cnVlLCAwLCAwLCAwLCBOVUxMKTsKICBuZXRsaW5rX2FkZF92ZXRoKCZubG1zZywgc29jaywgImhz
cl9zbGF2ZV8wIiwgInZldGgwX3RvX2hzciIpOwogIG5ldGxpbmtfYWRkX3ZldGgoJm5sbXNnLCBz
b2NrLCAiaHNyX3NsYXZlXzEiLCAidmV0aDFfdG9faHNyIik7CiAgbmV0bGlua19hZGRfaHNyKCZu
bG1zZywgc29jaywgImhzcjAiLCAiaHNyX3NsYXZlXzAiLCAiaHNyX3NsYXZlXzEiKTsKICBuZXRs
aW5rX2RldmljZV9jaGFuZ2UoJm5sbXNnLCBzb2NrLCAiaHNyX3NsYXZlXzAiLCB0cnVlLCAwLCAw
LCAwLCBOVUxMKTsKICBuZXRsaW5rX2RldmljZV9jaGFuZ2UoJm5sbXNnLCBzb2NrLCAiaHNyX3Ns
YXZlXzEiLCB0cnVlLCAwLCAwLCAwLCBOVUxMKTsKICBuZXRsaW5rX2FkZF92ZXRoKCZubG1zZywg
c29jaywgInZldGgwX3ZpcnRfd2lmaSIsICJ2ZXRoMV92aXJ0X3dpZmkiKTsKICBuZXRsaW5rX2Fk
ZF9saW5rZWQoJm5sbXNnLCBzb2NrLCAidmlydF93aWZpIiwgInZpcnRfd2lmaTAiLAogICAgICAg
ICAgICAgICAgICAgICAidmV0aDFfdmlydF93aWZpIik7CiAgbmV0bGlua19hZGRfdmV0aCgmbmxt
c2csIHNvY2ssICJ2ZXRoMF92bGFuIiwgInZldGgxX3ZsYW4iKTsKICBuZXRsaW5rX2FkZF92bGFu
KCZubG1zZywgc29jaywgInZsYW4wIiwgInZldGgwX3ZsYW4iLCAwLCBodG9ucyhFVEhfUF84MDIx
USkpOwogIG5ldGxpbmtfYWRkX3ZsYW4oJm5sbXNnLCBzb2NrLCAidmxhbjEiLCAidmV0aDBfdmxh
biIsIDEsIGh0b25zKEVUSF9QXzgwMjFBRCkpOwogIG5ldGxpbmtfYWRkX21hY3ZsYW4oJm5sbXNn
LCBzb2NrLCAibWFjdmxhbjAiLCAidmV0aDFfdmxhbiIpOwogIG5ldGxpbmtfYWRkX21hY3ZsYW4o
Jm5sbXNnLCBzb2NrLCAibWFjdmxhbjEiLCAidmV0aDFfdmxhbiIpOwogIG5ldGxpbmtfYWRkX2lw
dmxhbigmbmxtc2csIHNvY2ssICJpcHZsYW4wIiwgInZldGgwX3ZsYW4iLCBJUFZMQU5fTU9ERV9M
MiwgMCk7CiAgbmV0bGlua19hZGRfaXB2bGFuKCZubG1zZywgc29jaywgImlwdmxhbjEiLCAidmV0
aDBfdmxhbiIsIElQVkxBTl9NT0RFX0wzUywKICAgICAgICAgICAgICAgICAgICAgSVBWTEFOX0Zf
VkVQQSk7CiAgbmV0bGlua19hZGRfdmV0aCgmbmxtc2csIHNvY2ssICJ2ZXRoMF9tYWN2dGFwIiwg
InZldGgxX21hY3Z0YXAiKTsKICBuZXRsaW5rX2FkZF9saW5rZWQoJm5sbXNnLCBzb2NrLCAibWFj
dnRhcCIsICJtYWN2dGFwMCIsICJ2ZXRoMF9tYWN2dGFwIik7CiAgbmV0bGlua19hZGRfbGlua2Vk
KCZubG1zZywgc29jaywgIm1hY3NlYyIsICJtYWNzZWMwIiwgInZldGgxX21hY3Z0YXAiKTsKICBj
aGFyIGFkZHJbMzJdOwogIHNwcmludGYoYWRkciwgREVWX0lQVjQsIDE0ICsgMTApOwogIHN0cnVj
dCBpbl9hZGRyIGdlbmV2ZV9hZGRyNDsKICBpZiAoaW5ldF9wdG9uKEFGX0lORVQsIGFkZHIsICZn
ZW5ldmVfYWRkcjQpIDw9IDApCiAgICBleGl0KDEpOwogIHN0cnVjdCBpbjZfYWRkciBnZW5ldmVf
YWRkcjY7CiAgaWYgKGluZXRfcHRvbihBRl9JTkVUNiwgImZjMDA6OjAxIiwgJmdlbmV2ZV9hZGRy
NikgPD0gMCkKICAgIGV4aXQoMSk7CiAgbmV0bGlua19hZGRfZ2VuZXZlKCZubG1zZywgc29jaywg
ImdlbmV2ZTAiLCAwLCAmZ2VuZXZlX2FkZHI0LCAwKTsKICBuZXRsaW5rX2FkZF9nZW5ldmUoJm5s
bXNnLCBzb2NrLCAiZ2VuZXZlMSIsIDEsIDAsICZnZW5ldmVfYWRkcjYpOwogIG5ldGRldnNpbV9h
ZGQoKGludClwcm9jaWQsIDQpOwogIG5ldGxpbmtfd2lyZWd1YXJkX3NldHVwKCk7CiAgZm9yIChp
ID0gMDsgaSA8IHNpemVvZihkZXZpY2VzKSAvIChzaXplb2YoZGV2aWNlc1swXSkpOyBpKyspIHsK
ICAgIGNoYXIgYWRkclszMl07CiAgICBzcHJpbnRmKGFkZHIsIERFVl9JUFY0LCBpICsgMTApOwog
ICAgbmV0bGlua19hZGRfYWRkcjQoJm5sbXNnLCBzb2NrLCBkZXZpY2VzW2ldLm5hbWUsIGFkZHIp
OwogICAgaWYgKCFkZXZpY2VzW2ldLm5vaXB2NikgewogICAgICBzcHJpbnRmKGFkZHIsIERFVl9J
UFY2LCBpICsgMTApOwogICAgICBuZXRsaW5rX2FkZF9hZGRyNigmbmxtc2csIHNvY2ssIGRldmlj
ZXNbaV0ubmFtZSwgYWRkcik7CiAgICB9CiAgICB1aW50NjRfdCBtYWNhZGRyID0gREVWX01BQyAr
ICgoaSArIDEwdWxsKSA8PCA0MCk7CiAgICBuZXRsaW5rX2RldmljZV9jaGFuZ2UoJm5sbXNnLCBz
b2NrLCBkZXZpY2VzW2ldLm5hbWUsIHRydWUsIDAsICZtYWNhZGRyLAogICAgICAgICAgICAgICAg
ICAgICAgICAgIGRldmljZXNbaV0ubWFjc2l6ZSwgTlVMTCk7CiAgfQogIGNsb3NlKHNvY2spOwp9
CnN0YXRpYyB2b2lkIGluaXRpYWxpemVfbmV0ZGV2aWNlc19pbml0KHZvaWQpCnsKICBpbnQgc29j
ayA9IHNvY2tldChBRl9ORVRMSU5LLCBTT0NLX1JBVywgTkVUTElOS19ST1VURSk7CiAgaWYgKHNv
Y2sgPT0gLTEpCiAgICBleGl0KDEpOwogIHN0cnVjdCB7CiAgICBjb25zdCBjaGFyKiB0eXBlOwog
ICAgaW50IG1hY3NpemU7CiAgICBib29sIG5vaXB2NjsKICAgIGJvb2wgbm91cDsKICB9IGRldnR5
cGVzW10gPSB7CiAgICAgIHsibnIiLCA3LCB0cnVlfSwKICAgICAgeyJyb3NlIiwgNSwgdHJ1ZSwg
dHJ1ZX0sCiAgfTsKICB1bnNpZ25lZCBpOwogIGZvciAoaSA9IDA7IGkgPCBzaXplb2YoZGV2dHlw
ZXMpIC8gc2l6ZW9mKGRldnR5cGVzWzBdKTsgaSsrKSB7CiAgICBjaGFyIGRldlszMl0sIGFkZHJb
MzJdOwogICAgc3ByaW50ZihkZXYsICIlcyVkIiwgZGV2dHlwZXNbaV0udHlwZSwgKGludClwcm9j
aWQpOwogICAgc3ByaW50ZihhZGRyLCAiMTcyLjMwLiVkLiVkIiwgaSwgKGludClwcm9jaWQgKyAx
KTsKICAgIG5ldGxpbmtfYWRkX2FkZHI0KCZubG1zZywgc29jaywgZGV2LCBhZGRyKTsKICAgIGlm
ICghZGV2dHlwZXNbaV0ubm9pcHY2KSB7CiAgICAgIHNwcmludGYoYWRkciwgImZlODg6OiUwMng6
JTAyeCIsIGksIChpbnQpcHJvY2lkICsgMSk7CiAgICAgIG5ldGxpbmtfYWRkX2FkZHI2KCZubG1z
Zywgc29jaywgZGV2LCBhZGRyKTsKICAgIH0KICAgIGludCBtYWNzaXplID0gZGV2dHlwZXNbaV0u
bWFjc2l6ZTsKICAgIHVpbnQ2NF90IG1hY2FkZHIgPSAweGJiYmJiYiArCiAgICAgICAgICAgICAg
ICAgICAgICAgKCh1bnNpZ25lZCBsb25nIGxvbmcpaSA8PCAoOCAqIChtYWNzaXplIC0gMikpKSAr
CiAgICAgICAgICAgICAgICAgICAgICAgKHByb2NpZCA8PCAoOCAqIChtYWNzaXplIC0gMSkpKTsK
ICAgIG5ldGxpbmtfZGV2aWNlX2NoYW5nZSgmbmxtc2csIHNvY2ssIGRldiwgIWRldnR5cGVzW2ld
Lm5vdXAsIDAsICZtYWNhZGRyLAogICAgICAgICAgICAgICAgICAgICAgICAgIG1hY3NpemUsIE5V
TEwpOwogIH0KICBjbG9zZShzb2NrKTsKfQoKc3RhdGljIGludCByZWFkX3R1bihjaGFyKiBkYXRh
LCBpbnQgc2l6ZSkKewogIGlmICh0dW5mZCA8IDApCiAgICByZXR1cm4gLTE7CiAgaW50IHJ2ID0g
cmVhZCh0dW5mZCwgZGF0YSwgc2l6ZSk7CiAgaWYgKHJ2IDwgMCkgewogICAgaWYgKGVycm5vID09
IEVBR0FJTiB8fCBlcnJubyA9PSBFQkFERiB8fCBlcnJubyA9PSBFQkFERkQpCiAgICAgIHJldHVy
biAtMTsKICAgIGV4aXQoMSk7CiAgfQogIHJldHVybiBydjsKfQoKc3RhdGljIHZvaWQgZmx1c2hf
dHVuKCkKewogIGNoYXIgZGF0YVsxMDAwXTsKICB3aGlsZSAocmVhZF90dW4oJmRhdGFbMF0sIHNp
emVvZihkYXRhKSkgIT0gLTEpIHsKICB9Cn0KCiNkZWZpbmUgTUFYX0ZEUyAzMAoKc3RhdGljIGxv
bmcgc3l6X2luaXRfbmV0X3NvY2tldCh2b2xhdGlsZSBsb25nIGRvbWFpbiwgdm9sYXRpbGUgbG9u
ZyB0eXBlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZvbGF0aWxlIGxvbmcgcHJv
dG8pCnsKICBpbnQgbmV0bnMgPSBvcGVuKCIvcHJvYy9zZWxmL25zL25ldCIsIE9fUkRPTkxZKTsK
ICBpZiAobmV0bnMgPT0gLTEpCiAgICByZXR1cm4gbmV0bnM7CiAgaWYgKHNldG5zKGtJbml0TmV0
TnNGZCwgMCkpCiAgICByZXR1cm4gLTE7CiAgaW50IHNvY2sgPSBzeXNjYWxsKF9fTlJfc29ja2V0
LCBkb21haW4sIHR5cGUsIHByb3RvKTsKICBpbnQgZXJyID0gZXJybm87CiAgaWYgKHNldG5zKG5l
dG5zLCAwKSkgewogICAgZXhpdCgxKTsKICB9CiAgY2xvc2UobmV0bnMpOwogIGVycm5vID0gZXJy
OwogIHJldHVybiBzb2NrOwp9CgojZGVmaW5lIEJUUFJPVE9fSENJIDEKI2RlZmluZSBBQ0xfTElO
SyAxCiNkZWZpbmUgU0NBTl9QQUdFIDIKCnR5cGVkZWYgc3RydWN0IHsKICB1aW50OF90IGJbNl07
Cn0gX19hdHRyaWJ1dGVfXygocGFja2VkKSkgYmRhZGRyX3Q7CgojZGVmaW5lIEhDSV9DT01NQU5E
X1BLVCAxCiNkZWZpbmUgSENJX0VWRU5UX1BLVCA0CiNkZWZpbmUgSENJX1ZFTkRPUl9QS1QgMHhm
ZgoKc3RydWN0IGhjaV9jb21tYW5kX2hkciB7CiAgdWludDE2X3Qgb3Bjb2RlOwogIHVpbnQ4X3Qg
cGxlbjsKfSBfX2F0dHJpYnV0ZV9fKChwYWNrZWQpKTsKCnN0cnVjdCBoY2lfZXZlbnRfaGRyIHsK
ICB1aW50OF90IGV2dDsKICB1aW50OF90IHBsZW47Cn0gX19hdHRyaWJ1dGVfXygocGFja2VkKSk7
CgojZGVmaW5lIEhDSV9FVl9DT05OX0NPTVBMRVRFIDB4MDMKc3RydWN0IGhjaV9ldl9jb25uX2Nv
bXBsZXRlIHsKICB1aW50OF90IHN0YXR1czsKICB1aW50MTZfdCBoYW5kbGU7CiAgYmRhZGRyX3Qg
YmRhZGRyOwogIHVpbnQ4X3QgbGlua190eXBlOwogIHVpbnQ4X3QgZW5jcl9tb2RlOwp9IF9fYXR0
cmlidXRlX18oKHBhY2tlZCkpOwoKI2RlZmluZSBIQ0lfRVZfQ09OTl9SRVFVRVNUIDB4MDQKc3Ry
dWN0IGhjaV9ldl9jb25uX3JlcXVlc3QgewogIGJkYWRkcl90IGJkYWRkcjsKICB1aW50OF90IGRl
dl9jbGFzc1szXTsKICB1aW50OF90IGxpbmtfdHlwZTsKfSBfX2F0dHJpYnV0ZV9fKChwYWNrZWQp
KTsKCiNkZWZpbmUgSENJX0VWX1JFTU9URV9GRUFUVVJFUyAweDBiCnN0cnVjdCBoY2lfZXZfcmVt
b3RlX2ZlYXR1cmVzIHsKICB1aW50OF90IHN0YXR1czsKICB1aW50MTZfdCBoYW5kbGU7CiAgdWlu
dDhfdCBmZWF0dXJlc1s4XTsKfSBfX2F0dHJpYnV0ZV9fKChwYWNrZWQpKTsKCiNkZWZpbmUgSENJ
X0VWX0NNRF9DT01QTEVURSAweDBlCnN0cnVjdCBoY2lfZXZfY21kX2NvbXBsZXRlIHsKICB1aW50
OF90IG5jbWQ7CiAgdWludDE2X3Qgb3Bjb2RlOwp9IF9fYXR0cmlidXRlX18oKHBhY2tlZCkpOwoK
I2RlZmluZSBIQ0lfT1BfV1JJVEVfU0NBTl9FTkFCTEUgMHgwYzFhCgojZGVmaW5lIEhDSV9PUF9S
RUFEX0JVRkZFUl9TSVpFIDB4MTAwNQpzdHJ1Y3QgaGNpX3JwX3JlYWRfYnVmZmVyX3NpemUgewog
IHVpbnQ4X3Qgc3RhdHVzOwogIHVpbnQxNl90IGFjbF9tdHU7CiAgdWludDhfdCBzY29fbXR1Owog
IHVpbnQxNl90IGFjbF9tYXhfcGt0OwogIHVpbnQxNl90IHNjb19tYXhfcGt0Owp9IF9fYXR0cmli
dXRlX18oKHBhY2tlZCkpOwoKI2RlZmluZSBIQ0lfT1BfUkVBRF9CRF9BRERSIDB4MTAwOQpzdHJ1
Y3QgaGNpX3JwX3JlYWRfYmRfYWRkciB7CiAgdWludDhfdCBzdGF0dXM7CiAgYmRhZGRyX3QgYmRh
ZGRyOwp9IF9fYXR0cmlidXRlX18oKHBhY2tlZCkpOwoKI2RlZmluZSBIQ0lfRVZfTEVfTUVUQSAw
eDNlCnN0cnVjdCBoY2lfZXZfbGVfbWV0YSB7CiAgdWludDhfdCBzdWJldmVudDsKfSBfX2F0dHJp
YnV0ZV9fKChwYWNrZWQpKTsKCiNkZWZpbmUgSENJX0VWX0xFX0NPTk5fQ09NUExFVEUgMHgwMQpz
dHJ1Y3QgaGNpX2V2X2xlX2Nvbm5fY29tcGxldGUgewogIHVpbnQ4X3Qgc3RhdHVzOwogIHVpbnQx
Nl90IGhhbmRsZTsKICB1aW50OF90IHJvbGU7CiAgdWludDhfdCBiZGFkZHJfdHlwZTsKICBiZGFk
ZHJfdCBiZGFkZHI7CiAgdWludDE2X3QgaW50ZXJ2YWw7CiAgdWludDE2X3QgbGF0ZW5jeTsKICB1
aW50MTZfdCBzdXBlcnZpc2lvbl90aW1lb3V0OwogIHVpbnQ4X3QgY2xrX2FjY3VyYW5jeTsKfSBf
X2F0dHJpYnV0ZV9fKChwYWNrZWQpKTsKCnN0cnVjdCBoY2lfZGV2X3JlcSB7CiAgdWludDE2X3Qg
ZGV2X2lkOwogIHVpbnQzMl90IGRldl9vcHQ7Cn07CgpzdHJ1Y3QgdmhjaV92ZW5kb3JfcGt0X3Jl
cXVlc3QgewogIHVpbnQ4X3QgdHlwZTsKICB1aW50OF90IG9wY29kZTsKfSBfX2F0dHJpYnV0ZV9f
KChwYWNrZWQpKTsKCnN0cnVjdCB2aGNpX3BrdCB7CiAgdWludDhfdCB0eXBlOwogIHVuaW9uIHsK
ICAgIHN0cnVjdCB7CiAgICAgIHVpbnQ4X3Qgb3Bjb2RlOwogICAgICB1aW50MTZfdCBpZDsKICAg
IH0gX19hdHRyaWJ1dGVfXygocGFja2VkKSkgdmVuZG9yX3BrdDsKICAgIHN0cnVjdCBoY2lfY29t
bWFuZF9oZHIgY29tbWFuZF9oZHI7CiAgfTsKfSBfX2F0dHJpYnV0ZV9fKChwYWNrZWQpKTsKCiNk
ZWZpbmUgSENJREVWVVAgX0lPVygnSCcsIDIwMSwgaW50KQojZGVmaW5lIEhDSVNFVFNDQU4gX0lP
VygnSCcsIDIyMSwgaW50KQoKc3RhdGljIGludCB2aGNpX2ZkID0gLTE7CgpzdGF0aWMgdm9pZCBy
ZmtpbGxfdW5ibG9ja19hbGwoKQp7CiAgaW50IGZkID0gb3BlbigiL2Rldi9yZmtpbGwiLCBPX1dS
T05MWSk7CiAgaWYgKGZkIDwgMCkKICAgIGV4aXQoMSk7CiAgc3RydWN0IHJma2lsbF9ldmVudCBl
dmVudCA9IHswfTsKICBldmVudC5pZHggPSAwOwogIGV2ZW50LnR5cGUgPSBSRktJTExfVFlQRV9B
TEw7CiAgZXZlbnQub3AgPSBSRktJTExfT1BfQ0hBTkdFX0FMTDsKICBldmVudC5zb2Z0ID0gMDsK
ICBldmVudC5oYXJkID0gMDsKICBpZiAod3JpdGUoZmQsICZldmVudCwgc2l6ZW9mKGV2ZW50KSkg
PCAwKQogICAgZXhpdCgxKTsKICBjbG9zZShmZCk7Cn0KCnN0YXRpYyB2b2lkIGhjaV9zZW5kX2V2
ZW50X3BhY2tldChpbnQgZmQsIHVpbnQ4X3QgZXZ0LCB2b2lkKiBkYXRhLAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgc2l6ZV90IGRhdGFfbGVuKQp7CiAgc3RydWN0IGlvdmVjIGl2
WzNdOwogIHN0cnVjdCBoY2lfZXZlbnRfaGRyIGhkcjsKICBoZHIuZXZ0ID0gZXZ0OwogIGhkci5w
bGVuID0gZGF0YV9sZW47CiAgdWludDhfdCB0eXBlID0gSENJX0VWRU5UX1BLVDsKICBpdlswXS5p
b3ZfYmFzZSA9ICZ0eXBlOwogIGl2WzBdLmlvdl9sZW4gPSBzaXplb2YodHlwZSk7CiAgaXZbMV0u
aW92X2Jhc2UgPSAmaGRyOwogIGl2WzFdLmlvdl9sZW4gPSBzaXplb2YoaGRyKTsKICBpdlsyXS5p
b3ZfYmFzZSA9IGRhdGE7CiAgaXZbMl0uaW92X2xlbiA9IGRhdGFfbGVuOwogIGlmICh3cml0ZXYo
ZmQsIGl2LCBzaXplb2YoaXYpIC8gc2l6ZW9mKHN0cnVjdCBpb3ZlYykpIDwgMCkKICAgIGV4aXQo
MSk7Cn0KCnN0YXRpYyB2b2lkIGhjaV9zZW5kX2V2ZW50X2NtZF9jb21wbGV0ZShpbnQgZmQsIHVp
bnQxNl90IG9wY29kZSwgdm9pZCogZGF0YSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHNpemVfdCBkYXRhX2xlbikKewogIHN0cnVjdCBpb3ZlYyBpdls0XTsKICBzdHJ1
Y3QgaGNpX2V2ZW50X2hkciBoZHI7CiAgaGRyLmV2dCA9IEhDSV9FVl9DTURfQ09NUExFVEU7CiAg
aGRyLnBsZW4gPSBzaXplb2Yoc3RydWN0IGhjaV9ldl9jbWRfY29tcGxldGUpICsgZGF0YV9sZW47
CiAgc3RydWN0IGhjaV9ldl9jbWRfY29tcGxldGUgZXZ0X2hkcjsKICBldnRfaGRyLm5jbWQgPSAx
OwogIGV2dF9oZHIub3Bjb2RlID0gb3Bjb2RlOwogIHVpbnQ4X3QgdHlwZSA9IEhDSV9FVkVOVF9Q
S1Q7CiAgaXZbMF0uaW92X2Jhc2UgPSAmdHlwZTsKICBpdlswXS5pb3ZfbGVuID0gc2l6ZW9mKHR5
cGUpOwogIGl2WzFdLmlvdl9iYXNlID0gJmhkcjsKICBpdlsxXS5pb3ZfbGVuID0gc2l6ZW9mKGhk
cik7CiAgaXZbMl0uaW92X2Jhc2UgPSAmZXZ0X2hkcjsKICBpdlsyXS5pb3ZfbGVuID0gc2l6ZW9m
KGV2dF9oZHIpOwogIGl2WzNdLmlvdl9iYXNlID0gZGF0YTsKICBpdlszXS5pb3ZfbGVuID0gZGF0
YV9sZW47CiAgaWYgKHdyaXRldihmZCwgaXYsIHNpemVvZihpdikgLyBzaXplb2Yoc3RydWN0IGlv
dmVjKSkgPCAwKQogICAgZXhpdCgxKTsKfQoKc3RhdGljIGJvb2wgcHJvY2Vzc19jb21tYW5kX3Br
dChpbnQgZmQsIGNoYXIqIGJ1Ziwgc3NpemVfdCBidWZfc2l6ZSkKewogIHN0cnVjdCBoY2lfY29t
bWFuZF9oZHIqIGhkciA9IChzdHJ1Y3QgaGNpX2NvbW1hbmRfaGRyKilidWY7CiAgaWYgKGJ1Zl9z
aXplIDwgKHNzaXplX3Qpc2l6ZW9mKHN0cnVjdCBoY2lfY29tbWFuZF9oZHIpIHx8CiAgICAgIGhk
ci0+cGxlbiAhPSBidWZfc2l6ZSAtIHNpemVvZihzdHJ1Y3QgaGNpX2NvbW1hbmRfaGRyKSkKICAg
IGV4aXQoMSk7CiAgc3dpdGNoIChoZHItPm9wY29kZSkgewogIGNhc2UgSENJX09QX1dSSVRFX1ND
QU5fRU5BQkxFOiB7CiAgICB1aW50OF90IHN0YXR1cyA9IDA7CiAgICBoY2lfc2VuZF9ldmVudF9j
bWRfY29tcGxldGUoZmQsIGhkci0+b3Bjb2RlLCAmc3RhdHVzLCBzaXplb2Yoc3RhdHVzKSk7CiAg
ICByZXR1cm4gdHJ1ZTsKICB9CiAgY2FzZSBIQ0lfT1BfUkVBRF9CRF9BRERSOiB7CiAgICBzdHJ1
Y3QgaGNpX3JwX3JlYWRfYmRfYWRkciBycCA9IHswfTsKICAgIHJwLnN0YXR1cyA9IDA7CiAgICBt
ZW1zZXQoJnJwLmJkYWRkciwgMHhhYSwgNik7CiAgICBoY2lfc2VuZF9ldmVudF9jbWRfY29tcGxl
dGUoZmQsIGhkci0+b3Bjb2RlLCAmcnAsIHNpemVvZihycCkpOwogICAgcmV0dXJuIGZhbHNlOwog
IH0KICBjYXNlIEhDSV9PUF9SRUFEX0JVRkZFUl9TSVpFOiB7CiAgICBzdHJ1Y3QgaGNpX3JwX3Jl
YWRfYnVmZmVyX3NpemUgcnAgPSB7MH07CiAgICBycC5zdGF0dXMgPSAwOwogICAgcnAuYWNsX210
dSA9IDEwMjE7CiAgICBycC5zY29fbXR1ID0gOTY7CiAgICBycC5hY2xfbWF4X3BrdCA9IDQ7CiAg
ICBycC5zY29fbWF4X3BrdCA9IDY7CiAgICBoY2lfc2VuZF9ldmVudF9jbWRfY29tcGxldGUoZmQs
IGhkci0+b3Bjb2RlLCAmcnAsIHNpemVvZihycCkpOwogICAgcmV0dXJuIGZhbHNlOwogIH0KICB9
CiAgY2hhciBkdW1teVsweGY5XSA9IHswfTsKICBoY2lfc2VuZF9ldmVudF9jbWRfY29tcGxldGUo
ZmQsIGhkci0+b3Bjb2RlLCBkdW1teSwgc2l6ZW9mKGR1bW15KSk7CiAgcmV0dXJuIGZhbHNlOwp9
CgpzdGF0aWMgdm9pZCogZXZlbnRfdGhyZWFkKHZvaWQqIGFyZykKewogIHdoaWxlICgxKSB7CiAg
ICBjaGFyIGJ1ZlsxMDI0XSA9IHswfTsKICAgIHNzaXplX3QgYnVmX3NpemUgPSByZWFkKHZoY2lf
ZmQsIGJ1Ziwgc2l6ZW9mKGJ1ZikpOwogICAgaWYgKGJ1Zl9zaXplIDwgMCkKICAgICAgZXhpdCgx
KTsKICAgIGlmIChidWZfc2l6ZSA+IDAgJiYgYnVmWzBdID09IEhDSV9DT01NQU5EX1BLVCkgewog
ICAgICBpZiAocHJvY2Vzc19jb21tYW5kX3BrdCh2aGNpX2ZkLCBidWYgKyAxLCBidWZfc2l6ZSAt
IDEpKQogICAgICAgIGJyZWFrOwogICAgfQogIH0KICByZXR1cm4gTlVMTDsKfQojZGVmaW5lIEhD
SV9IQU5ETEVfMSAyMDAKI2RlZmluZSBIQ0lfSEFORExFXzIgMjAxCgojZGVmaW5lIEhDSV9QUklN
QVJZIDAKI2RlZmluZSBIQ0lfT1BfUkVTRVQgMHgwYzAzCgpzdGF0aWMgdm9pZCBpbml0aWFsaXpl
X3ZoY2koKQp7CiAgaW50IGhjaV9zb2NrID0gc29ja2V0KEFGX0JMVUVUT09USCwgU09DS19SQVcs
IEJUUFJPVE9fSENJKTsKICBpZiAoaGNpX3NvY2sgPCAwKQogICAgZXhpdCgxKTsKICB2aGNpX2Zk
ID0gb3BlbigiL2Rldi92aGNpIiwgT19SRFdSKTsKICBpZiAodmhjaV9mZCA9PSAtMSkKICAgIGV4
aXQoMSk7CiAgY29uc3QgaW50IGtWaGNpRmQgPSAyMDI7CiAgaWYgKGR1cDIodmhjaV9mZCwga1Zo
Y2lGZCkgPCAwKQogICAgZXhpdCgxKTsKICBjbG9zZSh2aGNpX2ZkKTsKICB2aGNpX2ZkID0ga1Zo
Y2lGZDsKICBzdHJ1Y3QgdmhjaV92ZW5kb3JfcGt0X3JlcXVlc3QgdmVuZG9yX3BrdF9yZXEgPSB7
SENJX1ZFTkRPUl9QS1QsIEhDSV9QUklNQVJZfTsKICBpZiAod3JpdGUodmhjaV9mZCwgJnZlbmRv
cl9wa3RfcmVxLCBzaXplb2YodmVuZG9yX3BrdF9yZXEpKSAhPQogICAgICBzaXplb2YodmVuZG9y
X3BrdF9yZXEpKQogICAgZXhpdCgxKTsKICBzdHJ1Y3QgdmhjaV9wa3QgdmhjaV9wa3Q7CiAgaWYg
KHJlYWQodmhjaV9mZCwgJnZoY2lfcGt0LCBzaXplb2YodmhjaV9wa3QpKSAhPSBzaXplb2Yodmhj
aV9wa3QpKQogICAgZXhpdCgxKTsKICBpZiAodmhjaV9wa3QudHlwZSA9PSBIQ0lfQ09NTUFORF9Q
S1QgJiYKICAgICAgdmhjaV9wa3QuY29tbWFuZF9oZHIub3Bjb2RlID09IEhDSV9PUF9SRVNFVCkg
ewogICAgY2hhciByZXNwb25zZVsxXSA9IHswfTsKICAgIGhjaV9zZW5kX2V2ZW50X2NtZF9jb21w
bGV0ZSh2aGNpX2ZkLCBIQ0lfT1BfUkVTRVQsIHJlc3BvbnNlLAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHNpemVvZihyZXNwb25zZSkpOwogICAgaWYgKHJlYWQodmhjaV9mZCwgJnZo
Y2lfcGt0LCBzaXplb2YodmhjaV9wa3QpKSAhPSBzaXplb2YodmhjaV9wa3QpKQogICAgICBleGl0
KDEpOwogIH0KICBpZiAodmhjaV9wa3QudHlwZSAhPSBIQ0lfVkVORE9SX1BLVCkKICAgIGV4aXQo
MSk7CiAgaW50IGRldl9pZCA9IHZoY2lfcGt0LnZlbmRvcl9wa3QuaWQ7CiAgcHRocmVhZF90IHRo
OwogIGlmIChwdGhyZWFkX2NyZWF0ZSgmdGgsIE5VTEwsIGV2ZW50X3RocmVhZCwgTlVMTCkpCiAg
ICBleGl0KDEpOwogIGludCByZXQgPSBpb2N0bChoY2lfc29jaywgSENJREVWVVAsIGRldl9pZCk7
CiAgaWYgKHJldCkgewogICAgaWYgKGVycm5vID09IEVSRktJTEwpIHsKICAgICAgcmZraWxsX3Vu
YmxvY2tfYWxsKCk7CiAgICAgIHJldCA9IGlvY3RsKGhjaV9zb2NrLCBIQ0lERVZVUCwgZGV2X2lk
KTsKICAgIH0KICAgIGlmIChyZXQgJiYgZXJybm8gIT0gRUFMUkVBRFkpCiAgICAgIGV4aXQoMSk7
CiAgfQogIHN0cnVjdCBoY2lfZGV2X3JlcSBkciA9IHswfTsKICBkci5kZXZfaWQgPSBkZXZfaWQ7
CiAgZHIuZGV2X29wdCA9IFNDQU5fUEFHRTsKICBpZiAoaW9jdGwoaGNpX3NvY2ssIEhDSVNFVFND
QU4sICZkcikpCiAgICBleGl0KDEpOwogIHN0cnVjdCBoY2lfZXZfY29ubl9yZXF1ZXN0IHJlcXVl
c3Q7CiAgbWVtc2V0KCZyZXF1ZXN0LCAwLCBzaXplb2YocmVxdWVzdCkpOwogIG1lbXNldCgmcmVx
dWVzdC5iZGFkZHIsIDB4YWEsIDYpOwogICoodWludDhfdCopJnJlcXVlc3QuYmRhZGRyLmJbNV0g
PSAweDEwOwogIHJlcXVlc3QubGlua190eXBlID0gQUNMX0xJTks7CiAgaGNpX3NlbmRfZXZlbnRf
cGFja2V0KHZoY2lfZmQsIEhDSV9FVl9DT05OX1JFUVVFU1QsICZyZXF1ZXN0LAogICAgICAgICAg
ICAgICAgICAgICAgICBzaXplb2YocmVxdWVzdCkpOwogIHN0cnVjdCBoY2lfZXZfY29ubl9jb21w
bGV0ZSBjb21wbGV0ZTsKICBtZW1zZXQoJmNvbXBsZXRlLCAwLCBzaXplb2YoY29tcGxldGUpKTsK
ICBjb21wbGV0ZS5zdGF0dXMgPSAwOwogIGNvbXBsZXRlLmhhbmRsZSA9IEhDSV9IQU5ETEVfMTsK
ICBtZW1zZXQoJmNvbXBsZXRlLmJkYWRkciwgMHhhYSwgNik7CiAgKih1aW50OF90KikmY29tcGxl
dGUuYmRhZGRyLmJbNV0gPSAweDEwOwogIGNvbXBsZXRlLmxpbmtfdHlwZSA9IEFDTF9MSU5LOwog
IGNvbXBsZXRlLmVuY3JfbW9kZSA9IDA7CiAgaGNpX3NlbmRfZXZlbnRfcGFja2V0KHZoY2lfZmQs
IEhDSV9FVl9DT05OX0NPTVBMRVRFLCAmY29tcGxldGUsCiAgICAgICAgICAgICAgICAgICAgICAg
IHNpemVvZihjb21wbGV0ZSkpOwogIHN0cnVjdCBoY2lfZXZfcmVtb3RlX2ZlYXR1cmVzIGZlYXR1
cmVzOwogIG1lbXNldCgmZmVhdHVyZXMsIDAsIHNpemVvZihmZWF0dXJlcykpOwogIGZlYXR1cmVz
LnN0YXR1cyA9IDA7CiAgZmVhdHVyZXMuaGFuZGxlID0gSENJX0hBTkRMRV8xOwogIGhjaV9zZW5k
X2V2ZW50X3BhY2tldCh2aGNpX2ZkLCBIQ0lfRVZfUkVNT1RFX0ZFQVRVUkVTLCAmZmVhdHVyZXMs
CiAgICAgICAgICAgICAgICAgICAgICAgIHNpemVvZihmZWF0dXJlcykpOwogIHN0cnVjdCB7CiAg
ICBzdHJ1Y3QgaGNpX2V2X2xlX21ldGEgbGVfbWV0YTsKICAgIHN0cnVjdCBoY2lfZXZfbGVfY29u
bl9jb21wbGV0ZSBsZV9jb25uOwogIH0gbGVfY29ubjsKICBtZW1zZXQoJmxlX2Nvbm4sIDAsIHNp
emVvZihsZV9jb25uKSk7CiAgbGVfY29ubi5sZV9tZXRhLnN1YmV2ZW50ID0gSENJX0VWX0xFX0NP
Tk5fQ09NUExFVEU7CiAgbWVtc2V0KCZsZV9jb25uLmxlX2Nvbm4uYmRhZGRyLCAweGFhLCA2KTsK
ICAqKHVpbnQ4X3QqKSZsZV9jb25uLmxlX2Nvbm4uYmRhZGRyLmJbNV0gPSAweDExOwogIGxlX2Nv
bm4ubGVfY29ubi5yb2xlID0gMTsKICBsZV9jb25uLmxlX2Nvbm4uaGFuZGxlID0gSENJX0hBTkRM
RV8yOwogIGhjaV9zZW5kX2V2ZW50X3BhY2tldCh2aGNpX2ZkLCBIQ0lfRVZfTEVfTUVUQSwgJmxl
X2Nvbm4sIHNpemVvZihsZV9jb25uKSk7CiAgcHRocmVhZF9qb2luKHRoLCBOVUxMKTsKICBjbG9z
ZShoY2lfc29jayk7Cn0KCnN0YXRpYyBsb25nIHN5el9lbWl0X3ZoY2kodm9sYXRpbGUgbG9uZyBh
MCwgdm9sYXRpbGUgbG9uZyBhMSkKewogIGlmICh2aGNpX2ZkIDwgMCkKICAgIHJldHVybiAodWlu
dHB0cl90KS0xOwogIGNoYXIqIGRhdGEgPSAoY2hhciopYTA7CiAgdWludDMyX3QgbGVuZ3RoID0g
YTE7CiAgcmV0dXJuIHdyaXRlKHZoY2lfZmQsIGRhdGEsIGxlbmd0aCk7Cn0KCiNkZWZpbmUgWFRf
VEFCTEVfU0laRSAxNTM2CiNkZWZpbmUgWFRfTUFYX0VOVFJJRVMgMTAKCnN0cnVjdCB4dF9jb3Vu
dGVycyB7CiAgdWludDY0X3QgcGNudCwgYmNudDsKfTsKCnN0cnVjdCBpcHRfZ2V0aW5mbyB7CiAg
Y2hhciBuYW1lWzMyXTsKICB1bnNpZ25lZCBpbnQgdmFsaWRfaG9va3M7CiAgdW5zaWduZWQgaW50
IGhvb2tfZW50cnlbNV07CiAgdW5zaWduZWQgaW50IHVuZGVyZmxvd1s1XTsKICB1bnNpZ25lZCBp
bnQgbnVtX2VudHJpZXM7CiAgdW5zaWduZWQgaW50IHNpemU7Cn07CgpzdHJ1Y3QgaXB0X2dldF9l
bnRyaWVzIHsKICBjaGFyIG5hbWVbMzJdOwogIHVuc2lnbmVkIGludCBzaXplOwogIHVpbnQ2NF90
IGVudHJ5dGFibGVbWFRfVEFCTEVfU0laRSAvIHNpemVvZih1aW50NjRfdCldOwp9OwoKc3RydWN0
IGlwdF9yZXBsYWNlIHsKICBjaGFyIG5hbWVbMzJdOwogIHVuc2lnbmVkIGludCB2YWxpZF9ob29r
czsKICB1bnNpZ25lZCBpbnQgbnVtX2VudHJpZXM7CiAgdW5zaWduZWQgaW50IHNpemU7CiAgdW5z
aWduZWQgaW50IGhvb2tfZW50cnlbNV07CiAgdW5zaWduZWQgaW50IHVuZGVyZmxvd1s1XTsKICB1
bnNpZ25lZCBpbnQgbnVtX2NvdW50ZXJzOwogIHN0cnVjdCB4dF9jb3VudGVycyogY291bnRlcnM7
CiAgdWludDY0X3QgZW50cnl0YWJsZVtYVF9UQUJMRV9TSVpFIC8gc2l6ZW9mKHVpbnQ2NF90KV07
Cn07CgpzdHJ1Y3QgaXB0X3RhYmxlX2Rlc2MgewogIGNvbnN0IGNoYXIqIG5hbWU7CiAgc3RydWN0
IGlwdF9nZXRpbmZvIGluZm87CiAgc3RydWN0IGlwdF9yZXBsYWNlIHJlcGxhY2U7Cn07CgpzdGF0
aWMgc3RydWN0IGlwdF90YWJsZV9kZXNjIGlwdjRfdGFibGVzW10gPSB7CiAgICB7Lm5hbWUgPSAi
ZmlsdGVyIn0sIHsubmFtZSA9ICJuYXQifSwgICAgICB7Lm5hbWUgPSAibWFuZ2xlIn0sCiAgICB7
Lm5hbWUgPSAicmF3In0sICAgIHsubmFtZSA9ICJzZWN1cml0eSJ9LAp9OwoKc3RhdGljIHN0cnVj
dCBpcHRfdGFibGVfZGVzYyBpcHY2X3RhYmxlc1tdID0gewogICAgey5uYW1lID0gImZpbHRlciJ9
LCB7Lm5hbWUgPSAibmF0In0sICAgICAgey5uYW1lID0gIm1hbmdsZSJ9LAogICAgey5uYW1lID0g
InJhdyJ9LCAgICB7Lm5hbWUgPSAic2VjdXJpdHkifSwKfTsKCiNkZWZpbmUgSVBUX0JBU0VfQ1RM
IDY0CiNkZWZpbmUgSVBUX1NPX1NFVF9SRVBMQUNFIChJUFRfQkFTRV9DVEwpCiNkZWZpbmUgSVBU
X1NPX0dFVF9JTkZPIChJUFRfQkFTRV9DVEwpCiNkZWZpbmUgSVBUX1NPX0dFVF9FTlRSSUVTIChJ
UFRfQkFTRV9DVEwgKyAxKQoKc3RydWN0IGFycHRfZ2V0aW5mbyB7CiAgY2hhciBuYW1lWzMyXTsK
ICB1bnNpZ25lZCBpbnQgdmFsaWRfaG9va3M7CiAgdW5zaWduZWQgaW50IGhvb2tfZW50cnlbM107
CiAgdW5zaWduZWQgaW50IHVuZGVyZmxvd1szXTsKICB1bnNpZ25lZCBpbnQgbnVtX2VudHJpZXM7
CiAgdW5zaWduZWQgaW50IHNpemU7Cn07CgpzdHJ1Y3QgYXJwdF9nZXRfZW50cmllcyB7CiAgY2hh
ciBuYW1lWzMyXTsKICB1bnNpZ25lZCBpbnQgc2l6ZTsKICB1aW50NjRfdCBlbnRyeXRhYmxlW1hU
X1RBQkxFX1NJWkUgLyBzaXplb2YodWludDY0X3QpXTsKfTsKCnN0cnVjdCBhcnB0X3JlcGxhY2Ug
ewogIGNoYXIgbmFtZVszMl07CiAgdW5zaWduZWQgaW50IHZhbGlkX2hvb2tzOwogIHVuc2lnbmVk
IGludCBudW1fZW50cmllczsKICB1bnNpZ25lZCBpbnQgc2l6ZTsKICB1bnNpZ25lZCBpbnQgaG9v
a19lbnRyeVszXTsKICB1bnNpZ25lZCBpbnQgdW5kZXJmbG93WzNdOwogIHVuc2lnbmVkIGludCBu
dW1fY291bnRlcnM7CiAgc3RydWN0IHh0X2NvdW50ZXJzKiBjb3VudGVyczsKICB1aW50NjRfdCBl
bnRyeXRhYmxlW1hUX1RBQkxFX1NJWkUgLyBzaXplb2YodWludDY0X3QpXTsKfTsKCnN0cnVjdCBh
cnB0X3RhYmxlX2Rlc2MgewogIGNvbnN0IGNoYXIqIG5hbWU7CiAgc3RydWN0IGFycHRfZ2V0aW5m
byBpbmZvOwogIHN0cnVjdCBhcnB0X3JlcGxhY2UgcmVwbGFjZTsKfTsKCnN0YXRpYyBzdHJ1Y3Qg
YXJwdF90YWJsZV9kZXNjIGFycHRfdGFibGVzW10gPSB7CiAgICB7Lm5hbWUgPSAiZmlsdGVyIn0s
Cn07CgojZGVmaW5lIEFSUFRfQkFTRV9DVEwgOTYKI2RlZmluZSBBUlBUX1NPX1NFVF9SRVBMQUNF
IChBUlBUX0JBU0VfQ1RMKQojZGVmaW5lIEFSUFRfU09fR0VUX0lORk8gKEFSUFRfQkFTRV9DVEwp
CiNkZWZpbmUgQVJQVF9TT19HRVRfRU5UUklFUyAoQVJQVF9CQVNFX0NUTCArIDEpCgpzdGF0aWMg
dm9pZCBjaGVja3BvaW50X2lwdGFibGVzKHN0cnVjdCBpcHRfdGFibGVfZGVzYyogdGFibGVzLCBp
bnQgbnVtX3RhYmxlcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgZmFtaWx5
LCBpbnQgbGV2ZWwpCnsKICBpbnQgZmQgPSBzb2NrZXQoZmFtaWx5LCBTT0NLX1NUUkVBTSwgSVBQ
Uk9UT19UQ1ApOwogIGlmIChmZCA9PSAtMSkgewogICAgc3dpdGNoIChlcnJubykgewogICAgY2Fz
ZSBFQUZOT1NVUFBPUlQ6CiAgICBjYXNlIEVOT1BST1RPT1BUOgogICAgY2FzZSBFTk9FTlQ6CiAg
ICAgIHJldHVybjsKICAgIH0KICAgIGV4aXQoMSk7CiAgfQogIGZvciAoaW50IGkgPSAwOyBpIDwg
bnVtX3RhYmxlczsgaSsrKSB7CiAgICBzdHJ1Y3QgaXB0X3RhYmxlX2Rlc2MqIHRhYmxlID0gJnRh
Ymxlc1tpXTsKICAgIHN0cmNweSh0YWJsZS0+aW5mby5uYW1lLCB0YWJsZS0+bmFtZSk7CiAgICBz
dHJjcHkodGFibGUtPnJlcGxhY2UubmFtZSwgdGFibGUtPm5hbWUpOwogICAgc29ja2xlbl90IG9w
dGxlbiA9IHNpemVvZih0YWJsZS0+aW5mbyk7CiAgICBpZiAoZ2V0c29ja29wdChmZCwgbGV2ZWws
IElQVF9TT19HRVRfSU5GTywgJnRhYmxlLT5pbmZvLCAmb3B0bGVuKSkgewogICAgICBzd2l0Y2gg
KGVycm5vKSB7CiAgICAgIGNhc2UgRVBFUk06CiAgICAgIGNhc2UgRU5PRU5UOgogICAgICBjYXNl
IEVOT1BST1RPT1BUOgogICAgICAgIGNvbnRpbnVlOwogICAgICB9CiAgICAgIGV4aXQoMSk7CiAg
ICB9CiAgICBpZiAodGFibGUtPmluZm8uc2l6ZSA+IHNpemVvZih0YWJsZS0+cmVwbGFjZS5lbnRy
eXRhYmxlKSkKICAgICAgZXhpdCgxKTsKICAgIGlmICh0YWJsZS0+aW5mby5udW1fZW50cmllcyA+
IFhUX01BWF9FTlRSSUVTKQogICAgICBleGl0KDEpOwogICAgc3RydWN0IGlwdF9nZXRfZW50cmll
cyBlbnRyaWVzOwogICAgbWVtc2V0KCZlbnRyaWVzLCAwLCBzaXplb2YoZW50cmllcykpOwogICAg
c3RyY3B5KGVudHJpZXMubmFtZSwgdGFibGUtPm5hbWUpOwogICAgZW50cmllcy5zaXplID0gdGFi
bGUtPmluZm8uc2l6ZTsKICAgIG9wdGxlbiA9IHNpemVvZihlbnRyaWVzKSAtIHNpemVvZihlbnRy
aWVzLmVudHJ5dGFibGUpICsgdGFibGUtPmluZm8uc2l6ZTsKICAgIGlmIChnZXRzb2Nrb3B0KGZk
LCBsZXZlbCwgSVBUX1NPX0dFVF9FTlRSSUVTLCAmZW50cmllcywgJm9wdGxlbikpCiAgICAgIGV4
aXQoMSk7CiAgICB0YWJsZS0+cmVwbGFjZS52YWxpZF9ob29rcyA9IHRhYmxlLT5pbmZvLnZhbGlk
X2hvb2tzOwogICAgdGFibGUtPnJlcGxhY2UubnVtX2VudHJpZXMgPSB0YWJsZS0+aW5mby5udW1f
ZW50cmllczsKICAgIHRhYmxlLT5yZXBsYWNlLnNpemUgPSB0YWJsZS0+aW5mby5zaXplOwogICAg
bWVtY3B5KHRhYmxlLT5yZXBsYWNlLmhvb2tfZW50cnksIHRhYmxlLT5pbmZvLmhvb2tfZW50cnks
CiAgICAgICAgICAgc2l6ZW9mKHRhYmxlLT5yZXBsYWNlLmhvb2tfZW50cnkpKTsKICAgIG1lbWNw
eSh0YWJsZS0+cmVwbGFjZS51bmRlcmZsb3csIHRhYmxlLT5pbmZvLnVuZGVyZmxvdywKICAgICAg
ICAgICBzaXplb2YodGFibGUtPnJlcGxhY2UudW5kZXJmbG93KSk7CiAgICBtZW1jcHkodGFibGUt
PnJlcGxhY2UuZW50cnl0YWJsZSwgZW50cmllcy5lbnRyeXRhYmxlLCB0YWJsZS0+aW5mby5zaXpl
KTsKICB9CiAgY2xvc2UoZmQpOwp9CgpzdGF0aWMgdm9pZCByZXNldF9pcHRhYmxlcyhzdHJ1Y3Qg
aXB0X3RhYmxlX2Rlc2MqIHRhYmxlcywgaW50IG51bV90YWJsZXMsCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGludCBmYW1pbHksIGludCBsZXZlbCkKewogIGludCBmZCA9IHNvY2tldChmYW1p
bHksIFNPQ0tfU1RSRUFNLCBJUFBST1RPX1RDUCk7CiAgaWYgKGZkID09IC0xKSB7CiAgICBzd2l0
Y2ggKGVycm5vKSB7CiAgICBjYXNlIEVBRk5PU1VQUE9SVDoKICAgIGNhc2UgRU5PUFJPVE9PUFQ6
CiAgICBjYXNlIEVOT0VOVDoKICAgICAgcmV0dXJuOwogICAgfQogICAgZXhpdCgxKTsKICB9CiAg
Zm9yIChpbnQgaSA9IDA7IGkgPCBudW1fdGFibGVzOyBpKyspIHsKICAgIHN0cnVjdCBpcHRfdGFi
bGVfZGVzYyogdGFibGUgPSAmdGFibGVzW2ldOwogICAgaWYgKHRhYmxlLT5pbmZvLnZhbGlkX2hv
b2tzID09IDApCiAgICAgIGNvbnRpbnVlOwogICAgc3RydWN0IGlwdF9nZXRpbmZvIGluZm87CiAg
ICBtZW1zZXQoJmluZm8sIDAsIHNpemVvZihpbmZvKSk7CiAgICBzdHJjcHkoaW5mby5uYW1lLCB0
YWJsZS0+bmFtZSk7CiAgICBzb2NrbGVuX3Qgb3B0bGVuID0gc2l6ZW9mKGluZm8pOwogICAgaWYg
KGdldHNvY2tvcHQoZmQsIGxldmVsLCBJUFRfU09fR0VUX0lORk8sICZpbmZvLCAmb3B0bGVuKSkK
ICAgICAgZXhpdCgxKTsKICAgIGlmIChtZW1jbXAoJnRhYmxlLT5pbmZvLCAmaW5mbywgc2l6ZW9m
KHRhYmxlLT5pbmZvKSkgPT0gMCkgewogICAgICBzdHJ1Y3QgaXB0X2dldF9lbnRyaWVzIGVudHJp
ZXM7CiAgICAgIG1lbXNldCgmZW50cmllcywgMCwgc2l6ZW9mKGVudHJpZXMpKTsKICAgICAgc3Ry
Y3B5KGVudHJpZXMubmFtZSwgdGFibGUtPm5hbWUpOwogICAgICBlbnRyaWVzLnNpemUgPSB0YWJs
ZS0+aW5mby5zaXplOwogICAgICBvcHRsZW4gPSBzaXplb2YoZW50cmllcykgLSBzaXplb2YoZW50
cmllcy5lbnRyeXRhYmxlKSArIGVudHJpZXMuc2l6ZTsKICAgICAgaWYgKGdldHNvY2tvcHQoZmQs
IGxldmVsLCBJUFRfU09fR0VUX0VOVFJJRVMsICZlbnRyaWVzLCAmb3B0bGVuKSkKICAgICAgICBl
eGl0KDEpOwogICAgICBpZiAobWVtY21wKHRhYmxlLT5yZXBsYWNlLmVudHJ5dGFibGUsIGVudHJp
ZXMuZW50cnl0YWJsZSwKICAgICAgICAgICAgICAgICB0YWJsZS0+aW5mby5zaXplKSA9PSAwKQog
ICAgICAgIGNvbnRpbnVlOwogICAgfQogICAgc3RydWN0IHh0X2NvdW50ZXJzIGNvdW50ZXJzW1hU
X01BWF9FTlRSSUVTXTsKICAgIHRhYmxlLT5yZXBsYWNlLm51bV9jb3VudGVycyA9IGluZm8ubnVt
X2VudHJpZXM7CiAgICB0YWJsZS0+cmVwbGFjZS5jb3VudGVycyA9IGNvdW50ZXJzOwogICAgb3B0
bGVuID0gc2l6ZW9mKHRhYmxlLT5yZXBsYWNlKSAtIHNpemVvZih0YWJsZS0+cmVwbGFjZS5lbnRy
eXRhYmxlKSArCiAgICAgICAgICAgICB0YWJsZS0+cmVwbGFjZS5zaXplOwogICAgaWYgKHNldHNv
Y2tvcHQoZmQsIGxldmVsLCBJUFRfU09fU0VUX1JFUExBQ0UsICZ0YWJsZS0+cmVwbGFjZSwgb3B0
bGVuKSkKICAgICAgZXhpdCgxKTsKICB9CiAgY2xvc2UoZmQpOwp9CgpzdGF0aWMgdm9pZCBjaGVj
a3BvaW50X2FycHRhYmxlcyh2b2lkKQp7CiAgaW50IGZkID0gc29ja2V0KEFGX0lORVQsIFNPQ0tf
U1RSRUFNLCBJUFBST1RPX1RDUCk7CiAgaWYgKGZkID09IC0xKSB7CiAgICBzd2l0Y2ggKGVycm5v
KSB7CiAgICBjYXNlIEVBRk5PU1VQUE9SVDoKICAgIGNhc2UgRU5PUFJPVE9PUFQ6CiAgICBjYXNl
IEVOT0VOVDoKICAgICAgcmV0dXJuOwogICAgfQogICAgZXhpdCgxKTsKICB9CiAgZm9yICh1bnNp
Z25lZCBpID0gMDsgaSA8IHNpemVvZihhcnB0X3RhYmxlcykgLyBzaXplb2YoYXJwdF90YWJsZXNb
MF0pOyBpKyspIHsKICAgIHN0cnVjdCBhcnB0X3RhYmxlX2Rlc2MqIHRhYmxlID0gJmFycHRfdGFi
bGVzW2ldOwogICAgc3RyY3B5KHRhYmxlLT5pbmZvLm5hbWUsIHRhYmxlLT5uYW1lKTsKICAgIHN0
cmNweSh0YWJsZS0+cmVwbGFjZS5uYW1lLCB0YWJsZS0+bmFtZSk7CiAgICBzb2NrbGVuX3Qgb3B0
bGVuID0gc2l6ZW9mKHRhYmxlLT5pbmZvKTsKICAgIGlmIChnZXRzb2Nrb3B0KGZkLCBTT0xfSVAs
IEFSUFRfU09fR0VUX0lORk8sICZ0YWJsZS0+aW5mbywgJm9wdGxlbikpIHsKICAgICAgc3dpdGNo
IChlcnJubykgewogICAgICBjYXNlIEVQRVJNOgogICAgICBjYXNlIEVOT0VOVDoKICAgICAgY2Fz
ZSBFTk9QUk9UT09QVDoKICAgICAgICBjb250aW51ZTsKICAgICAgfQogICAgICBleGl0KDEpOwog
ICAgfQogICAgaWYgKHRhYmxlLT5pbmZvLnNpemUgPiBzaXplb2YodGFibGUtPnJlcGxhY2UuZW50
cnl0YWJsZSkpCiAgICAgIGV4aXQoMSk7CiAgICBpZiAodGFibGUtPmluZm8ubnVtX2VudHJpZXMg
PiBYVF9NQVhfRU5UUklFUykKICAgICAgZXhpdCgxKTsKICAgIHN0cnVjdCBhcnB0X2dldF9lbnRy
aWVzIGVudHJpZXM7CiAgICBtZW1zZXQoJmVudHJpZXMsIDAsIHNpemVvZihlbnRyaWVzKSk7CiAg
ICBzdHJjcHkoZW50cmllcy5uYW1lLCB0YWJsZS0+bmFtZSk7CiAgICBlbnRyaWVzLnNpemUgPSB0
YWJsZS0+aW5mby5zaXplOwogICAgb3B0bGVuID0gc2l6ZW9mKGVudHJpZXMpIC0gc2l6ZW9mKGVu
dHJpZXMuZW50cnl0YWJsZSkgKyB0YWJsZS0+aW5mby5zaXplOwogICAgaWYgKGdldHNvY2tvcHQo
ZmQsIFNPTF9JUCwgQVJQVF9TT19HRVRfRU5UUklFUywgJmVudHJpZXMsICZvcHRsZW4pKQogICAg
ICBleGl0KDEpOwogICAgdGFibGUtPnJlcGxhY2UudmFsaWRfaG9va3MgPSB0YWJsZS0+aW5mby52
YWxpZF9ob29rczsKICAgIHRhYmxlLT5yZXBsYWNlLm51bV9lbnRyaWVzID0gdGFibGUtPmluZm8u
bnVtX2VudHJpZXM7CiAgICB0YWJsZS0+cmVwbGFjZS5zaXplID0gdGFibGUtPmluZm8uc2l6ZTsK
ICAgIG1lbWNweSh0YWJsZS0+cmVwbGFjZS5ob29rX2VudHJ5LCB0YWJsZS0+aW5mby5ob29rX2Vu
dHJ5LAogICAgICAgICAgIHNpemVvZih0YWJsZS0+cmVwbGFjZS5ob29rX2VudHJ5KSk7CiAgICBt
ZW1jcHkodGFibGUtPnJlcGxhY2UudW5kZXJmbG93LCB0YWJsZS0+aW5mby51bmRlcmZsb3csCiAg
ICAgICAgICAgc2l6ZW9mKHRhYmxlLT5yZXBsYWNlLnVuZGVyZmxvdykpOwogICAgbWVtY3B5KHRh
YmxlLT5yZXBsYWNlLmVudHJ5dGFibGUsIGVudHJpZXMuZW50cnl0YWJsZSwgdGFibGUtPmluZm8u
c2l6ZSk7CiAgfQogIGNsb3NlKGZkKTsKfQoKc3RhdGljIHZvaWQgcmVzZXRfYXJwdGFibGVzKCkK
ewogIGludCBmZCA9IHNvY2tldChBRl9JTkVULCBTT0NLX1NUUkVBTSwgSVBQUk9UT19UQ1ApOwog
IGlmIChmZCA9PSAtMSkgewogICAgc3dpdGNoIChlcnJubykgewogICAgY2FzZSBFQUZOT1NVUFBP
UlQ6CiAgICBjYXNlIEVOT1BST1RPT1BUOgogICAgY2FzZSBFTk9FTlQ6CiAgICAgIHJldHVybjsK
ICAgIH0KICAgIGV4aXQoMSk7CiAgfQogIGZvciAodW5zaWduZWQgaSA9IDA7IGkgPCBzaXplb2Yo
YXJwdF90YWJsZXMpIC8gc2l6ZW9mKGFycHRfdGFibGVzWzBdKTsgaSsrKSB7CiAgICBzdHJ1Y3Qg
YXJwdF90YWJsZV9kZXNjKiB0YWJsZSA9ICZhcnB0X3RhYmxlc1tpXTsKICAgIGlmICh0YWJsZS0+
aW5mby52YWxpZF9ob29rcyA9PSAwKQogICAgICBjb250aW51ZTsKICAgIHN0cnVjdCBhcnB0X2dl
dGluZm8gaW5mbzsKICAgIG1lbXNldCgmaW5mbywgMCwgc2l6ZW9mKGluZm8pKTsKICAgIHN0cmNw
eShpbmZvLm5hbWUsIHRhYmxlLT5uYW1lKTsKICAgIHNvY2tsZW5fdCBvcHRsZW4gPSBzaXplb2Yo
aW5mbyk7CiAgICBpZiAoZ2V0c29ja29wdChmZCwgU09MX0lQLCBBUlBUX1NPX0dFVF9JTkZPLCAm
aW5mbywgJm9wdGxlbikpCiAgICAgIGV4aXQoMSk7CiAgICBpZiAobWVtY21wKCZ0YWJsZS0+aW5m
bywgJmluZm8sIHNpemVvZih0YWJsZS0+aW5mbykpID09IDApIHsKICAgICAgc3RydWN0IGFycHRf
Z2V0X2VudHJpZXMgZW50cmllczsKICAgICAgbWVtc2V0KCZlbnRyaWVzLCAwLCBzaXplb2YoZW50
cmllcykpOwogICAgICBzdHJjcHkoZW50cmllcy5uYW1lLCB0YWJsZS0+bmFtZSk7CiAgICAgIGVu
dHJpZXMuc2l6ZSA9IHRhYmxlLT5pbmZvLnNpemU7CiAgICAgIG9wdGxlbiA9IHNpemVvZihlbnRy
aWVzKSAtIHNpemVvZihlbnRyaWVzLmVudHJ5dGFibGUpICsgZW50cmllcy5zaXplOwogICAgICBp
ZiAoZ2V0c29ja29wdChmZCwgU09MX0lQLCBBUlBUX1NPX0dFVF9FTlRSSUVTLCAmZW50cmllcywg
Jm9wdGxlbikpCiAgICAgICAgZXhpdCgxKTsKICAgICAgaWYgKG1lbWNtcCh0YWJsZS0+cmVwbGFj
ZS5lbnRyeXRhYmxlLCBlbnRyaWVzLmVudHJ5dGFibGUsCiAgICAgICAgICAgICAgICAgdGFibGUt
PmluZm8uc2l6ZSkgPT0gMCkKICAgICAgICBjb250aW51ZTsKICAgIH0gZWxzZSB7CiAgICB9CiAg
ICBzdHJ1Y3QgeHRfY291bnRlcnMgY291bnRlcnNbWFRfTUFYX0VOVFJJRVNdOwogICAgdGFibGUt
PnJlcGxhY2UubnVtX2NvdW50ZXJzID0gaW5mby5udW1fZW50cmllczsKICAgIHRhYmxlLT5yZXBs
YWNlLmNvdW50ZXJzID0gY291bnRlcnM7CiAgICBvcHRsZW4gPSBzaXplb2YodGFibGUtPnJlcGxh
Y2UpIC0gc2l6ZW9mKHRhYmxlLT5yZXBsYWNlLmVudHJ5dGFibGUpICsKICAgICAgICAgICAgIHRh
YmxlLT5yZXBsYWNlLnNpemU7CiAgICBpZiAoc2V0c29ja29wdChmZCwgU09MX0lQLCBBUlBUX1NP
X1NFVF9SRVBMQUNFLCAmdGFibGUtPnJlcGxhY2UsIG9wdGxlbikpCiAgICAgIGV4aXQoMSk7CiAg
fQogIGNsb3NlKGZkKTsKfQoKI2RlZmluZSBORl9CUl9OVU1IT09LUyA2CiNkZWZpbmUgRUJUX1RB
QkxFX01BWE5BTUVMRU4gMzIKI2RlZmluZSBFQlRfQ0hBSU5fTUFYTkFNRUxFTiAzMgojZGVmaW5l
IEVCVF9CQVNFX0NUTCAxMjgKI2RlZmluZSBFQlRfU09fU0VUX0VOVFJJRVMgKEVCVF9CQVNFX0NU
TCkKI2RlZmluZSBFQlRfU09fR0VUX0lORk8gKEVCVF9CQVNFX0NUTCkKI2RlZmluZSBFQlRfU09f
R0VUX0VOVFJJRVMgKEVCVF9TT19HRVRfSU5GTyArIDEpCiNkZWZpbmUgRUJUX1NPX0dFVF9JTklU
X0lORk8gKEVCVF9TT19HRVRfRU5UUklFUyArIDEpCiNkZWZpbmUgRUJUX1NPX0dFVF9JTklUX0VO
VFJJRVMgKEVCVF9TT19HRVRfSU5JVF9JTkZPICsgMSkKCnN0cnVjdCBlYnRfcmVwbGFjZSB7CiAg
Y2hhciBuYW1lW0VCVF9UQUJMRV9NQVhOQU1FTEVOXTsKICB1bnNpZ25lZCBpbnQgdmFsaWRfaG9v
a3M7CiAgdW5zaWduZWQgaW50IG5lbnRyaWVzOwogIHVuc2lnbmVkIGludCBlbnRyaWVzX3NpemU7
CiAgc3RydWN0IGVidF9lbnRyaWVzKiBob29rX2VudHJ5W05GX0JSX05VTUhPT0tTXTsKICB1bnNp
Z25lZCBpbnQgbnVtX2NvdW50ZXJzOwogIHN0cnVjdCBlYnRfY291bnRlciogY291bnRlcnM7CiAg
Y2hhciogZW50cmllczsKfTsKCnN0cnVjdCBlYnRfZW50cmllcyB7CiAgdW5zaWduZWQgaW50IGRp
c3Rpbmd1aXNoZXI7CiAgY2hhciBuYW1lW0VCVF9DSEFJTl9NQVhOQU1FTEVOXTsKICB1bnNpZ25l
ZCBpbnQgY291bnRlcl9vZmZzZXQ7CiAgaW50IHBvbGljeTsKICB1bnNpZ25lZCBpbnQgbmVudHJp
ZXM7CiAgY2hhciBkYXRhWzBdIF9fYXR0cmlidXRlX18oKGFsaWduZWQoX19hbGlnbm9mX18oc3Ry
dWN0IGVidF9yZXBsYWNlKSkpKTsKfTsKCnN0cnVjdCBlYnRfdGFibGVfZGVzYyB7CiAgY29uc3Qg
Y2hhciogbmFtZTsKICBzdHJ1Y3QgZWJ0X3JlcGxhY2UgcmVwbGFjZTsKICBjaGFyIGVudHJ5dGFi
bGVbWFRfVEFCTEVfU0laRV07Cn07CgpzdGF0aWMgc3RydWN0IGVidF90YWJsZV9kZXNjIGVidF90
YWJsZXNbXSA9IHsKICAgIHsubmFtZSA9ICJmaWx0ZXIifSwKICAgIHsubmFtZSA9ICJuYXQifSwK
ICAgIHsubmFtZSA9ICJicm91dGUifSwKfTsKCnN0YXRpYyB2b2lkIGNoZWNrcG9pbnRfZWJ0YWJs
ZXModm9pZCkKewogIGludCBmZCA9IHNvY2tldChBRl9JTkVULCBTT0NLX1NUUkVBTSwgSVBQUk9U
T19UQ1ApOwogIGlmIChmZCA9PSAtMSkgewogICAgc3dpdGNoIChlcnJubykgewogICAgY2FzZSBF
QUZOT1NVUFBPUlQ6CiAgICBjYXNlIEVOT1BST1RPT1BUOgogICAgY2FzZSBFTk9FTlQ6CiAgICAg
IHJldHVybjsKICAgIH0KICAgIGV4aXQoMSk7CiAgfQogIGZvciAoc2l6ZV90IGkgPSAwOyBpIDwg
c2l6ZW9mKGVidF90YWJsZXMpIC8gc2l6ZW9mKGVidF90YWJsZXNbMF0pOyBpKyspIHsKICAgIHN0
cnVjdCBlYnRfdGFibGVfZGVzYyogdGFibGUgPSAmZWJ0X3RhYmxlc1tpXTsKICAgIHN0cmNweSh0
YWJsZS0+cmVwbGFjZS5uYW1lLCB0YWJsZS0+bmFtZSk7CiAgICBzb2NrbGVuX3Qgb3B0bGVuID0g
c2l6ZW9mKHRhYmxlLT5yZXBsYWNlKTsKICAgIGlmIChnZXRzb2Nrb3B0KGZkLCBTT0xfSVAsIEVC
VF9TT19HRVRfSU5JVF9JTkZPLCAmdGFibGUtPnJlcGxhY2UsCiAgICAgICAgICAgICAgICAgICAm
b3B0bGVuKSkgewogICAgICBzd2l0Y2ggKGVycm5vKSB7CiAgICAgIGNhc2UgRVBFUk06CiAgICAg
IGNhc2UgRU5PRU5UOgogICAgICBjYXNlIEVOT1BST1RPT1BUOgogICAgICAgIGNvbnRpbnVlOwog
ICAgICB9CiAgICAgIGV4aXQoMSk7CiAgICB9CiAgICBpZiAodGFibGUtPnJlcGxhY2UuZW50cmll
c19zaXplID4gc2l6ZW9mKHRhYmxlLT5lbnRyeXRhYmxlKSkKICAgICAgZXhpdCgxKTsKICAgIHRh
YmxlLT5yZXBsYWNlLm51bV9jb3VudGVycyA9IDA7CiAgICB0YWJsZS0+cmVwbGFjZS5lbnRyaWVz
ID0gdGFibGUtPmVudHJ5dGFibGU7CiAgICBvcHRsZW4gPSBzaXplb2YodGFibGUtPnJlcGxhY2Up
ICsgdGFibGUtPnJlcGxhY2UuZW50cmllc19zaXplOwogICAgaWYgKGdldHNvY2tvcHQoZmQsIFNP
TF9JUCwgRUJUX1NPX0dFVF9JTklUX0VOVFJJRVMsICZ0YWJsZS0+cmVwbGFjZSwKICAgICAgICAg
ICAgICAgICAgICZvcHRsZW4pKQogICAgICBleGl0KDEpOwogIH0KICBjbG9zZShmZCk7Cn0KCnN0
YXRpYyB2b2lkIHJlc2V0X2VidGFibGVzKCkKewogIGludCBmZCA9IHNvY2tldChBRl9JTkVULCBT
T0NLX1NUUkVBTSwgSVBQUk9UT19UQ1ApOwogIGlmIChmZCA9PSAtMSkgewogICAgc3dpdGNoIChl
cnJubykgewogICAgY2FzZSBFQUZOT1NVUFBPUlQ6CiAgICBjYXNlIEVOT1BST1RPT1BUOgogICAg
Y2FzZSBFTk9FTlQ6CiAgICAgIHJldHVybjsKICAgIH0KICAgIGV4aXQoMSk7CiAgfQogIGZvciAo
dW5zaWduZWQgaSA9IDA7IGkgPCBzaXplb2YoZWJ0X3RhYmxlcykgLyBzaXplb2YoZWJ0X3RhYmxl
c1swXSk7IGkrKykgewogICAgc3RydWN0IGVidF90YWJsZV9kZXNjKiB0YWJsZSA9ICZlYnRfdGFi
bGVzW2ldOwogICAgaWYgKHRhYmxlLT5yZXBsYWNlLnZhbGlkX2hvb2tzID09IDApCiAgICAgIGNv
bnRpbnVlOwogICAgc3RydWN0IGVidF9yZXBsYWNlIHJlcGxhY2U7CiAgICBtZW1zZXQoJnJlcGxh
Y2UsIDAsIHNpemVvZihyZXBsYWNlKSk7CiAgICBzdHJjcHkocmVwbGFjZS5uYW1lLCB0YWJsZS0+
bmFtZSk7CiAgICBzb2NrbGVuX3Qgb3B0bGVuID0gc2l6ZW9mKHJlcGxhY2UpOwogICAgaWYgKGdl
dHNvY2tvcHQoZmQsIFNPTF9JUCwgRUJUX1NPX0dFVF9JTkZPLCAmcmVwbGFjZSwgJm9wdGxlbikp
CiAgICAgIGV4aXQoMSk7CiAgICByZXBsYWNlLm51bV9jb3VudGVycyA9IDA7CiAgICB0YWJsZS0+
cmVwbGFjZS5lbnRyaWVzID0gMDsKICAgIGZvciAodW5zaWduZWQgaCA9IDA7IGggPCBORl9CUl9O
VU1IT09LUzsgaCsrKQogICAgICB0YWJsZS0+cmVwbGFjZS5ob29rX2VudHJ5W2hdID0gMDsKICAg
IGlmIChtZW1jbXAoJnRhYmxlLT5yZXBsYWNlLCAmcmVwbGFjZSwgc2l6ZW9mKHRhYmxlLT5yZXBs
YWNlKSkgPT0gMCkgewogICAgICBjaGFyIGVudHJ5dGFibGVbWFRfVEFCTEVfU0laRV07CiAgICAg
IG1lbXNldCgmZW50cnl0YWJsZSwgMCwgc2l6ZW9mKGVudHJ5dGFibGUpKTsKICAgICAgcmVwbGFj
ZS5lbnRyaWVzID0gZW50cnl0YWJsZTsKICAgICAgb3B0bGVuID0gc2l6ZW9mKHJlcGxhY2UpICsg
cmVwbGFjZS5lbnRyaWVzX3NpemU7CiAgICAgIGlmIChnZXRzb2Nrb3B0KGZkLCBTT0xfSVAsIEVC
VF9TT19HRVRfRU5UUklFUywgJnJlcGxhY2UsICZvcHRsZW4pKQogICAgICAgIGV4aXQoMSk7CiAg
ICAgIGlmIChtZW1jbXAodGFibGUtPmVudHJ5dGFibGUsIGVudHJ5dGFibGUsIHJlcGxhY2UuZW50
cmllc19zaXplKSA9PSAwKQogICAgICAgIGNvbnRpbnVlOwogICAgfQogICAgZm9yICh1bnNpZ25l
ZCBqID0gMCwgaCA9IDA7IGggPCBORl9CUl9OVU1IT09LUzsgaCsrKSB7CiAgICAgIGlmICh0YWJs
ZS0+cmVwbGFjZS52YWxpZF9ob29rcyAmICgxIDw8IGgpKSB7CiAgICAgICAgdGFibGUtPnJlcGxh
Y2UuaG9va19lbnRyeVtoXSA9CiAgICAgICAgICAgIChzdHJ1Y3QgZWJ0X2VudHJpZXMqKXRhYmxl
LT5lbnRyeXRhYmxlICsgajsKICAgICAgICBqKys7CiAgICAgIH0KICAgIH0KICAgIHRhYmxlLT5y
ZXBsYWNlLmVudHJpZXMgPSB0YWJsZS0+ZW50cnl0YWJsZTsKICAgIG9wdGxlbiA9IHNpemVvZih0
YWJsZS0+cmVwbGFjZSkgKyB0YWJsZS0+cmVwbGFjZS5lbnRyaWVzX3NpemU7CiAgICBpZiAoc2V0
c29ja29wdChmZCwgU09MX0lQLCBFQlRfU09fU0VUX0VOVFJJRVMsICZ0YWJsZS0+cmVwbGFjZSwg
b3B0bGVuKSkKICAgICAgZXhpdCgxKTsKICB9CiAgY2xvc2UoZmQpOwp9CgpzdGF0aWMgdm9pZCBj
aGVja3BvaW50X25ldF9uYW1lc3BhY2Uodm9pZCkKewogIGNoZWNrcG9pbnRfZWJ0YWJsZXMoKTsK
ICBjaGVja3BvaW50X2FycHRhYmxlcygpOwogIGNoZWNrcG9pbnRfaXB0YWJsZXMoaXB2NF90YWJs
ZXMsIHNpemVvZihpcHY0X3RhYmxlcykgLyBzaXplb2YoaXB2NF90YWJsZXNbMF0pLAogICAgICAg
ICAgICAgICAgICAgICAgQUZfSU5FVCwgU09MX0lQKTsKICBjaGVja3BvaW50X2lwdGFibGVzKGlw
djZfdGFibGVzLCBzaXplb2YoaXB2Nl90YWJsZXMpIC8gc2l6ZW9mKGlwdjZfdGFibGVzWzBdKSwK
ICAgICAgICAgICAgICAgICAgICAgIEFGX0lORVQ2LCBTT0xfSVBWNik7Cn0KCnN0YXRpYyB2b2lk
IHJlc2V0X25ldF9uYW1lc3BhY2Uodm9pZCkKewogIHJlc2V0X2VidGFibGVzKCk7CiAgcmVzZXRf
YXJwdGFibGVzKCk7CiAgcmVzZXRfaXB0YWJsZXMoaXB2NF90YWJsZXMsIHNpemVvZihpcHY0X3Rh
YmxlcykgLyBzaXplb2YoaXB2NF90YWJsZXNbMF0pLAogICAgICAgICAgICAgICAgIEFGX0lORVQs
IFNPTF9JUCk7CiAgcmVzZXRfaXB0YWJsZXMoaXB2Nl90YWJsZXMsIHNpemVvZihpcHY2X3RhYmxl
cykgLyBzaXplb2YoaXB2Nl90YWJsZXNbMF0pLAogICAgICAgICAgICAgICAgIEFGX0lORVQ2LCBT
T0xfSVBWNik7Cn0KCnN0YXRpYyB2b2lkIG1vdW50X2Nncm91cHMoY29uc3QgY2hhciogZGlyLCBj
b25zdCBjaGFyKiogY29udHJvbGxlcnMsIGludCBjb3VudCkKewogIGlmIChta2RpcihkaXIsIDA3
NzcpKSB7CiAgICByZXR1cm47CiAgfQogIGNoYXIgZW5hYmxlZFsxMjhdID0gezB9OwogIGludCBp
ID0gMDsKICBmb3IgKDsgaSA8IGNvdW50OyBpKyspIHsKICAgIGlmIChtb3VudCgibm9uZSIsIGRp
ciwgImNncm91cCIsIDAsIGNvbnRyb2xsZXJzW2ldKSkgewogICAgICBjb250aW51ZTsKICAgIH0K
ICAgIHVtb3VudChkaXIpOwogICAgc3RyY2F0KGVuYWJsZWQsICIsIik7CiAgICBzdHJjYXQoZW5h
YmxlZCwgY29udHJvbGxlcnNbaV0pOwogIH0KICBpZiAoZW5hYmxlZFswXSA9PSAwKSB7CiAgICBp
ZiAocm1kaXIoZGlyKSAmJiBlcnJubyAhPSBFQlVTWSkKICAgICAgZXhpdCgxKTsKICAgIHJldHVy
bjsKICB9CiAgaWYgKG1vdW50KCJub25lIiwgZGlyLCAiY2dyb3VwIiwgMCwgZW5hYmxlZCArIDEp
KSB7CiAgICBpZiAocm1kaXIoZGlyKSAmJiBlcnJubyAhPSBFQlVTWSkKICAgICAgZXhpdCgxKTsK
ICB9CiAgaWYgKGNobW9kKGRpciwgMDc3NykpIHsKICB9Cn0KCnN0YXRpYyB2b2lkIG1vdW50X2Nn
cm91cHMyKGNvbnN0IGNoYXIqKiBjb250cm9sbGVycywgaW50IGNvdW50KQp7CiAgaWYgKG1rZGly
KCIvc3l6Y2dyb3VwL3VuaWZpZWQiLCAwNzc3KSkgewogICAgcmV0dXJuOwogIH0KICBpZiAobW91
bnQoIm5vbmUiLCAiL3N5emNncm91cC91bmlmaWVkIiwgImNncm91cDIiLCAwLCBOVUxMKSkgewog
ICAgaWYgKHJtZGlyKCIvc3l6Y2dyb3VwL3VuaWZpZWQiKSAmJiBlcnJubyAhPSBFQlVTWSkKICAg
ICAgZXhpdCgxKTsKICAgIHJldHVybjsKICB9CiAgaWYgKGNobW9kKCIvc3l6Y2dyb3VwL3VuaWZp
ZWQiLCAwNzc3KSkgewogIH0KICBpbnQgY29udHJvbCA9IG9wZW4oIi9zeXpjZ3JvdXAvdW5pZmll
ZC9jZ3JvdXAuc3VidHJlZV9jb250cm9sIiwgT19XUk9OTFkpOwogIGlmIChjb250cm9sID09IC0x
KQogICAgcmV0dXJuOwogIGludCBpOwogIGZvciAoaSA9IDA7IGkgPCBjb3VudDsgaSsrKQogICAg
aWYgKHdyaXRlKGNvbnRyb2wsIGNvbnRyb2xsZXJzW2ldLCBzdHJsZW4oY29udHJvbGxlcnNbaV0p
KSA8IDApIHsKICAgIH0KICBjbG9zZShjb250cm9sKTsKfQoKc3RhdGljIHZvaWQgc2V0dXBfY2dy
b3VwcygpCnsKICBjb25zdCBjaGFyKiB1bmlmaWVkX2NvbnRyb2xsZXJzW10gPSB7IitjcHUiLCAi
K2lvIiwgIitwaWRzIn07CiAgY29uc3QgY2hhciogbmV0X2NvbnRyb2xsZXJzW10gPSB7Im5ldCIs
ICJuZXRfcHJpbyIsICJkZXZpY2VzIiwgImJsa2lvIiwKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAiZnJlZXplciJ9OwogIGNvbnN0IGNoYXIqIGNwdV9jb250cm9sbGVyc1tdID0g
eyJjcHVzZXQiLCAiY3B1YWNjdCIsICJodWdldGxiIiwgInJsaW1pdCIsCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIm1lbW9yeSJ9OwogIGlmIChta2RpcigiL3N5emNncm91cCIs
IDA3NzcpKSB7CiAgICByZXR1cm47CiAgfQogIG1vdW50X2Nncm91cHMyKHVuaWZpZWRfY29udHJv
bGxlcnMsCiAgICAgICAgICAgICAgICAgc2l6ZW9mKHVuaWZpZWRfY29udHJvbGxlcnMpIC8gc2l6
ZW9mKHVuaWZpZWRfY29udHJvbGxlcnNbMF0pKTsKICBtb3VudF9jZ3JvdXBzKCIvc3l6Y2dyb3Vw
L25ldCIsIG5ldF9jb250cm9sbGVycywKICAgICAgICAgICAgICAgIHNpemVvZihuZXRfY29udHJv
bGxlcnMpIC8gc2l6ZW9mKG5ldF9jb250cm9sbGVyc1swXSkpOwogIG1vdW50X2Nncm91cHMoIi9z
eXpjZ3JvdXAvY3B1IiwgY3B1X2NvbnRyb2xsZXJzLAogICAgICAgICAgICAgICAgc2l6ZW9mKGNw
dV9jb250cm9sbGVycykgLyBzaXplb2YoY3B1X2NvbnRyb2xsZXJzWzBdKSk7CiAgd3JpdGVfZmls
ZSgiL3N5emNncm91cC9jcHUvY2dyb3VwLmNsb25lX2NoaWxkcmVuIiwgIjEiKTsKICB3cml0ZV9m
aWxlKCIvc3l6Y2dyb3VwL2NwdS9jcHVzZXQubWVtb3J5X3ByZXNzdXJlX2VuYWJsZWQiLCAiMSIp
Owp9CgpzdGF0aWMgdm9pZCBzZXR1cF9jZ3JvdXBzX2xvb3AoKQp7CiAgaW50IHBpZCA9IGdldHBp
ZCgpOwogIGNoYXIgZmlsZVsxMjhdOwogIGNoYXIgY2dyb3VwZGlyWzY0XTsKICBzbnByaW50Zihj
Z3JvdXBkaXIsIHNpemVvZihjZ3JvdXBkaXIpLCAiL3N5emNncm91cC91bmlmaWVkL3N5eiVsbHUi
LCBwcm9jaWQpOwogIGlmIChta2RpcihjZ3JvdXBkaXIsIDA3NzcpKSB7CiAgfQogIHNucHJpbnRm
KGZpbGUsIHNpemVvZihmaWxlKSwgIiVzL3BpZHMubWF4IiwgY2dyb3VwZGlyKTsKICB3cml0ZV9m
aWxlKGZpbGUsICIzMiIpOwogIHNucHJpbnRmKGZpbGUsIHNpemVvZihmaWxlKSwgIiVzL2Nncm91
cC5wcm9jcyIsIGNncm91cGRpcik7CiAgd3JpdGVfZmlsZShmaWxlLCAiJWQiLCBwaWQpOwogIHNu
cHJpbnRmKGNncm91cGRpciwgc2l6ZW9mKGNncm91cGRpciksICIvc3l6Y2dyb3VwL2NwdS9zeXol
bGx1IiwgcHJvY2lkKTsKICBpZiAobWtkaXIoY2dyb3VwZGlyLCAwNzc3KSkgewogIH0KICBzbnBy
aW50ZihmaWxlLCBzaXplb2YoZmlsZSksICIlcy9jZ3JvdXAucHJvY3MiLCBjZ3JvdXBkaXIpOwog
IHdyaXRlX2ZpbGUoZmlsZSwgIiVkIiwgcGlkKTsKICBzbnByaW50ZihmaWxlLCBzaXplb2YoZmls
ZSksICIlcy9tZW1vcnkuc29mdF9saW1pdF9pbl9ieXRlcyIsIGNncm91cGRpcik7CiAgd3JpdGVf
ZmlsZShmaWxlLCAiJWQiLCAyOTkgPDwgMjApOwogIHNucHJpbnRmKGZpbGUsIHNpemVvZihmaWxl
KSwgIiVzL21lbW9yeS5saW1pdF9pbl9ieXRlcyIsIGNncm91cGRpcik7CiAgd3JpdGVfZmlsZShm
aWxlLCAiJWQiLCAzMDAgPDwgMjApOwogIHNucHJpbnRmKGNncm91cGRpciwgc2l6ZW9mKGNncm91
cGRpciksICIvc3l6Y2dyb3VwL25ldC9zeXolbGx1IiwgcHJvY2lkKTsKICBpZiAobWtkaXIoY2dy
b3VwZGlyLCAwNzc3KSkgewogIH0KICBzbnByaW50ZihmaWxlLCBzaXplb2YoZmlsZSksICIlcy9j
Z3JvdXAucHJvY3MiLCBjZ3JvdXBkaXIpOwogIHdyaXRlX2ZpbGUoZmlsZSwgIiVkIiwgcGlkKTsK
fQoKc3RhdGljIHZvaWQgc2V0dXBfY2dyb3Vwc190ZXN0KCkKewogIGNoYXIgY2dyb3VwZGlyWzY0
XTsKICBzbnByaW50ZihjZ3JvdXBkaXIsIHNpemVvZihjZ3JvdXBkaXIpLCAiL3N5emNncm91cC91
bmlmaWVkL3N5eiVsbHUiLCBwcm9jaWQpOwogIGlmIChzeW1saW5rKGNncm91cGRpciwgIi4vY2dy
b3VwIikpIHsKICB9CiAgc25wcmludGYoY2dyb3VwZGlyLCBzaXplb2YoY2dyb3VwZGlyKSwgIi9z
eXpjZ3JvdXAvY3B1L3N5eiVsbHUiLCBwcm9jaWQpOwogIGlmIChzeW1saW5rKGNncm91cGRpciwg
Ii4vY2dyb3VwLmNwdSIpKSB7CiAgfQogIHNucHJpbnRmKGNncm91cGRpciwgc2l6ZW9mKGNncm91
cGRpciksICIvc3l6Y2dyb3VwL25ldC9zeXolbGx1IiwgcHJvY2lkKTsKICBpZiAoc3ltbGluayhj
Z3JvdXBkaXIsICIuL2Nncm91cC5uZXQiKSkgewogIH0KfQoKc3RhdGljIHZvaWQgc2V0dXBfY29t
bW9uKCkKewogIGlmIChtb3VudCgwLCAiL3N5cy9mcy9mdXNlL2Nvbm5lY3Rpb25zIiwgImZ1c2Vj
dGwiLCAwLCAwKSkgewogIH0KfQoKc3RhdGljIHZvaWQgc2V0dXBfYmluZGVyZnMoKQp7CiAgaWYg
KG1rZGlyKCIvZGV2L2JpbmRlcmZzIiwgMDc3NykpIHsKICB9CiAgaWYgKG1vdW50KCJiaW5kZXIi
LCAiL2Rldi9iaW5kZXJmcyIsICJiaW5kZXIiLCAwLCBOVUxMKSkgewogIH0KfQoKc3RhdGljIHZv
aWQgbG9vcCgpOwoKc3RhdGljIHZvaWQgc2FuZGJveF9jb21tb24oKQp7CiAgcHJjdGwoUFJfU0VU
X1BERUFUSFNJRywgU0lHS0lMTCwgMCwgMCwgMCk7CiAgc2V0c2lkKCk7CiAgaW50IG5ldG5zID0g
b3BlbigiL3Byb2Mvc2VsZi9ucy9uZXQiLCBPX1JET05MWSk7CiAgaWYgKG5ldG5zID09IC0xKQog
ICAgZXhpdCgxKTsKICBpZiAoZHVwMihuZXRucywga0luaXROZXROc0ZkKSA8IDApCiAgICBleGl0
KDEpOwogIGNsb3NlKG5ldG5zKTsKICBzdHJ1Y3QgcmxpbWl0IHJsaW07CiAgcmxpbS5ybGltX2N1
ciA9IHJsaW0ucmxpbV9tYXggPSAoMjAwIDw8IDIwKTsKICBzZXRybGltaXQoUkxJTUlUX0FTLCAm
cmxpbSk7CiAgcmxpbS5ybGltX2N1ciA9IHJsaW0ucmxpbV9tYXggPSAzMiA8PCAyMDsKICBzZXRy
bGltaXQoUkxJTUlUX01FTUxPQ0ssICZybGltKTsKICBybGltLnJsaW1fY3VyID0gcmxpbS5ybGlt
X21heCA9IDEzNiA8PCAyMDsKICBzZXRybGltaXQoUkxJTUlUX0ZTSVpFLCAmcmxpbSk7CiAgcmxp
bS5ybGltX2N1ciA9IHJsaW0ucmxpbV9tYXggPSAxIDw8IDIwOwogIHNldHJsaW1pdChSTElNSVRf
U1RBQ0ssICZybGltKTsKICBybGltLnJsaW1fY3VyID0gcmxpbS5ybGltX21heCA9IDEyOCA8PCAy
MDsKICBzZXRybGltaXQoUkxJTUlUX0NPUkUsICZybGltKTsKICBybGltLnJsaW1fY3VyID0gcmxp
bS5ybGltX21heCA9IDI1NjsKICBzZXRybGltaXQoUkxJTUlUX05PRklMRSwgJnJsaW0pOwogIGlm
ICh1bnNoYXJlKENMT05FX05FV05TKSkgewogIH0KICBpZiAobW91bnQoTlVMTCwgIi8iLCBOVUxM
LCBNU19SRUMgfCBNU19QUklWQVRFLCBOVUxMKSkgewogIH0KICBpZiAodW5zaGFyZShDTE9ORV9O
RVdJUEMpKSB7CiAgfQogIGlmICh1bnNoYXJlKDB4MDIwMDAwMDApKSB7CiAgfQogIGlmICh1bnNo
YXJlKENMT05FX05FV1VUUykpIHsKICB9CiAgaWYgKHVuc2hhcmUoQ0xPTkVfU1lTVlNFTSkpIHsK
ICB9CiAgdHlwZWRlZiBzdHJ1Y3QgewogICAgY29uc3QgY2hhciogbmFtZTsKICAgIGNvbnN0IGNo
YXIqIHZhbHVlOwogIH0gc3lzY3RsX3Q7CiAgc3RhdGljIGNvbnN0IHN5c2N0bF90IHN5c2N0bHNb
XSA9IHsKICAgICAgeyIvcHJvYy9zeXMva2VybmVsL3NobW1heCIsICIxNjc3NzIxNiJ9LAogICAg
ICB7Ii9wcm9jL3N5cy9rZXJuZWwvc2htYWxsIiwgIjUzNjg3MDkxMiJ9LAogICAgICB7Ii9wcm9j
L3N5cy9rZXJuZWwvc2htbW5pIiwgIjEwMjQifSwKICAgICAgeyIvcHJvYy9zeXMva2VybmVsL21z
Z21heCIsICI4MTkyIn0sCiAgICAgIHsiL3Byb2Mvc3lzL2tlcm5lbC9tc2dtbmkiLCAiMTAyNCJ9
LAogICAgICB7Ii9wcm9jL3N5cy9rZXJuZWwvbXNnbW5iIiwgIjEwMjQifSwKICAgICAgeyIvcHJv
Yy9zeXMva2VybmVsL3NlbSIsICIxMDI0IDEwNDg1NzYgNTAwIDEwMjQifSwKICB9OwogIHVuc2ln
bmVkIGk7CiAgZm9yIChpID0gMDsgaSA8IHNpemVvZihzeXNjdGxzKSAvIHNpemVvZihzeXNjdGxz
WzBdKTsgaSsrKQogICAgd3JpdGVfZmlsZShzeXNjdGxzW2ldLm5hbWUsIHN5c2N0bHNbaV0udmFs
dWUpOwp9CgpzdGF0aWMgaW50IHdhaXRfZm9yX2xvb3AoaW50IHBpZCkKewogIGlmIChwaWQgPCAw
KQogICAgZXhpdCgxKTsKICBpbnQgc3RhdHVzID0gMDsKICB3aGlsZSAod2FpdHBpZCgtMSwgJnN0
YXR1cywgX19XQUxMKSAhPSBwaWQpIHsKICB9CiAgcmV0dXJuIFdFWElUU1RBVFVTKHN0YXR1cyk7
Cn0KCnN0YXRpYyB2b2lkIGRyb3BfY2Fwcyh2b2lkKQp7CiAgc3RydWN0IF9fdXNlcl9jYXBfaGVh
ZGVyX3N0cnVjdCBjYXBfaGRyID0ge307CiAgc3RydWN0IF9fdXNlcl9jYXBfZGF0YV9zdHJ1Y3Qg
Y2FwX2RhdGFbMl0gPSB7fTsKICBjYXBfaGRyLnZlcnNpb24gPSBfTElOVVhfQ0FQQUJJTElUWV9W
RVJTSU9OXzM7CiAgY2FwX2hkci5waWQgPSBnZXRwaWQoKTsKICBpZiAoc3lzY2FsbChTWVNfY2Fw
Z2V0LCAmY2FwX2hkciwgJmNhcF9kYXRhKSkKICAgIGV4aXQoMSk7CiAgY29uc3QgaW50IGRyb3Ag
PSAoMSA8PCBDQVBfU1lTX1BUUkFDRSkgfCAoMSA8PCBDQVBfU1lTX05JQ0UpOwogIGNhcF9kYXRh
WzBdLmVmZmVjdGl2ZSAmPSB+ZHJvcDsKICBjYXBfZGF0YVswXS5wZXJtaXR0ZWQgJj0gfmRyb3A7
CiAgY2FwX2RhdGFbMF0uaW5oZXJpdGFibGUgJj0gfmRyb3A7CiAgaWYgKHN5c2NhbGwoU1lTX2Nh
cHNldCwgJmNhcF9oZHIsICZjYXBfZGF0YSkpCiAgICBleGl0KDEpOwp9CgpzdGF0aWMgaW50IGRv
X3NhbmRib3hfbm9uZSh2b2lkKQp7CiAgaWYgKHVuc2hhcmUoQ0xPTkVfTkVXUElEKSkgewogIH0K
ICBpbnQgcGlkID0gZm9yaygpOwogIGlmIChwaWQgIT0gMCkKICAgIHJldHVybiB3YWl0X2Zvcl9s
b29wKHBpZCk7CiAgc2V0dXBfY29tbW9uKCk7CiAgaW5pdGlhbGl6ZV92aGNpKCk7CiAgc2FuZGJv
eF9jb21tb24oKTsKICBkcm9wX2NhcHMoKTsKICBpbml0aWFsaXplX25ldGRldmljZXNfaW5pdCgp
OwogIGlmICh1bnNoYXJlKENMT05FX05FV05FVCkpIHsKICB9CiAgd3JpdGVfZmlsZSgiL3Byb2Mv
c3lzL25ldC9pcHY0L3BpbmdfZ3JvdXBfcmFuZ2UiLCAiMCA2NTUzNSIpOwogIGluaXRpYWxpemVf
dHVuKCk7CiAgaW5pdGlhbGl6ZV9uZXRkZXZpY2VzKCk7CiAgaW5pdGlhbGl6ZV93aWZpX2Rldmlj
ZXMoKTsKICBzZXR1cF9iaW5kZXJmcygpOwogIGxvb3AoKTsKICBleGl0KDEpOwp9CgojZGVmaW5l
IEZTX0lPQ19TRVRGTEFHUyBfSU9XKCdmJywgMiwgbG9uZykKc3RhdGljIHZvaWQgcmVtb3ZlX2Rp
cihjb25zdCBjaGFyKiBkaXIpCnsKICBpbnQgaXRlciA9IDA7CiAgRElSKiBkcCA9IDA7CnJldHJ5
OgogIGNvbnN0IGludCB1bW91bnRfZmxhZ3MgPSBNTlRfRk9SQ0UgfCBVTU9VTlRfTk9GT0xMT1c7
CiAgd2hpbGUgKHVtb3VudDIoZGlyLCB1bW91bnRfZmxhZ3MpID09IDApIHsKICB9CiAgZHAgPSBv
cGVuZGlyKGRpcik7CiAgaWYgKGRwID09IE5VTEwpIHsKICAgIGlmIChlcnJubyA9PSBFTUZJTEUp
IHsKICAgICAgZXhpdCgxKTsKICAgIH0KICAgIGV4aXQoMSk7CiAgfQogIHN0cnVjdCBkaXJlbnQq
IGVwID0gMDsKICB3aGlsZSAoKGVwID0gcmVhZGRpcihkcCkpKSB7CiAgICBpZiAoc3RyY21wKGVw
LT5kX25hbWUsICIuIikgPT0gMCB8fCBzdHJjbXAoZXAtPmRfbmFtZSwgIi4uIikgPT0gMCkKICAg
ICAgY29udGludWU7CiAgICBjaGFyIGZpbGVuYW1lW0ZJTEVOQU1FX01BWF07CiAgICBzbnByaW50
ZihmaWxlbmFtZSwgc2l6ZW9mKGZpbGVuYW1lKSwgIiVzLyVzIiwgZGlyLCBlcC0+ZF9uYW1lKTsK
ICAgIHdoaWxlICh1bW91bnQyKGZpbGVuYW1lLCB1bW91bnRfZmxhZ3MpID09IDApIHsKICAgIH0K
ICAgIHN0cnVjdCBzdGF0IHN0OwogICAgaWYgKGxzdGF0KGZpbGVuYW1lLCAmc3QpKQogICAgICBl
eGl0KDEpOwogICAgaWYgKFNfSVNESVIoc3Quc3RfbW9kZSkpIHsKICAgICAgcmVtb3ZlX2Rpcihm
aWxlbmFtZSk7CiAgICAgIGNvbnRpbnVlOwogICAgfQogICAgaW50IGk7CiAgICBmb3IgKGkgPSAw
OzsgaSsrKSB7CiAgICAgIGlmICh1bmxpbmsoZmlsZW5hbWUpID09IDApCiAgICAgICAgYnJlYWs7
CiAgICAgIGlmIChlcnJubyA9PSBFUEVSTSkgewogICAgICAgIGludCBmZCA9IG9wZW4oZmlsZW5h
bWUsIE9fUkRPTkxZKTsKICAgICAgICBpZiAoZmQgIT0gLTEpIHsKICAgICAgICAgIGxvbmcgZmxh
Z3MgPSAwOwogICAgICAgICAgaWYgKGlvY3RsKGZkLCBGU19JT0NfU0VURkxBR1MsICZmbGFncykg
PT0gMCkgewogICAgICAgICAgfQogICAgICAgICAgY2xvc2UoZmQpOwogICAgICAgICAgY29udGlu
dWU7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmIChlcnJubyA9PSBFUk9GUykgewogICAgICAg
IGJyZWFrOwogICAgICB9CiAgICAgIGlmIChlcnJubyAhPSBFQlVTWSB8fCBpID4gMTAwKQogICAg
ICAgIGV4aXQoMSk7CiAgICAgIGlmICh1bW91bnQyKGZpbGVuYW1lLCB1bW91bnRfZmxhZ3MpKQog
ICAgICAgIGV4aXQoMSk7CiAgICB9CiAgfQogIGNsb3NlZGlyKGRwKTsKICBmb3IgKGludCBpID0g
MDs7IGkrKykgewogICAgaWYgKHJtZGlyKGRpcikgPT0gMCkKICAgICAgYnJlYWs7CiAgICBpZiAo
aSA8IDEwMCkgewogICAgICBpZiAoZXJybm8gPT0gRVBFUk0pIHsKICAgICAgICBpbnQgZmQgPSBv
cGVuKGRpciwgT19SRE9OTFkpOwogICAgICAgIGlmIChmZCAhPSAtMSkgewogICAgICAgICAgbG9u
ZyBmbGFncyA9IDA7CiAgICAgICAgICBpZiAoaW9jdGwoZmQsIEZTX0lPQ19TRVRGTEFHUywgJmZs
YWdzKSA9PSAwKSB7CiAgICAgICAgICB9CiAgICAgICAgICBjbG9zZShmZCk7CiAgICAgICAgICBj
b250aW51ZTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKGVycm5vID09IEVST0ZTKSB7CiAg
ICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgaWYgKGVycm5vID09IEVCVVNZKSB7CiAgICAgICAg
aWYgKHVtb3VudDIoZGlyLCB1bW91bnRfZmxhZ3MpKQogICAgICAgICAgZXhpdCgxKTsKICAgICAg
ICBjb250aW51ZTsKICAgICAgfQogICAgICBpZiAoZXJybm8gPT0gRU5PVEVNUFRZKSB7CiAgICAg
ICAgaWYgKGl0ZXIgPCAxMDApIHsKICAgICAgICAgIGl0ZXIrKzsKICAgICAgICAgIGdvdG8gcmV0
cnk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICBleGl0KDEpOwogIH0KfQoKc3RhdGljIHZv
aWQga2lsbF9hbmRfd2FpdChpbnQgcGlkLCBpbnQqIHN0YXR1cykKewogIGtpbGwoLXBpZCwgU0lH
S0lMTCk7CiAga2lsbChwaWQsIFNJR0tJTEwpOwogIGZvciAoaW50IGkgPSAwOyBpIDwgMTAwOyBp
KyspIHsKICAgIGlmICh3YWl0cGlkKC0xLCBzdGF0dXMsIFdOT0hBTkcgfCBfX1dBTEwpID09IHBp
ZCkKICAgICAgcmV0dXJuOwogICAgdXNsZWVwKDEwMDApOwogIH0KICBESVIqIGRpciA9IG9wZW5k
aXIoIi9zeXMvZnMvZnVzZS9jb25uZWN0aW9ucyIpOwogIGlmIChkaXIpIHsKICAgIGZvciAoOzsp
IHsKICAgICAgc3RydWN0IGRpcmVudCogZW50ID0gcmVhZGRpcihkaXIpOwogICAgICBpZiAoIWVu
dCkKICAgICAgICBicmVhazsKICAgICAgaWYgKHN0cmNtcChlbnQtPmRfbmFtZSwgIi4iKSA9PSAw
IHx8IHN0cmNtcChlbnQtPmRfbmFtZSwgIi4uIikgPT0gMCkKICAgICAgICBjb250aW51ZTsKICAg
ICAgY2hhciBhYm9ydFszMDBdOwogICAgICBzbnByaW50ZihhYm9ydCwgc2l6ZW9mKGFib3J0KSwg
Ii9zeXMvZnMvZnVzZS9jb25uZWN0aW9ucy8lcy9hYm9ydCIsCiAgICAgICAgICAgICAgIGVudC0+
ZF9uYW1lKTsKICAgICAgaW50IGZkID0gb3BlbihhYm9ydCwgT19XUk9OTFkpOwogICAgICBpZiAo
ZmQgPT0gLTEpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQogICAgICBpZiAod3JpdGUoZmQs
IGFib3J0LCAxKSA8IDApIHsKICAgICAgfQogICAgICBjbG9zZShmZCk7CiAgICB9CiAgICBjbG9z
ZWRpcihkaXIpOwogIH0gZWxzZSB7CiAgfQogIHdoaWxlICh3YWl0cGlkKC0xLCBzdGF0dXMsIF9f
V0FMTCkgIT0gcGlkKSB7CiAgfQp9CgpzdGF0aWMgdm9pZCBzZXR1cF9sb29wKCkKewogIHNldHVw
X2Nncm91cHNfbG9vcCgpOwogIGNoZWNrcG9pbnRfbmV0X25hbWVzcGFjZSgpOwp9CgpzdGF0aWMg
dm9pZCByZXNldF9sb29wKCkKewogIHJlc2V0X25ldF9uYW1lc3BhY2UoKTsKfQoKc3RhdGljIHZv
aWQgc2V0dXBfdGVzdCgpCnsKICBwcmN0bChQUl9TRVRfUERFQVRIU0lHLCBTSUdLSUxMLCAwLCAw
LCAwKTsKICBzZXRwZ3JwKCk7CiAgc2V0dXBfY2dyb3Vwc190ZXN0KCk7CiAgd3JpdGVfZmlsZSgi
L3Byb2Mvc2VsZi9vb21fc2NvcmVfYWRqIiwgIjEwMDAiKTsKICBmbHVzaF90dW4oKTsKICBpZiAo
c3ltbGluaygiL2Rldi9iaW5kZXJmcyIsICIuL2JpbmRlcmZzIikpIHsKICB9Cn0KCnN0YXRpYyB2
b2lkIGNsb3NlX2ZkcygpCnsKICBmb3IgKGludCBmZCA9IDM7IGZkIDwgTUFYX0ZEUzsgZmQrKykK
ICAgIGNsb3NlKGZkKTsKfQoKc3RhdGljIHZvaWQgc2V0dXBfYmluZm10X21pc2MoKQp7CiAgaWYg
KG1vdW50KDAsICIvcHJvYy9zeXMvZnMvYmluZm10X21pc2MiLCAiYmluZm10X21pc2MiLCAwLCAw
KSkgewogICAgcmV0dXJuOwogIH0KICBpZiAoIXdyaXRlX2ZpbGUoIi9wcm9jL3N5cy9mcy9iaW5m
bXRfbWlzYy9yZWdpc3RlciIsCiAgICAgICAgICAgICAgICAgICI6c3l6MDpNOjA6XHgwMTo6Li9m
aWxlMDoiKSB8fAogICAgICAhd3JpdGVfZmlsZSgiL3Byb2Mvc3lzL2ZzL2JpbmZtdF9taXNjL3Jl
Z2lzdGVyIiwKICAgICAgICAgICAgICAgICAgIjpzeXoxOk06MTpceDAyOjouL2ZpbGUwOlBPQyIp
KQogICAgZXhpdCgxKTsKfQoKc3RhdGljIHZvaWQgc2V0dXBfdXNiKCkKewogIGlmIChjaG1vZCgi
L2Rldi9yYXctZ2FkZ2V0IiwgMDY2NikpCiAgICBleGl0KDEpOwp9CgojZGVmaW5lIE5MODAyMTU0
X0NNRF9TRVRfU0hPUlRfQUREUiAxMQojZGVmaW5lIE5MODAyMTU0X0FUVFJfSUZJTkRFWCAzCiNk
ZWZpbmUgTkw4MDIxNTRfQVRUUl9TSE9SVF9BRERSIDEwCgpzdGF0aWMgdm9pZCBzZXR1cF84MDIx
NTQoKQp7CiAgaW50IHNvY2tfcm91dGUgPSBzb2NrZXQoQUZfTkVUTElOSywgU09DS19SQVcsIE5F
VExJTktfUk9VVEUpOwogIGlmIChzb2NrX3JvdXRlID09IC0xKQogICAgZXhpdCgxKTsKICBpbnQg
c29ja19nZW5lcmljID0gc29ja2V0KEFGX05FVExJTkssIFNPQ0tfUkFXLCBORVRMSU5LX0dFTkVS
SUMpOwogIGlmIChzb2NrX2dlbmVyaWMgPCAwKQogICAgZXhpdCgxKTsKICBpbnQgbmw4MDIxNTRf
ZmFtaWx5X2lkID0KICAgICAgbmV0bGlua19xdWVyeV9mYW1pbHlfaWQoJm5sbXNnLCBzb2NrX2dl
bmVyaWMsICJubDgwMjE1NCIsIHRydWUpOwogIGZvciAoaW50IGkgPSAwOyBpIDwgMjsgaSsrKSB7
CiAgICBjaGFyIGRldm5hbWVbXSA9ICJ3cGFuMCI7CiAgICBkZXZuYW1lW3N0cmxlbihkZXZuYW1l
KSAtIDFdICs9IGk7CiAgICB1aW50NjRfdCBod2FkZHIgPSAweGFhYWFhYWFhYWFhYTAwMDIgKyAo
aSA8PCA4KTsKICAgIHVpbnQxNl90IHNob3J0YWRkciA9IDB4YWFhMCArIGk7CiAgICBpbnQgaWZp
bmRleCA9IGlmX25hbWV0b2luZGV4KGRldm5hbWUpOwogICAgc3RydWN0IGdlbmxtc2doZHIgZ2Vu
bGhkcjsKICAgIG1lbXNldCgmZ2VubGhkciwgMCwgc2l6ZW9mKGdlbmxoZHIpKTsKICAgIGdlbmxo
ZHIuY21kID0gTkw4MDIxNTRfQ01EX1NFVF9TSE9SVF9BRERSOwogICAgbmV0bGlua19pbml0KCZu
bG1zZywgbmw4MDIxNTRfZmFtaWx5X2lkLCAwLCAmZ2VubGhkciwgc2l6ZW9mKGdlbmxoZHIpKTsK
ICAgIG5ldGxpbmtfYXR0cigmbmxtc2csIE5MODAyMTU0X0FUVFJfSUZJTkRFWCwgJmlmaW5kZXgs
IHNpemVvZihpZmluZGV4KSk7CiAgICBuZXRsaW5rX2F0dHIoJm5sbXNnLCBOTDgwMjE1NF9BVFRS
X1NIT1JUX0FERFIsICZzaG9ydGFkZHIsCiAgICAgICAgICAgICAgICAgc2l6ZW9mKHNob3J0YWRk
cikpOwogICAgaW50IGVyciA9IG5ldGxpbmtfc2VuZCgmbmxtc2csIHNvY2tfZ2VuZXJpYyk7CiAg
ICBpZiAoZXJyIDwgMCkKICAgICAgZXhpdCgxKTsKICAgIG5ldGxpbmtfZGV2aWNlX2NoYW5nZSgm
bmxtc2csIHNvY2tfcm91dGUsIGRldm5hbWUsIHRydWUsIDAsICZod2FkZHIsCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgc2l6ZW9mKGh3YWRkciksIDApOwogICAgaWYgKGkgPT0gMCkgewogICAg
ICBuZXRsaW5rX2FkZF9kZXZpY2VfaW1wbCgmbmxtc2csICJsb3dwYW4iLCAibG93cGFuMCIsIGZh
bHNlKTsKICAgICAgbmV0bGlua19kb25lKCZubG1zZyk7CiAgICAgIG5ldGxpbmtfYXR0cigmbmxt
c2csIElGTEFfTElOSywgJmlmaW5kZXgsIHNpemVvZihpZmluZGV4KSk7CiAgICAgIGludCBlcnIg
PSBuZXRsaW5rX3NlbmQoJm5sbXNnLCBzb2NrX3JvdXRlKTsKICAgICAgaWYgKGVyciA8IDApCiAg
ICAgICAgZXhpdCgxKTsKICAgIH0KICB9CiAgY2xvc2Uoc29ja19yb3V0ZSk7CiAgY2xvc2Uoc29j
a19nZW5lcmljKTsKfQoKI2RlZmluZSBTV0FQX0ZJTEUgIi4vc3dhcC1maWxlIgojZGVmaW5lIFNX
QVBfRklMRV9TSVpFICgxMjggKiAxMDAwICogMTAwMCkKCnN0YXRpYyB2b2lkIHNldHVwX3N3YXAo
KQp7CiAgc3dhcG9mZihTV0FQX0ZJTEUpOwogIHVubGluayhTV0FQX0ZJTEUpOwogIGludCBmZCA9
IG9wZW4oU1dBUF9GSUxFLCBPX0NSRUFUIHwgT19XUk9OTFkgfCBPX0NMT0VYRUMsIDA2MDApOwog
IGlmIChmZCA9PSAtMSkKICAgIGV4aXQoMSk7CiAgZmFsbG9jYXRlKGZkLCBGQUxMT0NfRkxfWkVS
T19SQU5HRSwgMCwgU1dBUF9GSUxFX1NJWkUpOwogIGNsb3NlKGZkKTsKICBjaGFyIGNtZGxpbmVb
NjRdOwogIHNwcmludGYoY21kbGluZSwgIm1rc3dhcCAlcyIsIFNXQVBfRklMRSk7CiAgaWYgKHJ1
bmNtZGxpbmUoY21kbGluZSkpCiAgICBleGl0KDEpOwogIGlmIChzd2Fwb24oU1dBUF9GSUxFLCBT
V0FQX0ZMQUdfUFJFRkVSKSA9PSAxKQogICAgZXhpdCgxKTsKfQoKc3RydWN0IHRocmVhZF90IHsK
ICBpbnQgY3JlYXRlZCwgY2FsbDsKICBldmVudF90IHJlYWR5LCBkb25lOwp9OwoKc3RhdGljIHN0
cnVjdCB0aHJlYWRfdCB0aHJlYWRzWzE2XTsKc3RhdGljIHZvaWQgZXhlY3V0ZV9jYWxsKGludCBj
YWxsKTsKc3RhdGljIGludCBydW5uaW5nOwoKc3RhdGljIHZvaWQqIHRocih2b2lkKiBhcmcpCnsK
ICBzdHJ1Y3QgdGhyZWFkX3QqIHRoID0gKHN0cnVjdCB0aHJlYWRfdCopYXJnOwogIGZvciAoOzsp
IHsKICAgIGV2ZW50X3dhaXQoJnRoLT5yZWFkeSk7CiAgICBldmVudF9yZXNldCgmdGgtPnJlYWR5
KTsKICAgIGV4ZWN1dGVfY2FsbCh0aC0+Y2FsbCk7CiAgICBfX2F0b21pY19mZXRjaF9zdWIoJnJ1
bm5pbmcsIDEsIF9fQVRPTUlDX1JFTEFYRUQpOwogICAgZXZlbnRfc2V0KCZ0aC0+ZG9uZSk7CiAg
fQogIHJldHVybiAwOwp9CgpzdGF0aWMgdm9pZCBleGVjdXRlX29uZSh2b2lkKQp7CiAgaWYgKHdy
aXRlKDEsICJleGVjdXRpbmcgcHJvZ3JhbVxuIiwgc2l6ZW9mKCJleGVjdXRpbmcgcHJvZ3JhbVxu
IikgLSAxKSkgewogIH0KICBpbnQgaSwgY2FsbCwgdGhyZWFkOwogIGZvciAoY2FsbCA9IDA7IGNh
bGwgPCA1OyBjYWxsKyspIHsKICAgIGZvciAodGhyZWFkID0gMDsgdGhyZWFkIDwgKGludCkoc2l6
ZW9mKHRocmVhZHMpIC8gc2l6ZW9mKHRocmVhZHNbMF0pKTsKICAgICAgICAgdGhyZWFkKyspIHsK
ICAgICAgc3RydWN0IHRocmVhZF90KiB0aCA9ICZ0aHJlYWRzW3RocmVhZF07CiAgICAgIGlmICgh
dGgtPmNyZWF0ZWQpIHsKICAgICAgICB0aC0+Y3JlYXRlZCA9IDE7CiAgICAgICAgZXZlbnRfaW5p
dCgmdGgtPnJlYWR5KTsKICAgICAgICBldmVudF9pbml0KCZ0aC0+ZG9uZSk7CiAgICAgICAgZXZl
bnRfc2V0KCZ0aC0+ZG9uZSk7CiAgICAgICAgdGhyZWFkX3N0YXJ0KHRociwgdGgpOwogICAgICB9
CiAgICAgIGlmICghZXZlbnRfaXNzZXQoJnRoLT5kb25lKSkKICAgICAgICBjb250aW51ZTsKICAg
ICAgZXZlbnRfcmVzZXQoJnRoLT5kb25lKTsKICAgICAgdGgtPmNhbGwgPSBjYWxsOwogICAgICBf
X2F0b21pY19mZXRjaF9hZGQoJnJ1bm5pbmcsIDEsIF9fQVRPTUlDX1JFTEFYRUQpOwogICAgICBl
dmVudF9zZXQoJnRoLT5yZWFkeSk7CiAgICAgIGV2ZW50X3RpbWVkd2FpdCgmdGgtPmRvbmUsIDUw
KTsKICAgICAgYnJlYWs7CiAgICB9CiAgfQogIGZvciAoaSA9IDA7IGkgPCAxMDAgJiYgX19hdG9t
aWNfbG9hZF9uKCZydW5uaW5nLCBfX0FUT01JQ19SRUxBWEVEKTsgaSsrKQogICAgc2xlZXBfbXMo
MSk7CiAgY2xvc2VfZmRzKCk7Cn0KCnN0YXRpYyB2b2lkIGV4ZWN1dGVfb25lKHZvaWQpOwoKI2Rl
ZmluZSBXQUlUX0ZMQUdTIF9fV0FMTAoKc3RhdGljIHZvaWQgbG9vcCh2b2lkKQp7CiAgc2V0dXBf
bG9vcCgpOwogIGludCBpdGVyID0gMDsKICBmb3IgKDs7IGl0ZXIrKykgewogICAgY2hhciBjd2Ri
dWZbMzJdOwogICAgc3ByaW50Zihjd2RidWYsICIuLyVkIiwgaXRlcik7CiAgICBpZiAobWtkaXIo
Y3dkYnVmLCAwNzc3KSkKICAgICAgZXhpdCgxKTsKICAgIHJlc2V0X2xvb3AoKTsKICAgIGludCBw
aWQgPSBmb3JrKCk7CiAgICBpZiAocGlkIDwgMCkKICAgICAgZXhpdCgxKTsKICAgIGlmIChwaWQg
PT0gMCkgewogICAgICBpZiAoY2hkaXIoY3dkYnVmKSkKICAgICAgICBleGl0KDEpOwogICAgICBz
ZXR1cF90ZXN0KCk7CiAgICAgIGV4ZWN1dGVfb25lKCk7CiAgICAgIGV4aXQoMCk7CiAgICB9CiAg
ICBpbnQgc3RhdHVzID0gMDsKICAgIHVpbnQ2NF90IHN0YXJ0ID0gY3VycmVudF90aW1lX21zKCk7
CiAgICBmb3IgKDs7KSB7CiAgICAgIGlmICh3YWl0cGlkKC0xLCAmc3RhdHVzLCBXTk9IQU5HIHwg
V0FJVF9GTEFHUykgPT0gcGlkKQogICAgICAgIGJyZWFrOwogICAgICBzbGVlcF9tcygxKTsKICAg
ICAgaWYgKGN1cnJlbnRfdGltZV9tcygpIC0gc3RhcnQgPCA1MDAwKQogICAgICAgIGNvbnRpbnVl
OwogICAgICBraWxsX2FuZF93YWl0KHBpZCwgJnN0YXR1cyk7CiAgICAgIGJyZWFrOwogICAgfQog
ICAgcmVtb3ZlX2Rpcihjd2RidWYpOwogIH0KfQoKdWludDY0X3QgclsxXSA9IHsweGZmZmZmZmZm
ZmZmZmZmZmZ9OwoKdm9pZCBleGVjdXRlX2NhbGwoaW50IGNhbGwpCnsKICBpbnRwdHJfdCByZXMg
PSAwOwogIHN3aXRjaCAoY2FsbCkgewogIGNhc2UgMDoKICAgIHJlcyA9IC0xOwogICAgTk9ORkFJ
TElORyhyZXMgPSBzeXpfaW5pdF9uZXRfc29ja2V0KC8qZmFtPSovMHgxZiwgLyp0eXBlPVNPQ0tf
UkFXKi8gMywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKnByb3Rv
PSovMCkpOwogICAgaWYgKHJlcyAhPSAtMSkKICAgICAgclswXSA9IHJlczsKICAgIGJyZWFrOwog
IGNhc2UgMToKICAgIE5PTkZBSUxJTkcoKih1aW50NjRfdCopMHgyMDAwMDFjMCA9IDApOwogICAg
Tk9ORkFJTElORygqKHVpbnQzMl90KikweDIwMDAwMWM4ID0gMCk7CiAgICBOT05GQUlMSU5HKCoo
dWludDY0X3QqKTB4MjAwMDAxZDAgPSAweDIwMDAwMzAwKTsKICAgIE5PTkZBSUxJTkcoKih1aW50
NjRfdCopMHgyMDAwMDMwMCA9IDApOwogICAgTk9ORkFJTElORygqKHVpbnQ2NF90KikweDIwMDAw
MzA4ID0gMHgxYyk7CiAgICBOT05GQUlMSU5HKCoodWludDY0X3QqKTB4MjAwMDAxZDggPSAxKTsK
ICAgIE5PTkZBSUxJTkcoKih1aW50NjRfdCopMHgyMDAwMDFlMCA9IDApOwogICAgTk9ORkFJTElO
RygqKHVpbnQ2NF90KikweDIwMDAwMWU4ID0gMCk7CiAgICBOT05GQUlMSU5HKCoodWludDMyX3Qq
KTB4MjAwMDAxZjAgPSAwKTsKICAgIHN5c2NhbGwoX19OUl9zZW5kbXNnLCAvKmZkPSovLTEsIC8q
bXNnPSovMHgyMDAwMDFjMHVsLCAvKmY9Ki8wdWwpOwogICAgYnJlYWs7CiAgY2FzZSAyOgogICAg
c3lzY2FsbChfX05SX3NvY2tldCwgLypkb21haW49Ki8weGZ1bCwgLyp0eXBlPSovM3VsLCAvKnBy
b3RvPSovMik7CiAgICBicmVhazsKICBjYXNlIDM6CiAgICBOT05GQUlMSU5HKCoodWludDE2X3Qq
KTB4MjAwMDAwNDAgPSAweDFmKTsKICAgIE5PTkZBSUxJTkcoKih1aW50MTZfdCopMHgyMDAwMDA0
MiA9IDApOwogICAgTk9ORkFJTElORyhtZW1zZXQoKHZvaWQqKTB4MjAwMDAwNDQsIDE3MCwgNSkp
OwogICAgTk9ORkFJTElORygqKHVpbnQ4X3QqKTB4MjAwMDAwNDkgPSAweDEwKTsKICAgIE5PTkZB
SUxJTkcoKih1aW50MTZfdCopMHgyMDAwMDA0YSA9IDApOwogICAgTk9ORkFJTElORygqKHVpbnQ4
X3QqKTB4MjAwMDAwNGMgPSAwKTsKICAgIHN5c2NhbGwoX19OUl9jb25uZWN0LCAvKmZkPSovclsw
XSwgLyphZGRyPSovMHgyMDAwMDA0MHVsLAogICAgICAgICAgICAvKmFkZHJsZW49Ki8weGV1bCk7
CiAgICBicmVhazsKICBjYXNlIDQ6CiAgICBOT05GQUlMSU5HKAogICAgICAgIG1lbWNweSgodm9p
ZCopMHgyMDAwMDBjMCwgIlx4MDJceGM4XHgwMFx4MGNceDAwXHgwOFx4MDBceDAyIiwgOCkpOwog
ICAgTk9ORkFJTElORyhzeXpfZW1pdF92aGNpKC8qZGF0YT0qLzB4MjAwMDAwYzAsIC8qc2l6ZT0q
LzB4MTEpKTsKICAgIGJyZWFrOwogIH0KfQppbnQgbWFpbih2b2lkKQp7CiAgc3lzY2FsbChfX05S
X21tYXAsIC8qYWRkcj0qLzB4MWZmZmYwMDB1bCwgLypsZW49Ki8weDEwMDB1bCwgLypwcm90PSov
MHVsLAogICAgICAgICAgLypmbGFncz1NQVBfRklYRUR8TUFQX0FOT05ZTU9VU3xNQVBfUFJJVkFU
RSovIDB4MzJ1bCwgLypmZD0qLy0xLAogICAgICAgICAgLypvZmZzZXQ9Ki8wdWwpOwogIHN5c2Nh
bGwoX19OUl9tbWFwLCAvKmFkZHI9Ki8weDIwMDAwMDAwdWwsIC8qbGVuPSovMHgxMDAwMDAwdWws
CiAgICAgICAgICAvKnByb3Q9UFJPVF9XUklURXxQUk9UX1JFQUR8UFJPVF9FWEVDKi8gN3VsLAog
ICAgICAgICAgLypmbGFncz1NQVBfRklYRUR8TUFQX0FOT05ZTU9VU3xNQVBfUFJJVkFURSovIDB4
MzJ1bCwgLypmZD0qLy0xLAogICAgICAgICAgLypvZmZzZXQ9Ki8wdWwpOwogIHN5c2NhbGwoX19O
Ul9tbWFwLCAvKmFkZHI9Ki8weDIxMDAwMDAwdWwsIC8qbGVuPSovMHgxMDAwdWwsIC8qcHJvdD0q
LzB1bCwKICAgICAgICAgIC8qZmxhZ3M9TUFQX0ZJWEVEfE1BUF9BTk9OWU1PVVN8TUFQX1BSSVZB
VEUqLyAweDMydWwsIC8qZmQ9Ki8tMSwKICAgICAgICAgIC8qb2Zmc2V0PSovMHVsKTsKICBzZXR1
cF9jZ3JvdXBzKCk7CiAgc2V0dXBfYmluZm10X21pc2MoKTsKICBzZXR1cF91c2IoKTsKICBzZXR1
cF84MDIxNTQoKTsKICBzZXR1cF9zd2FwKCk7CiAgaW5zdGFsbF9zZWd2X2hhbmRsZXIoKTsKICB1
c2VfdGVtcG9yYXJ5X2RpcigpOwogIGRvX3NhbmRib3hfbm9uZSgpOwogIHJldHVybiAwOwp9Cg==

------=ALIBOUNDARY_1730_7f58dc35d700_666258fa_197702--


